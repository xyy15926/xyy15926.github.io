<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>UBeaRLy</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UBeaRLy&#039;s Proxy"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UBeaRLy&#039;s Proxy"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="UBeaRLy"><meta property="og:url" content="https://xyy15926.github.io/"><meta property="og:site_name" content="UBeaRLy"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://xyy15926.github.io/img/og_image.png"><meta property="article:author" content="UBeaRLy"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xyy15926.github.io"},"headline":"UBeaRLy","image":["https://xyy15926.github.io/img/og_image.png"],"author":{"@type":"Person","name":"UBeaRLy"},"publisher":{"@type":"Organization","name":"UBeaRLy","logo":{"@type":"ImageObject","url":"https://xyy15926.github.io/img/logo.svg"}},"description":""}</script><link rel="alternate" href="/atom.xml" title="UBeaRLy" type="application/atom+xml"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/darcula.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-5385776267343559" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="follow_it-verification-code" content="SVBypAPPHxjjr7Y4hHfn"><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="UBeaRLy" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Visit on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-10-29T02:59:50.000Z" title="10/29/2020, 10:59:50 AM">2020-10-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-08-04T11:46:14.000Z" title="8/4/2021, 7:46:14 PM">2021-08-04</time></span><span class="level-item"><a class="link-muted" href="/categories/Tool/">Tool</a><span> / </span><a class="link-muted" href="/categories/Tool/Windows/">Windows</a></span><span class="level-item">2 minutes read (About 264 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Tool/Windows/ppt.html">PowerPoint 技巧</a></h1><div class="content"><h2 id="插入元素"><a href="#插入元素" class="headerlink" title="插入元素"></a>插入元素</h2><h3 id="插入网页"><a href="#插入网页" class="headerlink" title="插入网页"></a>插入网页</h3><ul>
<li><p>WebView加载项：可以在ppt应用市场中获取</p>
<ul>
<li>只支持<code>https</code>页面<ul>
<li>本地页面都不支持</li>
<li>尝试自建https服务器（自签发证书）失败</li>
</ul>
</li>
<li>可以在编辑状态查看页面效果</li>
</ul>
<blockquote>
<ul>
<li>在OFFICE2010及以前不可用</li>
</ul>
</blockquote>
</li>
<li><p><code>Microsoft Web Browser</code>控件</p>
<ul>
<li>调用IE渲染页面，因此网页对IE的兼容性很重要</li>
<li>控件不会自动加载网页，需要通过VB通过触发事件调用其
<code>Navigate2</code>方法加载网页，所以只有在ppt播放页面才能
看到实际效果<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 页面切换事件</span><br><span class="line">// 注意不要`<span class="keyword">Private</span> <span class="keyword">Sub</span>`，否则事件不会被触发</span><br><span class="line">// 若想手动触发可以使用button控件的`CommandButton&lt;X&gt;_Click`事件</span><br><span class="line"><span class="keyword">Sub</span> OnSlideShowPageChange()</span><br><span class="line">	<span class="keyword">Dim</span> FileName <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	FileName = <span class="string">&quot;&lt;FILENAME&gt;&quot;</span></span><br><span class="line">	// `WebBrowser1`：控件名称，唯一（单个slide内）标识控件</span><br><span class="line">	// `ActivePresentation.PATH`：当前工作目录（未保存文件返回空），</span><br><span class="line">	//		浏览器默认`http://`协议</span><br><span class="line">	// `Navigate`方法可能会无法加载</span><br><span class="line">	WebBrowser1.Navigate2(ActivePresentation.PATH + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;&lt;FILENAME&gt;&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-10-28T10:46:33.000Z" title="10/28/2020, 6:46:33 PM">2020-10-28</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T09:39:05.000Z" title="7/16/2021, 5:39:05 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a><span> / </span><a class="link-muted" href="/categories/Linux/Tool/">Tool</a></span><span class="level-item">3 minutes read (About 407 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/Tool/nginx.html">Nginx 使用、配置</a></h1><div class="content"><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><blockquote>
<ul>
<li>配置文件夹为<code>/etc/nginx</code></li>
</ul>
</blockquote>
<h3 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h3><h4 id="nginx-conf"><a href="#nginx-conf" class="headerlink" title="nginx.conf"></a><code>nginx.conf</code></h4><p><code>nginx.conf</code>：Nginx主配置文件，包含“全部配置”</p>
<ul>
<li><p>默认<code>include</code></p>
<ul>
<li><code>modules-enabled/*.conf</code>：已启用模块</li>
<li><code>mime.types</code>：代理文件类型</li>
<li><code>conf.d/*.conf</code>：服务器设置</li>
<li><code>sites-enabled/*</code>：已启用站点</li>
</ul>
</li>
<li><p><code>user</code>表示启动nginx进程的用户</p>
<ul>
<li>键值默认为<code>www-data</code></li>
<li>可修改为其他用户，使nginx具有访问某些文件的权限</li>
</ul>
<blockquote>
<ul>
<li>若是在nginx启动之后修改，需修改<code>/var/log/nginx</code>中
 log文件的属主，否则无法正常log</li>
</ul>
</blockquote>
</li>
</ul>
<h4 id="http服务器设置"><a href="#http服务器设置" class="headerlink" title="http服务器设置"></a>http服务器设置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">	listen 8080;</span><br><span class="line">	server_name localhost;</span><br><span class="line">	location / &#123;</span><br><span class="line">		root /home/xyy15926/Code;</span><br><span class="line">		autoindex on;</span><br><span class="line">		autoindex_exact_size off;</span><br><span class="line">		autoindex_localtime on;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>root</code>：需要nginx进程可访问，否则<em>403 Forbidden</em></li>
<li><code>autoindex</code>：自动为文件生成目录<ul>
<li>若目录设置<code>index index.XXX</code>，不设置<code>autoindex</code>访问
目录则会<em>403 Forbidden</em></li>
</ul>
</li>
</ul>
<h4 id="https服务器"><a href="#https服务器" class="headerlink" title="https服务器"></a>https服务器</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">	listen 443 ssl;</span><br><span class="line">	server_name localhost;</span><br><span class="line">	ssl_certificate /home/xyy15926/Code/home_config/nginx/localhost.crt;</span><br><span class="line">	ssl_certificate_key /home/xyy15926/Code/home_config/nginx/localhost.key;</span><br><span class="line">	ssl_session_timeout 5m;</span><br><span class="line">	ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">	ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;</span><br><span class="line">	ssl_prefer_server_ciphers on;</span><br><span class="line">	location / &#123;</span><br><span class="line">		root /home/xyy15926/Code/statics;</span><br><span class="line">		autoindex on;</span><br><span class="line">		autoindex_exact_size off;</span><br><span class="line">		autoindex_localtime on;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>ssl_certificate</code>、<code>ssl_certificate_key</code>：SSL证书、私钥</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 个人签发https证书，个人一般不会是受信任机构，所以还需要</span></span><br><span class="line"><span class="comment"># 将证书添加进受信任机构（但是windows下有些有问题）</span></span><br><span class="line">openssl req -x509 -out localhost.crt -keyout localhost.key \</span><br><span class="line">	-newkey rsa:2048 -nodes -sha256 \</span><br><span class="line">	-subj <span class="string">&#x27;/CN=localhost&#x27;</span> -extensions EXT -config &lt;( \</span><br><span class="line">	<span class="built_in">printf</span> <span class="string">&quot;[dn]\nCN=localhost\n[req]\ndistinguished_name = dn\n[EXT]\nsubjectAltName=DNS:localhost\nkeyUsage=digitalSignature\nextendedKeyUsage=serverAuth&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># Nginx启动、重启动</span></span><br><span class="line">$ /etc/init.d/nginx start</span><br><span class="line">$ /etc/init.d/nginx restart</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-21T03:13:48.000Z" title="9/21/2020, 11:13:48 AM">2020-09-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-21T03:13:48.000Z" title="9/21/2020, 11:13:48 AM">2020-09-21</time></span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a><span> / </span><a class="link-muted" href="/categories/Linux/Process-Schedual/">Process Schedual</a></span><span class="level-item">35 minutes read (About 5295 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/Process-Schedual/ps_syscall.html">Linux System Call</a></h1><div class="content"><h2 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h2><p>内核：提供硬件抽象层、磁盘及文件系统控制、多任务等功能的系统
软件</p>
<ul>
<li><p>内核是操作系统的核心、基础，决定系统的性能、稳定性</p>
<ul>
<li>内核单独不是完整的操作系统</li>
</ul>
</li>
<li><p>内核为应用程序提供对硬件访问</p>
<ul>
<li>应用程序对硬件访受限<ul>
<li>内核决定程序何时、对何种硬件操作多长时间</li>
</ul>
</li>
<li>内核提供硬件抽象的方法隐藏对硬件操作的复杂<ul>
<li>为应用程序和硬件提供简洁、统一的接口</li>
<li>简化程序设计</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="内核功能"><a href="#内核功能" class="headerlink" title="内核功能"></a>内核功能</h3><ul>
<li><p>进程管理：实现了多个进程在CPU上的抽象</p>
<ul>
<li>负责创建、销毁进程，处理它们和外部输入、输出</li>
<li>处理进程之间通讯<ul>
<li>信号</li>
<li>管道</li>
<li>通讯原语</li>
</ul>
</li>
<li>调度器控制进程如何共享CPU</li>
</ul>
</li>
<li><p>内存管理：内存是主要资源，对其管理策略对性能影响非常重要</p>
<ul>
<li>为所有进程在有限资源上建立虚拟寻址空间</li>
<li>内核不同部分与内存管理子系统通过函数调用交互，实现
<code>malloc</code>、<code>free</code>等功能</li>
</ul>
</li>
<li><p>文件管理：Linux很大程度上基于文件系统概念，几乎任何东西
都可以视为是文件</p>
<ul>
<li>在非结构化硬件上建立了结构化文件系统</li>
<li>支持多个文件系统，即物理介质上的不同数据组织方式</li>
</ul>
</li>
<li><p>驱动管理</p>
<ul>
<li>除CPU、内存和极少的硬件实体外，基本设备控制操作都由
特定的、需寻址的设备相关代码（设备驱动）进行</li>
<li>内核中必须嵌入系统中出现每个外设驱动</li>
</ul>
</li>
<li><p>网络管理</p>
<ul>
<li>网络必须由系统管理<ul>
<li>大部分网络操作不是特定于某个进程：进入系统的报文
是异步事件</li>
<li>系统在进程接手报文前收集、识别、分发，在程序和
网络接口间递送数据报文，根据程序的网络活动控制
程序执行</li>
</ul>
</li>
<li>路由、地址解析也在内核中实现</li>
</ul>
</li>
</ul>
<h2 id="System-Call"><a href="#System-Call" class="headerlink" title="System Call"></a>System Call</h2><p>系统调用：操作系统提供的实现系统功能的子程序、访问硬件资源
的唯一入口</p>
<ul>
<li><p>系统调用是用户空间进程访问内核、硬件设备的唯一手段</p>
<ul>
<li>用户空间进程不能直接访问内核、调用内核函数</li>
<li>对计算机硬件资源的必须经过操作系统控制<ul>
<li>计算机系统硬件资源有限，多个进程都需要访问资源</li>
</ul>
</li>
</ul>
</li>
<li><p>系统调用与硬件体系结构紧密相关</p>
<ul>
<li>在用户空间进程和硬件设备之间添加中间层，是二者沟通的
桥梁</li>
<li>是设备驱动程序中定义的函数最终被调用的一种方式</li>
</ul>
</li>
</ul>
<p><img src="/imgs/syscall_routine_procedure.png" alt="syscall_routine_procedure"></p>
<h3 id="系统调用意义"><a href="#系统调用意义" class="headerlink" title="系统调用意义"></a>系统调用意义</h3><ul>
<li><p>用户程序通过系统调用使用硬件，简化开发、移植性</p>
<ul>
<li>分离了用户程序和内核的开发<ul>
<li>用户程序忽略API具体实现，仅借助其开发应用</li>
<li>内核忽略API被调用，只需关心系统调用API实现</li>
</ul>
</li>
<li>为用户空间提供了统一硬件抽象接口，用户程序可以方便在
具有相同系统调用不同平台之间迁移</li>
</ul>
</li>
<li><p>系统调用保证了系统稳定和安全</p>
<ul>
<li>内核可以基于权限和其他规则对需要进行的访问进行
裁决</li>
<li>避免程序不正确的使用硬件设备、窃取其他进程资源、
危害系统安全</li>
</ul>
</li>
<li><p>保证进程可以正常运行在虚拟寻址空间中</p>
<ul>
<li>程序可以随意访问硬件、内核而对此没有足够了解，
则难以实现多任务、虚拟内存</li>
<li>无法实现良好的稳定性、安全性</li>
</ul>
</li>
</ul>
<h3 id="通知内核"><a href="#通知内核" class="headerlink" title="通知内核"></a>通知内核</h3><blockquote>
<ul>
<li>大部分情况下，程序通过API而不是直接调用系统调用</li>
<li>POSIX标准是Unix世界最流行的API接口规范，其中API和系统
  调用之间有直接关系，但也不是一一对应</li>
</ul>
</blockquote>
<h4 id="系统调用表"><a href="#系统调用表" class="headerlink" title="系统调用表"></a>系统调用表</h4><p>系统调用表<code>sys_call_table</code>：其中元素是系统调用服务例程的
起始地址</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// arch/x86/entry/syscall_64.c</span></span><br><span class="line">asmlinkage <span class="keyword">const</span> sys_call_ptr sys_call_table[__NR_syscall_max+<span class="number">1</span>] =&#123;</span><br><span class="line">	[<span class="number">0</span> ... __NR_syscall_max] = &amp;sys_ni_syscall,</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;asm/syscalls_64.h&gt;</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li><code>...</code>是GCC<em>Designated Initializers</em>插件功能，此插件允许
  无序初始化元素值</li>
</ul>
</blockquote>
<ul>
<li><p><code>sys_call_table</code>是长为<code>__NR_syscall_max+1</code>的数组</p>
</li>
<li><p><code>__NR_syscall_max</code>是给定系统架构所允许的最大系统调用
数目</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// include/generated/asm-offsets.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __NR_syscall_max 547</span></span><br></pre></td></tr></table></figure>
<ul>
<li>此数值必然和<code>arch/x86/entry/syscalls/syscall_64.tbl</code>
中最大系统调用数值相同</li>
</ul>
</li>
<li><p><code>sys_call_ptr</code>是指向系统调用表指针类型</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*<span class="keyword">sys_call_ptr_t</span>)</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>sys_ni_syscall</code>是返回错误的函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">asmlinkage <span class="keyword">long</span> <span class="title">sys_ni_syscall</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> -ENOSYS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>未在<code>&lt;asm/syscalls_64.h&gt;</code>定义系统调用号将会对应此
响应函数，返回<code>ENOSYS</code>专属错误</li>
</ul>
</li>
<li><p><code>&lt;asm/syscalls_64.h&gt;</code>由脚本
<code>arch/x86/entry/syscalls/syscalltbl.sh</code>从
<code>arch/x86/entry/syscalls/syscall_64.tbl</code>中生成</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;asm/syscalls_64.h&gt;</span></span><br><span class="line">__SYS_COMMON(<span class="number">0</span>, sys_read, sys_read)</span><br><span class="line">__SYS_COMMON(<span class="number">0</span>, sys_write, sys_write)</span><br><span class="line"></span><br><span class="line"><span class="comment">// &lt;arch/x86/entry/syscall_64.c&gt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __SYSCALL_COMMON(nr, sym, compat) __SYSCALL_64(nr, sym, compat)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __SYSCALL_64(nr, sym, compat) [nr] = sym</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="系统调用号"><a href="#系统调用号" class="headerlink" title="系统调用号"></a>系统调用号</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* fs/xattr.c */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __NR_setxattr 5</span></span><br><span class="line">__SYSCALL(__NR_setxattr, sys_setxattr)</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __NR_lsetxattr 6</span></span><br><span class="line">__SYSYCALL(__NR_lsetxattr, sys_lsetattr)</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __NR_fsetxattr 7</span></span><br><span class="line">__SYSYCALL(__NR_fsetxattr, sys_fsetattr)</span><br></pre></td></tr></table></figure>
<p>系统调用号<code>_NR_XXX</code>：系统调用唯一标识</p>
<ul>
<li><p>系统调用号一旦分配不能有任何变更，否则编译好的程序会崩溃</p>
<ul>
<li>系统调用号定义在<code>include/asm/unisted.h</code>中</li>
</ul>
</li>
<li><p>用户空间进程通过系统调用号指明需要执行的系统调用</p>
<ul>
<li>系统调用号就是系统调用在<code>sys_call_table</code>中的偏移</li>
<li>根据系统调用号在<code>sys_call_table</code>中找到对应表项内容，
即可找到系统调用响应函数<code>sys_NAME</code>的入口地址</li>
</ul>
</li>
<li><p>所有系统调用陷入内核的方式相同，所以必须把系统调用号一并
传给内核</p>
<ul>
<li>X86机器上，系统调用号通过<code>eax</code>寄存器传递给内核<ul>
<li>陷入内核态，用户空间进程已经把系统调用对应系统
调用号放入<code>eax</code>中</li>
<li>系统调用一旦运行，就可以从<code>eax</code>中得到数据</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="陷入指令"><a href="#陷入指令" class="headerlink" title="陷入指令"></a>陷入指令</h4><ul>
<li><p>系统调用通过陷入指令进入内核态</p>
<ul>
<li>然后内核根据存储在寄存器中的系统调用号在系统调用表
中找到相应例程函数的入口地址</li>
<li>根据入口地址调用例程函数</li>
</ul>
</li>
<li><p>陷入指令是特殊指令，且依赖于机器架构，在X86机器中指令为
<code>int 0x80</code></p>
<ul>
<li>不应直接使用陷入指令</li>
<li>应实现系统调用库函数，以系统调用号为参数，执行陷入
指令陷入内核态，并执行系统调用例程函数，即
<code>__syscall[N]</code>系列宏</li>
</ul>
</li>
</ul>
<h4 id="syscall-N"><a href="#syscall-N" class="headerlink" title="__syscall[N]"></a><code>__syscall[N]</code></h4><p><code>_syscall[N]</code>：方便用户程序访问系统调用的一系列宏</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// linux/include/asm/unistd.h</span></span><br><span class="line">__syscall0(type, name)</span><br><span class="line">__syscall1(type, name, type1, args1)</span><br><span class="line">__syscall2(type, name, type1, arg1, type2, arg2)</span><br><span class="line"><span class="comment">// 0-6共7个宏</span></span><br><span class="line">__syscall6(type, name, type1, arg1, type2, arg2, type3, arg3, type4, arg4, type5, arg5, type6, arg6)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _syscall2(type, name, type1, arg1, type2, arg2) \</span></span><br><span class="line"><span class="meta">type name(type1, arg1, type2, arg2) \</span></span><br><span class="line"><span class="meta">&#123; \</span></span><br><span class="line"><span class="meta">long _res; \</span></span><br><span class="line"><span class="meta">__asm__ volatile (<span class="meta-string">&quot;int $0x80&quot;</span> \</span></span><br><span class="line"><span class="meta">: <span class="meta-string">&quot;=a&quot;</span> (_res) \</span></span><br><span class="line"><span class="meta">: <span class="meta-string">&quot;0&quot;</span> (__NR##name), <span class="meta-string">&quot;b&quot;</span> ((long)(arg1)), <span class="meta-string">&quot;c&quot;</span> ((long)(arg2))); \</span></span><br><span class="line"><span class="meta"><span class="comment">// some code</span></span></span><br><span class="line">__syscall_return(type, __res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>7个宏分别可以适用于参数个数为0-6的系统调用
（超过6个参数的系统调用罕见）</p>
</li>
<li><p><code>__syscall[N]</code>宏根据系统调用名创建<code>name</code>同名函数，通过
该函数即可访问系统调用</p>
</li>
</ul>
<blockquote>
<ul>
<li>大部分情况下用户程序都是通过库函数访问系统调用，调用
  <code>__syscall[N]</code>系列宏通常由库函数完成</li>
<li>Linux2.6.19内核之后弃用</li>
</ul>
</blockquote>
<h4 id="syscall"><a href="#syscall" class="headerlink" title="syscall"></a><code>syscall</code></h4><p><code>syscall</code>：通过系统调用号相应参数访问系统调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int syscall(int number, ...);</span><br><span class="line"></span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;sys/syscall.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv)&#123;</span><br><span class="line">	pid_t tid;</span><br><span class="line">	// `SYS_[NAME]`是系统调用号常量</span><br><span class="line">	tid = syscall(SYS_getpid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="System-Call-Service-Routine"><a href="#System-Call-Service-Routine" class="headerlink" title="System Call Service Routine"></a>System Call Service Routine</h4><p>系统调用服务例程/响应函数：系统调用的实际处理逻辑</p>
<ul>
<li><p>一般以<code>sys_</code>开头，后跟系统调用名</p>
<ul>
<li><code>fork()</code>的响应函数是<code>sys_fork()</code></li>
<li><code>exit()</code>的响应函数是<code>sys_exit()</code></li>
</ul>
</li>
<li><p>系统调用可以看作是系统调用服务例程在内核中注册的
名，内核通过系统调用名寻找对应服务例程</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// arch/x86/entry/syscalls/syscall_64.tbl</span></span><br><span class="line"><span class="number">0</span>		common		read		sys_read</span><br><span class="line"><span class="number">1</span>		common		write		sys_write</span><br><span class="line"><span class="number">2</span>		common		open		sys_open</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="参数传递"><a href="#参数传递" class="headerlink" title="参数传递"></a>参数传递</h3><h4 id="参数传递-1"><a href="#参数传递-1" class="headerlink" title="参数传递"></a>参数传递</h4><ul>
<li>除系统调用号外参数输入同样存放在寄存器中<ul>
<li>X86机器上，<code>ebx</code>、<code>ecx</code>、<code>edx</code>、<code>esi</code>、<code>edi</code>按照顺序
存放前5个参数</li>
<li>需要6个以上参数情况不多，此时应该用单独的寄存器存放
指向所有参数在用户空间地址的指针</li>
</ul>
</li>
</ul>
<h4 id="参数验证"><a href="#参数验证" class="headerlink" title="参数验证"></a>参数验证</h4><ul>
<li><p>系统调用需要检查参数是否合法有效、正确</p>
<ul>
<li>文件IO相关系统调用需要检查文件描述符是否有效</li>
<li>进程相关函数需要检查PID是否有效</li>
</ul>
</li>
<li><p>用户指针检查，内核必须保证</p>
<ul>
<li>指针指向的内存区域属于用户空间：不能哄骗内核读取
内核空间数据</li>
<li>指针指向的内存区域在进程地址空间：不能哄骗内核读取
其他进程数据</li>
<li>进程不能绕过内存访问限制：内存读、写应被正确标记</li>
</ul>
</li>
</ul>
<h3 id="访问系统调用"><a href="#访问系统调用" class="headerlink" title="访问系统调用"></a>访问系统调用</h3><h4 id="系统调用初始化"><a href="#系统调用初始化" class="headerlink" title="系统调用初始化"></a>系统调用初始化</h4><ul>
<li><p>系统调用初始化就是对陷入指令的初始化，在X86机器上就是
初始化<code>INT 0x80</code>指令</p>
</li>
<li><p>系统启动时    </p>
<ul>
<li>汇编子程序<code>setup_idt()</code>准备256项的idt表</li>
<li>由<code>start_kernel()</code>、<code>trap_init()</code>调用的C宏定义
<code>set_system_gate(0x80, &amp;system_call)</code>设置<code>0x80</code>号
软中断服务程序为<code>system_call</code></li>
<li><code>system_call</code>就是所有系统调用总入口</li>
</ul>
</li>
</ul>
<h4 id="系统调用上下文"><a href="#系统调用上下文" class="headerlink" title="系统调用上下文"></a>系统调用上下文</h4><ul>
<li><p>内核在执行系统调用时处于进程上下文</p>
<ul>
<li><code>current</code>指针指向当前任务，即引发系统调用的进程</li>
</ul>
</li>
<li><p>在进程上下文中，内可以休眠、被抢占</p>
<ul>
<li>能够休眠：系统调用可以使用内核提供的绝大部分功能，
方便内核编程</li>
<li>能被抢占：新进程可以使用相同的系统调用<ul>
<li>保证系统调用可重入</li>
</ul>
</li>
</ul>
</li>
<li><p>系统调用返回时，控制权依然在<code>system_call()</code>中，其会负责
切换到用户空间并让用户进程继续执行</p>
</li>
</ul>
<h3 id="系统调用返回值"><a href="#系统调用返回值" class="headerlink" title="系统调用返回值"></a>系统调用返回值</h3><h4 id="errno错误码"><a href="#errno错误码" class="headerlink" title="errno错误码"></a><code>errno</code>错误码</h4><ul>
<li><p>系统调用将错误码放入名为<code>errno</code>的全局变量中</p>
<ul>
<li>为防止和正常返回值混淆，系统调用不直接返回错误码</li>
<li><code>errno</code>值只在函数发生错误时设置，若函数不发生错误，
<code>errno</code>值无定义，并不置为0<ul>
<li><code>0</code>值通常表示成功</li>
<li>负值表示系统调用失败<ul>
<li>错误值对应错误消息定义在<code>error.h</code>中</li>
<li>可以通过<code>perror()</code>库函数翻译误码</li>
</ul>
</li>
</ul>
</li>
<li>处理<code>errno</code>前最好将其存入其他变量中，因为在错误处理
过程中<code>errno</code>值可能会被改变</li>
</ul>
</li>
<li><p>系统调用具有明确的操作</p>
</li>
</ul>
<h4 id="ret-from-sys-call"><a href="#ret-from-sys-call" class="headerlink" title="ret_from_sys_call"></a><code>ret_from_sys_call</code></h4><ul>
<li><p>以<code>ret_from_sys_call</code>为入口的汇编程序段在Linux进程管理中
起到重要作用</p>
<ul>
<li>系统调用结束前、大部分中断服务返回前，都会跳转至此处
入口地址</li>
<li>还处理中断嵌套、CPU调度、信号等</li>
</ul>
</li>
<li><p>给用户空间进程的返回值同样通过寄存器传递</p>
<ul>
<li>X86机器上，存放在<code>eax</code>寄存器中</li>
</ul>
</li>
</ul>
<h2 id="Linux系统调用、派生函数"><a href="#Linux系统调用、派生函数" class="headerlink" title="Linux系统调用、派生函数"></a>Linux系统调用、派生函数</h2><h3 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h3><h4 id="进程控制"><a href="#进程控制" class="headerlink" title="进程控制"></a>进程控制</h4><ul>
<li><code>fork</code>：创建新进程</li>
<li><code>clone</code>：按照指定条件创建子进程</li>
<li><code>execve</code>：运行可执行文件</li>
<li><code>exit</code>：终止进程</li>
<li><code>_exit</code>：立即终止当前进程</li>
<li><code>getdtablesize</code>：进程能打开的最大文件数</li>
<li><code>getpgid</code>：获取指定进程组标识号</li>
<li><code>setpgid</code>：设置指定进程组标识号</li>
<li><code>getpgrp</code>：获取当前进程组标识号</li>
<li><code>setpgrp</code>：设置当前进程组标识号</li>
<li><code>getpid</code>：获取进程标识号</li>
<li><code>getppid</code>：获取父进程标识号</li>
<li><code>getpriority</code>：获取调度优先级</li>
<li><code>setpriority</code>：设置调度优先级</li>
<li><code>modify_ldt</code>：读写进程本地描述符</li>
<li><code>nanosleep</code>：使指定进程睡眠</li>
<li><code>nice</code>：改变分时进程的优先级</li>
<li><code>pause</code>：挂起进程，等待信号</li>
<li><code>personality</code>：设置进程运行域</li>
<li><code>prctl</code>：对进程进行特定操作</li>
<li><code>ptrace</code>：进程跟踪</li>
<li><code>sched_get_priority_max</code>：取得静态优先级上限</li>
<li><code>sched_get_priority_min</code>：取得静态优先级下限</li>
<li><code>sched_getparam</code>：取得进程调度参数</li>
<li><code>sched_getscheduler</code>：取得指定进程的调度策略</li>
<li><code>sched_rr_get_interval</code>：取得按RR算法实调度的实时进程
时间片</li>
<li><code>sched_setparam</code>：设置进程调度参数</li>
<li><code>sched_setscheduler</code>：设置进程调度策略和参数</li>
<li><code>sched_yield</code>：进程主动出让处理器，并添加到调度队列队尾</li>
<li><code>vfork</code>：创建执行新程序的子进程</li>
<li><code>wait</code>/<code>wait3</code>：等待子进程终止</li>
<li><code>watipid</code>/<code>wait4</code>：等待指定子进程终止</li>
<li><code>capget</code>：获取进程权限</li>
<li><code>capset</code>：设置进程权限</li>
<li><code>getsid</code>：获取会晤标识号</li>
<li><code>setsid</code>：设置会晤标识号</li>
</ul>
<h4 id="进程间通信"><a href="#进程间通信" class="headerlink" title="进程间通信"></a>进程间通信</h4><ul>
<li><code>ipc</code>：进程间通信控制总控制调用</li>
</ul>
<h4 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h4><ul>
<li><code>sigaction</code>：设置对指定信号的处理方法</li>
<li><code>sigprocmask</code>：根据参数对信号集中的号执行阻塞、解除
阻塞等操作</li>
<li><code>sigpending</code>：为指定被阻塞信号设置队列</li>
<li><code>sigsuspend</code>：挂起进程等待特定信号</li>
<li><code>signal</code></li>
<li><code>kill</code>：向进程、进程组发信号</li>
<li><code>sigvec</code>：为兼容BSD设置的信号处理函数，作用类似
<code>sigaction</code></li>
<li><code>ssetmask</code>：ANSI C的信号处理函数，作用类似<code>sigaction</code></li>
</ul>
<h4 id="消息"><a href="#消息" class="headerlink" title="消息"></a>消息</h4><ul>
<li><code>msgctl</code>：消息控制操作</li>
<li><code>msgget</code>：获取消息队列</li>
<li><code>msgsnd</code>：发消息</li>
<li><code>msgrcv</code>：取消息</li>
</ul>
<h4 id="管道"><a href="#管道" class="headerlink" title="管道"></a>管道</h4><ul>
<li><code>pipe</code>：创建管道</li>
</ul>
<h4 id="信号量"><a href="#信号量" class="headerlink" title="信号量"></a>信号量</h4><ul>
<li><code>semctl</code>：信号量控制</li>
<li><code>semget</code>：获取一组信号量</li>
<li><code>semop</code>：信号量操作</li>
</ul>
<h3 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h3><h4 id="内存管理-1"><a href="#内存管理-1" class="headerlink" title="内存管理"></a>内存管理</h4><ul>
<li><code>brk</code>/<code>sbrk</code>：改变数据段空间分配</li>
<li><code>mlock</code>：内存页面加锁</li>
<li><code>munlock</code>：内存页面解锁</li>
<li><code>mlockall</code>：进程所有内存页面加锁</li>
<li><code>munlockall</code>：进程所有内存页面解锁</li>
<li><code>mmap</code>：映射虚拟内存页</li>
<li><code>munmap</code>：去除内存映射页</li>
<li><code>mremap</code>：重新映射虚拟内存地址</li>
<li><code>msync</code>：将映射内存中数据写回磁盘</li>
<li><code>mprotect</code>：设置内存映像保护</li>
<li><code>getpagesize</code>：获取页面大小</li>
<li><code>sync</code>：将内存缓冲区数据写回磁盘</li>
<li><code>cacheflush</code>：将指定缓冲区中内容写回磁盘</li>
</ul>
<h4 id="共享内存"><a href="#共享内存" class="headerlink" title="共享内存"></a>共享内存</h4><ul>
<li><code>shmctl</code>：控制共享内存</li>
<li><code>shmget</code>：获取共享内存</li>
<li><code>shmat</code>：连接共享内存</li>
<li><code>shmdt</code>：卸载共享内存</li>
</ul>
<h3 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h3><h4 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h4><ul>
<li><code>tcntl</code>：文件控制</li>
<li><code>open</code>：打开文件</li>
<li><code>creat</code>：创建新文件</li>
<li><code>close</code>    ：关闭文件描述字</li>
<li><code>read</code>：读文件</li>
<li><code>write</code>：写文件</li>
<li><code>readv</code>：从文件读入数据到缓存区</li>
<li><code>writev</code>：将缓冲区数据写入文件</li>
<li><code>pread</code>：随机读文件</li>
<li><code>pwrite</code>：随机写文件</li>
<li><code>lseek</code>：移动文件指针</li>
<li><code>_llseek</code>：64位地址空间中移动文件指针</li>
<li><code>dup</code>：复制已打开的文件描述字</li>
<li><code>dup2</code>：按指定条件复制文件描述字</li>
<li><code>flock</code>：文件加/解锁</li>
<li><code>poll</code>：IO多路切换</li>
<li><code>truncat</code>/<code>ftruncate</code>：截断文件</li>
<li><code>vumask</code>：设置文件权限掩码</li>
<li><code>fsync</code>：将内存中文件数据写入磁盘</li>
</ul>
<h4 id="文件系统操作"><a href="#文件系统操作" class="headerlink" title="文件系统操作"></a>文件系统操作</h4><ul>
<li><code>access</code>：确定文件可存取性</li>
<li><code>chdir</code>/<code>fchdir</code>：改变当前工作目录</li>
<li><code>chmod</code>/<code>fchmod</code>：改变文件模式</li>
<li><code>chown</code>/<code>fchown</code>/<code>lchown</code>：改变文件属主、用户组</li>
<li><code>chroot</code>：改变根目录</li>
<li><code>stat</code>/<code>lstat</code>/<code>fstat</code>：获取文件状态信息</li>
<li><code>statfs</code>/<code>fstatfs</code>：获取文件系统信息</li>
<li><code>ustat</code>：读取文件系统信息</li>
<li><code>mount</code>：安装文件系统</li>
<li><code>umount</code>：卸载文件系统</li>
<li><code>readdir</code>：读取目录项</li>
<li><code>getdents</code>：读取目录项</li>
<li><code>mkdir</code>：创建目录</li>
<li><code>mknod</code>：创建索引节点</li>
<li><code>rmdir</code>：删除目录</li>
<li><code>rename</code>：文件改名</li>
<li><code>link</code>：创建链接</li>
<li><code>symlink</code>：创建符号链接</li>
<li><code>unlink</code>：删除链接</li>
<li><code>readlink</code>：读取符合链接值</li>
<li><code>utime</code>/<code>utimes</code>：改变文件的访问修改时间</li>
<li><code>quotactl</code>：控制磁盘配额</li>
</ul>
<h3 id="驱动管理"><a href="#驱动管理" class="headerlink" title="驱动管理"></a>驱动管理</h3><h4 id="系统控制"><a href="#系统控制" class="headerlink" title="系统控制"></a>系统控制</h4><ul>
<li><code>ioctl</code>：IO总控制函数</li>
<li><code>_sysctl</code>：读写系统参数</li>
<li><code>acct</code>：启用或禁用进程记账</li>
<li><code>getrlimit</code>：获取系统资源上限</li>
<li><code>setrlimit</code>：设置系统资源上限</li>
<li><code>getrusage</code>：获取系统资源使用情况</li>
<li><code>uselib</code>：选择要使用的二进制库</li>
<li><code>ioperm</code>：设置端口IO权限</li>
<li><code>iopl</code>：改变进程IO权限级别</li>
<li><code>outb</code>：低级端口操作</li>
<li><code>reboot</code>：重启</li>
<li><code>swapon</code>：开启交换文件和设备</li>
<li><code>swapoff</code>：关闭交换文件和设备</li>
<li><code>bdflush</code>：控制bdflush守护进程</li>
<li><code>sysfs</code>：获取核心支持的文件系统类型</li>
<li><code>sysinfo</code>：获取系统信息</li>
<li><code>adjtimex</code>：调整系统时钟</li>
<li><code>getitimer</code>：获取计时器值</li>
<li><code>setitimer</code>：设置计时器值</li>
<li><code>gettimeofday</code>：获取时间、时区</li>
<li><code>settimeofday</code>：设置时间、时区</li>
<li><code>stime</code>：设置系统日期和时间</li>
<li><code>time</code>：获取系统时间</li>
<li><code>times</code>：获取进程运行时间</li>
<li><code>uname</code>：获取当前unix系统名称、版本、主机信息</li>
<li><code>vhangup</code>：挂起当前终端</li>
<li><code>nfsservctl</code>：控制NFS守护进程</li>
<li><code>vm86</code>：进入模拟8086模式</li>
<li><code>create_module</code>：创建可载入模块项</li>
<li><code>delete_module</code>：删除可载入模块项</li>
<li><code>init_module</code>：初始化模块</li>
<li><code>query_module</code>：查询模型信息</li>
</ul>
<h3 id="网络管理"><a href="#网络管理" class="headerlink" title="网络管理"></a>网络管理</h3><h4 id="网络管理-1"><a href="#网络管理-1" class="headerlink" title="网络管理"></a>网络管理</h4><ul>
<li><code>getdomainname</code>：获取域名</li>
<li><code>setdomainname</code>：设置域名</li>
<li><code>gethostid</code>：获取主机标识号</li>
<li><code>sethostid</code>：设置主机标识号</li>
<li><code>gethostname</code>：获取主机名称</li>
<li><code>sethostname</code>：设置主机名称</li>
</ul>
<h4 id="Socket控制"><a href="#Socket控制" class="headerlink" title="Socket控制"></a>Socket控制</h4><ul>
<li><code>socketcall</code>：socket系统调用</li>
<li><code>socket</code>：建立socket</li>
<li><code>bind</code>：绑定socket到端口</li>
<li><code>connect</code>：连接远程主机</li>
<li><code>accept</code>：响应socket连接请求</li>
<li><code>send</code>/<code>sendmsg</code>：通过socket发送信息</li>
<li><code>sendto</code>：发送UDP信息</li>
<li><code>recv</code>/<code>recvmsg</code>：通过socket接收信息</li>
<li><code>recvfrom</code>：接收UDP信息</li>
<li><code>listen</code>：监听socket端口</li>
<li><code>select</code>：对多路同步IO进行轮询</li>
<li><code>shutdown</code>：关闭socket上连接</li>
<li><code>getsockname</code>：获取本地socket名称</li>
<li><code>getpeername</code>：获取通信对方socket名称</li>
<li><code>getsockopt</code>：获取端口设置</li>
<li><code>setsockopt</code>：设置端口参数</li>
<li><code>sendfile</code>：在文件端口间传输数据</li>
<li><code>socketpair</code>：创建一对已连接的无名socket</li>
</ul>
<h3 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h3><ul>
<li><code>getuid</code>：获取用户标识号</li>
<li><code>setuid</code>：设置用户标识号</li>
<li><code>getgid</code>：获取组标识号</li>
<li><code>setgid</code>：设置组标识号</li>
<li><code>getegid</code>：获取有效组标识号</li>
<li><code>setegid</code>：设置有效组标识号</li>
<li><code>geteuid</code>：获取有效用户标识号</li>
<li><code>seteuid</code>：设置有效用户标识号</li>
<li><code>setregid</code>：分别设置真实、有效的组标识号</li>
<li><code>setreuid</code>：分别设置真实、有效的用户标识号</li>
<li><code>getresgid</code>：分别获取真实、有效、保存过的组标识号</li>
<li><code>setresgid</code>：分别设置真实、有效、保存过的组标识号</li>
<li><code>getresuid</code>：分别获取真实、有效、保存过的用户标识号</li>
<li><code>setresuid</code>：分别设置真实、有效、保存过的用户标识号</li>
<li><code>setfsgid</code>：设置文件系统检查时使用的组标识号</li>
<li><code>setfsuid</code>：设置文件系统检查时使用的用户标识号</li>
<li><code>getgroups</code>：获取候补组标志清单</li>
<li><code>setgroups</code>：设置候补组标志清单</li>
</ul>
<h4 id="通知内核-1"><a href="#通知内核-1" class="headerlink" title="通知内核"></a>通知内核</h4><ul>
<li><p>一般系统调用都是通过软件中断向内核发请求，实现内核提供的
某些服务</p>
<ul>
<li>128号异常处理程序就是系统调用处理程序<code>system_call()</code></li>
</ul>
</li>
<li><p>用户空间进程不能直接执行内核代码，需要通过中断通知内核
需要执行系统调用，希望系统切换到内核态，让内核可以代表
应用程序执行系统调用</p>
</li>
<li><p>通知内核机制是靠软件中断实现，X86机器上软中断由int产生</p>
<ul>
<li>用户程序为系统调用设置参数，其中一个参数是系统调用
编号</li>
<li>程序执行“系统调用”指令，该指令会导致异常</li>
<li>保存程序状态</li>
<li>处理器切换到内核态并跳转到新地址，并开始执行异常处理
程序，即系统调用处理程序</li>
<li>将控制权返还给用户程序</li>
</ul>
</li>
<li><p><code>arch/i386/kernel/head.s</code></p>
</li>
<li><code>init/main.c</code></li>
<li><code>arhc/i386/kernel/traps.c</code></li>
<li><code>include/asm/system.h</code></li>
</ul>
<h4 id="参数传递-2"><a href="#参数传递-2" class="headerlink" title="参数传递"></a>参数传递</h4><ul>
<li><p><code>_syscalN()</code>用于系统调用的格式转换和参数传递</p>
<ul>
<li>参数数量为<code>N</code>的系统调用由<code>_syscallN()</code>负责</li>
<li><code>N</code>取值为<code>0-5</code>之间的整数</li>
</ul>
</li>
<li><p>启动<code>INT 0x80</code>后，规定返回值送eax寄存器</p>
<blockquote>
<ul>
<li>定义于<code>include/asm/unistd.h</code>，用于系统调用的格式转换
 和参数传递</li>
</ul>
</blockquote>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-21T01:06:45.000Z" title="9/21/2020, 9:06:45 AM">2020-09-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-21T01:06:45.000Z" title="9/21/2020, 9:06:45 AM">2020-09-21</time></span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a><span> / </span><a class="link-muted" href="/categories/Linux/IPC/">IPC</a></span><span class="level-item">a minute read (About 145 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/IPC/ipc_interrupt.html">Linux Interrupt</a></h1><div class="content"><h2 id="中断"><a href="#中断" class="headerlink" title="中断"></a>中断</h2><ul>
<li><p>软中断：</p>
</li>
<li><p>硬中断：外围设备完成用户请求后，会向CPU发出中断信号</p>
<ul>
<li>CPU会暂停执行下条将要执行的指令，转而执行中断信号
对应处理程序，并将进程转入内核态</li>
</ul>
</li>
</ul>
<h2 id="Interrupt"><a href="#Interrupt" class="headerlink" title="Interrupt"></a>Interrupt</h2><ul>
<li><p>中断属性</p>
<ul>
<li>中断号：标识不同中断</li>
<li>中断处理程序：不同中断有不同处理程序</li>
</ul>
</li>
<li><p><em>interrupt vector table</em>：内核中维护，存储所有中断处理
程序地址</p>
<ul>
<li>中断号就是相应中断在中断向量表中偏移量</li>
</ul>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-01T08:10:05.000Z" title="9/1/2020, 4:10:05 PM">2020-09-01</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-01T08:10:05.000Z" title="9/1/2020, 4:10:05 PM">2020-09-01</time></span><span class="level-item"><a class="link-muted" href="/categories/Tool/">Tool</a><span> / </span><a class="link-muted" href="/categories/Tool/Windows/">Windows</a></span><span class="level-item">12 minutes read (About 1740 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Tool/Windows/excel.html">Excel技巧</a></h1><div class="content"><h2 id="EXCEL密码破解"><a href="#EXCEL密码破解" class="headerlink" title="EXCEL密码破解"></a>EXCEL密码破解</h2><h3 id="VBAProject密码"><a href="#VBAProject密码" class="headerlink" title="VBAProject密码"></a>VBAProject密码</h3><ul>
<li><p><code>vbaProject.bin</code>中密码对应字段</p>
<ul>
<li><code>DPB</code>：当前已存在密码，后跟加密密码值</li>
</ul>
</li>
<li><p><code>xls</code>：97-03格式表格是RAR格式压缩文件</p>
<ul>
<li>解压之后再次压缩一般无法正常打开，应该是有特殊的压缩
规则</li>
<li>可以直接用编辑器打开、修改整个文件，但要注意以二进制
格式打开</li>
</ul>
</li>
<li><p><code>xlsm</code>：07之后带宏表格是ZIP压缩文件</p>
<ul>
<li>解压之后再次zip打包也无法正常打开，但是zip格式可以
直接替换其中文件，所以可以直接修改单个文件</li>
<li>vim对zip格式文件处理类型文件夹，所以使用vim二进制打开
可以修改其中单个文件</li>
</ul>
</li>
</ul>
<h4 id="修改二进制文件"><a href="#修改二进制文件" class="headerlink" title="修改二进制文件"></a>修改二进制文件</h4><ul>
<li><p>处理方法：将密码对应字段“无效”</p>
<ul>
<li>需要保持文件前后大小不改变</li>
<li>密码字段无效化</li>
</ul>
</li>
<li><p>“删除”密码字段</p>
<ul>
<li>将<code>DPB</code>字段替换为<strong>等长</strong>其他名称<ul>
<li>密码无法被正常识别</li>
<li>文件大小没有改变，仅字符被替换</li>
</ul>
</li>
<li>再次打开文件，启用宏会报错<ul>
<li>不断点击确认之后即可查看vba工程</li>
<li>为vba工程设置新密码，覆盖替换后错误字段，保存
可得已知密码文件<ul>
<li>右键<em>VBAProject</em></li>
<li>工程属性</li>
<li>保护</li>
<li>查看工程属性密码：修改为新密码即可</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>替换密码字段</p>
<ul>
<li>将<code>DPB</code>后密码值替换为其他值<ul>
<li>为保证文件大小不变<ul>
<li>若新密码较短需要用<code>0</code>填充不足部分</li>
<li>较原始密码长则无需额外操作</li>
</ul>
</li>
</ul>
</li>
<li>打开文件则可以使用已知密码查看vba工程</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 二进制打开文件，否则vim会做某些处理，损坏文件</span></span><br><span class="line">$ vim -b &lt;file&gt;</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 调用xxd转换字符格式为16进制</span></span><br><span class="line"> <span class="comment"># 可看到16进制、字符对应格式</span></span><br><span class="line"> <span class="comment"># 仅修改左侧16进制有效，修改右侧字符表示不影响文件</span></span><br><span class="line"> <span class="comment"># 内容</span></span><br><span class="line">$ !%xxd</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 16进制转换回原始表示</span></span><br><span class="line">$ !%xxd -r</span><br></pre></td></tr></table></figure>
<h4 id="VBA脚本穷举密码"><a href="#VBA脚本穷举密码" class="headerlink" title="VBA脚本穷举密码"></a>VBA脚本穷举密码</h4><ul>
<li><p><code>xls</code>格式：打开VBA编辑器执行代码</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&#x27;移除VBA编码保护</span></span><br><span class="line"><span class="keyword">Sub</span> MoveProtect()</span><br><span class="line">	<span class="keyword">Dim</span> FileName <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	FileName = Application.GetOpenFilename(<span class="string">&quot;Excel文件（*.xls &amp; *.xla）,*.xls;*.xla&quot;</span>, , <span class="string">&quot;VBA破解&quot;</span>)</span><br><span class="line">	<span class="keyword">If</span> FileName = <span class="built_in">CStr</span>(<span class="literal">False</span>) <span class="keyword">Then</span></span><br><span class="line">	   <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">Else</span></span><br><span class="line">	   VBAPassword FileName, <span class="literal">False</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&#x27;设置VBA编码保护</span></span><br><span class="line"><span class="keyword">Sub</span> SetProtect()</span><br><span class="line">	<span class="keyword">Dim</span> FileName <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	FileName = Application.GetOpenFilename(<span class="string">&quot;Excel文件（*.xls &amp; *.xla）,*.xls;*.xla&quot;</span>, , <span class="string">&quot;VBA破解&quot;</span>)</span><br><span class="line">	<span class="keyword">If</span> FileName = <span class="built_in">CStr</span>(<span class="literal">False</span>) <span class="keyword">Then</span></span><br><span class="line">	   <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">Else</span></span><br><span class="line">	   VBAPassword FileName, <span class="literal">True</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">Private</span> <span class="keyword">Function</span> VBAPassword(FileName <span class="keyword">As</span> <span class="type">String</span>, <span class="keyword">Optional</span> Protect <span class="keyword">As</span> <span class="type">Boolean</span> = <span class="literal">False</span>)</span><br><span class="line">	  <span class="keyword">If</span> Dir(FileName) = <span class="string">&quot;&quot;</span> <span class="keyword">Then</span></span><br><span class="line">		 <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">	  <span class="keyword">Else</span></span><br><span class="line">		 FileCopy FileName, FileName &amp; <span class="string">&quot;.bak&quot;</span></span><br><span class="line">	  <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"> </span><br><span class="line">	  <span class="keyword">Dim</span> GetData <span class="keyword">As</span> <span class="type">String</span> * <span class="number">5</span></span><br><span class="line">	  Open FileName <span class="keyword">For</span> <span class="keyword">Binary</span> <span class="keyword">As</span> #<span class="number">1</span></span><br><span class="line">	  <span class="keyword">Dim</span> CMGs <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	  <span class="keyword">Dim</span> DPBo <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	  <span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> LOF(<span class="number">1</span>)</span><br><span class="line">		  <span class="keyword">Get</span> #<span class="number">1</span>, i, GetData</span><br><span class="line">		  <span class="keyword">If</span> GetData = <span class="string">&quot;CMG=&quot;&quot;&quot;</span> <span class="keyword">Then</span> CMGs = i</span><br><span class="line">		  <span class="keyword">If</span> GetData = <span class="string">&quot;[Host&quot;</span> <span class="keyword">Then</span> DPBo = i - <span class="number">2</span>: <span class="keyword">Exit</span> <span class="keyword">For</span></span><br><span class="line">	  <span class="keyword">Next</span></span><br><span class="line">	  <span class="keyword">If</span> CMGs = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">		 MsgBox <span class="string">&quot;请先对VBA编码设置一个保护密码...&quot;</span>, <span class="number">32</span>, <span class="string">&quot;提示&quot;</span></span><br><span class="line">		 <span class="keyword">Exit</span> <span class="keyword">Function</span></span><br><span class="line">	  <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	  <span class="keyword">If</span> Protect = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">		 <span class="keyword">Dim</span> St <span class="keyword">As</span> <span class="type">String</span> * <span class="number">2</span></span><br><span class="line">		 <span class="keyword">Dim</span> s20 <span class="keyword">As</span> <span class="type">String</span> * <span class="number">1</span></span><br><span class="line">		 <span class="comment">&#x27;取得一个0D0A十六进制字串</span></span><br><span class="line">		 <span class="keyword">Get</span> #<span class="number">1</span>, CMGs - <span class="number">2</span>, St</span><br><span class="line">		 <span class="comment">&#x27;取得一个20十六制字串</span></span><br><span class="line">		 <span class="keyword">Get</span> #<span class="number">1</span>, DPBo + <span class="number">16</span>, s20</span><br><span class="line">		 <span class="comment">&#x27;替换加密部份机码</span></span><br><span class="line">		 <span class="keyword">For</span> i = CMGs <span class="keyword">To</span> DPBo <span class="keyword">Step</span> <span class="number">2</span></span><br><span class="line">			 Put #<span class="number">1</span>, i, St</span><br><span class="line">		 <span class="keyword">Next</span></span><br><span class="line">		 <span class="comment">&#x27;加入不配对符号</span></span><br><span class="line">		 <span class="keyword">If</span> (DPBo - CMGs) <span class="built_in">Mod</span> <span class="number">2</span> &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">			Put #<span class="number">1</span>, DPBo + <span class="number">1</span>, s20</span><br><span class="line">		 <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">		 MsgBox <span class="string">&quot;文件解密成功......&quot;</span>, <span class="number">32</span>, <span class="string">&quot;提示&quot;</span></span><br><span class="line">	  <span class="keyword">Else</span></span><br><span class="line">		 <span class="keyword">Dim</span> MMs <span class="keyword">As</span> <span class="type">String</span> * <span class="number">5</span></span><br><span class="line">		 MMs = <span class="string">&quot;DPB=&quot;&quot;&quot;</span></span><br><span class="line">		 Put #<span class="number">1</span>, CMGs, MMs</span><br><span class="line">		 MsgBox <span class="string">&quot;对文件特殊加密成功......&quot;</span>, <span class="number">32</span>, <span class="string">&quot;提示&quot;</span></span><br><span class="line">	  <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	  Close #<span class="number">1</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Sheet保护密码"><a href="#Sheet保护密码" class="headerlink" title="Sheet保护密码"></a>Sheet保护密码</h3><h4 id="VBA脚本"><a href="#VBA脚本" class="headerlink" title="VBA脚本"></a>VBA脚本</h4><ul>
<li><p><code>xlsx</code>：打开VBA编辑器执行代码</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> pj()</span><br><span class="line"><span class="keyword">Dim</span> sht <span class="keyword">As</span> Worksheet</span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> sht <span class="keyword">In</span> Worksheets</span><br><span class="line">sht.Protect AllowFiltering:=<span class="literal">True</span></span><br><span class="line">sht.Unprotect</span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>xls</code>：打开VBA编辑器执行代码</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Public</span> <span class="keyword">Sub</span> AllInternalPasswords()</span><br><span class="line"><span class="comment">&#x27; Breaks worksheet and workbook structure passwords. Bob McCormick</span></span><br><span class="line"><span class="comment">&#x27; probably originator of base code algorithm modified for coverage</span></span><br><span class="line"><span class="comment">&#x27; of workbook structure / windows passwords and for multiple passwords</span></span><br><span class="line"><span class="comment">&#x27;</span></span><br><span class="line"><span class="comment">&#x27; Norman Harker and JE McGimpsey 27-Dec-2002 (Version 1.1)</span></span><br><span class="line"><span class="comment">&#x27; Modified 2003-Apr-04 by JEM: All msgs to constants, and</span></span><br><span class="line"><span class="comment">&#x27; eliminate one Exit Sub (Version 1.1.1)</span></span><br><span class="line"><span class="comment">&#x27; Reveals hashed passwords NOT original passwords</span></span><br><span class="line"><span class="keyword">Const</span> DBLSPACE <span class="keyword">As</span> <span class="type">String</span> = vbNewLine &amp; vbNewLine</span><br><span class="line"><span class="keyword">Const</span> AUTHORS <span class="keyword">As</span> <span class="type">String</span> = DBLSPACE &amp; vbNewLine &amp; _</span><br><span class="line"><span class="string">&quot;Adapted from Bob McCormick base code by&quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;Norman Harker and JE McGimpsey&quot;</span></span><br><span class="line"><span class="keyword">Const</span> HEADER <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;AllInternalPasswords User Message&quot;</span></span><br><span class="line"><span class="keyword">Const</span> VERSION <span class="keyword">As</span> <span class="type">String</span> = DBLSPACE &amp; <span class="string">&quot;Version 1.1.1 2003-Apr-04&quot;</span></span><br><span class="line"><span class="keyword">Const</span> REPBACK <span class="keyword">As</span> <span class="type">String</span> = DBLSPACE &amp; <span class="string">&quot;Please report failure &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;to the microsoft.public.excel.programming newsgroup.&quot;</span></span><br><span class="line"><span class="keyword">Const</span> ALLCLEAR <span class="keyword">As</span> <span class="type">String</span> = DBLSPACE &amp; <span class="string">&quot;The workbook should &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;now be free of all password protection, so make sure you:&quot;</span> &amp; _</span><br><span class="line">DBLSPACE &amp; <span class="string">&quot;SAVE IT NOW!&quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;and also&quot;</span> &amp; _</span><br><span class="line">DBLSPACE &amp; <span class="string">&quot;BACKUP!, BACKUP!!, BACKUP!!!&quot;</span> &amp; _</span><br><span class="line">DBLSPACE &amp; <span class="string">&quot;Also, remember that the password was &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;put there for a reason. Don&#x27;t stuff up crucial formulas &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;or data.&quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;Access and use of some data &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;may be an offense. If in doubt, don&#x27;t.&quot;</span></span><br><span class="line"><span class="keyword">Const</span> MSGNOPWORDS1 <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;There were no passwords on &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;sheets, or workbook structure or windows.&quot;</span> &amp; AUTHORS &amp; VERSION</span><br><span class="line"><span class="keyword">Const</span> MSGNOPWORDS2 <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;There was no protection to &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;workbook structure or windows.&quot;</span> &amp; DBLSPACE &amp; _</span><br><span class="line"><span class="string">&quot;Proceeding to unprotect sheets.&quot;</span> &amp; AUTHORS &amp; VERSION</span><br><span class="line"><span class="keyword">Const</span> MSGTAKETIME <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;After pressing OK button this &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;will take some time.&quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;Amount of time &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;depends on how many different passwords, the &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;passwords, and your computer&#x27;s specification.&quot;</span> &amp; DBLSPACE &amp; _</span><br><span class="line"><span class="string">&quot;Just be patient! Make me a coffee!&quot;</span> &amp; AUTHORS &amp; VERSION</span><br><span class="line"><span class="keyword">Const</span> MSGPWORDFOUND1 <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;You had a Worksheet &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;Structure or Windows Password set.&quot;</span> &amp; DBLSPACE &amp; _</span><br><span class="line"><span class="string">&quot;The password found was: &quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;$$&quot;</span> &amp; DBLSPACE &amp; _</span><br><span class="line"><span class="string">&quot;Note it down for potential future use in other workbooks by &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;the same person who set this password.&quot;</span> &amp; DBLSPACE &amp; _</span><br><span class="line"><span class="string">&quot;Now to check and clear other passwords.&quot;</span> &amp; AUTHORS &amp; VERSION</span><br><span class="line"><span class="keyword">Const</span> MSGPWORDFOUND2 <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;You had a Worksheet &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;password set.&quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;The password found was: &quot;</span> &amp; _</span><br><span class="line">DBLSPACE &amp; <span class="string">&quot;$$&quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;Note it down for potential &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;future use in other workbooks by same person who &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;set this password.&quot;</span> &amp; DBLSPACE &amp; <span class="string">&quot;Now to check and clear &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;other passwords.&quot;</span> &amp; AUTHORS &amp; VERSION</span><br><span class="line"><span class="keyword">Const</span> MSGONLYONE <span class="keyword">As</span> <span class="type">String</span> = <span class="string">&quot;Only structure / windows &quot;</span> &amp; _</span><br><span class="line"><span class="string">&quot;protected with the password that was just found.&quot;</span> &amp; _</span><br><span class="line">ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK</span><br><span class="line"><span class="keyword">Dim</span> w1 <span class="keyword">As</span> Worksheet, w2 <span class="keyword">As</span> Worksheet</span><br><span class="line"><span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span>, j <span class="keyword">As</span> <span class="type">Integer</span>, k <span class="keyword">As</span> <span class="type">Integer</span>, l <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">Dim</span> m <span class="keyword">As</span> <span class="type">Integer</span>, n <span class="keyword">As</span> <span class="type">Integer</span>, i1 <span class="keyword">As</span> <span class="type">Integer</span>, i2 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">Dim</span> i3 <span class="keyword">As</span> <span class="type">Integer</span>, i4 <span class="keyword">As</span> <span class="type">Integer</span>, i5 <span class="keyword">As</span> <span class="type">Integer</span>, i6 <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line"><span class="keyword">Dim</span> PWord1 <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> ShTag <span class="keyword">As</span> <span class="type">Boolean</span>, WinTag <span class="keyword">As</span> <span class="type">Boolean</span></span><br><span class="line"></span><br><span class="line">Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line"><span class="keyword">With</span> ActiveWorkbook</span><br><span class="line">WinTag = .ProtectStructure <span class="built_in">Or</span> .ProtectWindows</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">ShTag = <span class="literal">False</span></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> w1 <span class="keyword">In</span> Worksheets</span><br><span class="line">ShTag = ShTag <span class="built_in">Or</span> w1.ProtectContents</span><br><span class="line"><span class="keyword">Next</span> w1</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">Not</span> ShTag <span class="built_in">And</span> <span class="built_in">Not</span> WinTag <span class="keyword">Then</span></span><br><span class="line">MsgBox MSGNOPWORDS1, vbInformation, HEADER</span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">MsgBox MSGTAKETIME, vbInformation, HEADER</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">Not</span> WinTag <span class="keyword">Then</span></span><br><span class="line">MsgBox MSGNOPWORDS2, vbInformation, HEADER</span><br><span class="line"><span class="keyword">Else</span></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">Do</span> <span class="comment">&#x27;dummy do loop</span></span><br><span class="line"><span class="keyword">For</span> i = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> j = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> k = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span></span><br><span class="line"><span class="keyword">For</span> l = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> m = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i1 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span></span><br><span class="line"><span class="keyword">For</span> i2 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i3 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i4 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span></span><br><span class="line"><span class="keyword">For</span> i5 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i6 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> n = <span class="number">32</span> <span class="keyword">To</span> <span class="number">126</span></span><br><span class="line"><span class="keyword">With</span> ActiveWorkbook</span><br><span class="line">.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _</span><br><span class="line">Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; _</span><br><span class="line">Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span><br><span class="line"><span class="keyword">If</span> .ProtectStructure = <span class="literal">False</span> <span class="built_in">And</span> _</span><br><span class="line">.ProtectWindows = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _</span><br><span class="line">Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span><br><span class="line">Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span><br><span class="line">MsgBox Application.Substitute(MSGPWORDFOUND1, _</span><br><span class="line"><span class="string">&quot;$$&quot;</span>, PWord1), vbInformation, HEADER</span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Do</span> <span class="comment">&#x27;Bypass all for...nexts</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="symbol">Next:</span> <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span></span><br><span class="line"><span class="symbol">Next:</span> <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">Loop</span> <span class="keyword">Until</span> <span class="literal">True</span></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">If</span> WinTag <span class="built_in">And</span> <span class="built_in">Not</span> ShTag <span class="keyword">Then</span></span><br><span class="line">MsgBox MSGONLYONE, vbInformation, HEADER</span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> w1 <span class="keyword">In</span> Worksheets</span><br><span class="line"><span class="comment">&#x27;Attempt clearance with PWord1</span></span><br><span class="line">w1.Unprotect PWord1</span><br><span class="line"><span class="keyword">Next</span> w1</span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line">ShTag = <span class="literal">False</span></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> w1 <span class="keyword">In</span> Worksheets</span><br><span class="line"><span class="comment">&#x27;Checks for all clear ShTag triggered to 1 if not.</span></span><br><span class="line">ShTag = ShTag <span class="built_in">Or</span> w1.ProtectContents</span><br><span class="line"><span class="keyword">Next</span> w1</span><br><span class="line"><span class="keyword">If</span> ShTag <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> w1 <span class="keyword">In</span> Worksheets</span><br><span class="line"><span class="keyword">With</span> w1</span><br><span class="line"><span class="keyword">If</span> .ProtectContents <span class="keyword">Then</span></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">Do</span> <span class="comment">&#x27;Dummy do loop</span></span><br><span class="line"><span class="keyword">For</span> i = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> j = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> k = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span></span><br><span class="line"><span class="keyword">For</span> l = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> m = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i1 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span></span><br><span class="line"><span class="keyword">For</span> i2 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i3 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i4 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span></span><br><span class="line"><span class="keyword">For</span> i5 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> i6 = <span class="number">65</span> <span class="keyword">To</span> <span class="number">66</span>: <span class="keyword">For</span> n = <span class="number">32</span> <span class="keyword">To</span> <span class="number">126</span></span><br><span class="line">.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _</span><br><span class="line">Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span><br><span class="line">Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span><br><span class="line"><span class="keyword">If</span> <span class="built_in">Not</span> .ProtectContents <span class="keyword">Then</span></span><br><span class="line">PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _</span><br><span class="line">Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span><br><span class="line">Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span><br><span class="line">MsgBox Application.Substitute(MSGPWORDFOUND2, _</span><br><span class="line"><span class="string">&quot;$$&quot;</span>, PWord1), vbInformation, HEADER</span><br><span class="line"><span class="comment">&#x27;leverage finding Pword by trying on other sheets</span></span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> w2 <span class="keyword">In</span> Worksheets</span><br><span class="line">w2.Unprotect PWord1</span><br><span class="line"><span class="keyword">Next</span> w2</span><br><span class="line"><span class="keyword">Exit</span> <span class="keyword">Do</span> <span class="comment">&#x27;Bypass all for...nexts</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="symbol">Next:</span> <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span></span><br><span class="line"><span class="symbol">Next:</span> <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span>: <span class="keyword">Next</span></span><br><span class="line"><span class="keyword">Loop</span> <span class="keyword">Until</span> <span class="literal">True</span></span><br><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="keyword">Next</span> w1</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">MsgBox ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK, vbInformation, HEADER</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-08-17T13:20:05.000Z" title="8/17/2020, 9:20:05 PM">2020-08-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T08:56:12.000Z" title="7/16/2021, 4:56:12 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/ML-Technique/">ML Technique</a><span> / </span><a class="link-muted" href="/categories/ML-Technique/Feature-Engineering/">Feature Engineering</a></span><span class="level-item">13 minutes read (About 1986 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ML-Technique/Feature-Engineering/sampling.html">抽样方法</a></h1><div class="content"><h2 id="数据抽样"><a href="#数据抽样" class="headerlink" title="数据抽样"></a>数据抽样</h2><ul>
<li><p>抽样作用</p>
<ul>
<li>提高速度、效率，将精力放在建立模型、选择模型上</li>
<li>帮助分析特殊性问题：有些问题涉及到破坏性试验，抽取产品的一部分做耐用性实验经济有效</li>
<li>降低成本：合理抽样可以保证在大部分信息不丢失情况下，降低数据采集、社会调查成本</li>
</ul>
</li>
<li><p>从效率、成本角度看，适当、合理抽样有必要</p>
<ul>
<li>数据越多信息越丰富、数据量尽量多为好</li>
<li>抽样可以降低求解的时空代价，但是可能会丢失部分信息，可能会使分析结果产生偏差</li>
<li>在分析阶段，若抽样误差能够接受，完全可以抽样</li>
</ul>
</li>
<li><p>样本应能充分代表总体</p>
<ul>
<li>一般样本容量越大，和总体的相似程度越高，样本质量越高</li>
<li>但大样本不等于总体：理论上再大的局部抽样也不如随机抽样有代表性</li>
</ul>
</li>
</ul>
<h2 id="样本评价"><a href="#样本评价" class="headerlink" title="样本评价"></a>样本评价</h2><ul>
<li>样本容量、样本质量是衡量抽样样本的两个最重要因素<ul>
<li>样本容量：抽样过程中抽取的样本数</li>
<li>样本质量：衡量抽样样本的代表性</li>
</ul>
</li>
</ul>
<h3 id="样本质量"><a href="#样本质量" class="headerlink" title="样本质量"></a>样本质量</h3><p>样本质量：抽样样本与整体的相似性</p>
<script type="math/tex; mode=display">\begin{align*}
J(S, D) & = \frac {1} {D} \sum_{k=1}^{r} J_{k}(S, D) \\
J_{k}(S, D) & = \sum_{j=1}^{N_k}(P_{Sj} - P_{Dj})
    log \frac {P_{Sj}} {P_{Dj}} \\
Q(s) & = exp(-J)
\end{align*}</script><blockquote>
<ul>
<li>$D$：数据集，包含 $r$ 个属性</li>
<li>$S$：抽样样本集</li>
<li>$J_k=J(S, D)$：<em>Kullblack-Laible</em> 散度，数据集 $S$、$D$ 在属性 $k$ 上偏差程度，越小偏差越小</li>
<li>$Q(S) \in [0, 1]$：抽样集 $S$ 在数据集 $D$ 中的质量，越大样本集质量越高</li>
</ul>
</blockquote>
<ul>
<li><p>若整体 $D$ 分布稀疏，容易得到 $S$ 在某些数据点观测值数为 0，得到 $I(S, D) \rightarrow infty$</p>
<ul>
<li>可以把该点和附近的点频率进行合并，同时调整总体频率分布</li>
<li>过度合并会导致无法有效衡量数据集局部差异性</li>
</ul>
</li>
<li><p>对于连续型变量</p>
<ul>
<li>可以把变量进行适当分组：粗糙，不利于刻画数据集直接的局部差异</li>
<li>计算数据集各个取值点的非参估计，如核估计、最近邻估计等，再在公式中用各自的非参估计代替相应频率，计算样本质量</li>
</ul>
</li>
<li><p>数据包含多个指标时</p>
<ul>
<li>可以用多个指标的平均样本质量衡量整体样本质量</li>
<li>也可以根据指标重要程度，设置不同的权重</li>
</ul>
</li>
</ul>
<h3 id="样本容量"><a href="#样本容量" class="headerlink" title="样本容量"></a>样本容量</h3><ul>
<li>样本容量是评价样本的另一个重要维度<ul>
<li>样本量大、质量好、准确性高，但计算效率低</li>
<li>样本质量差、准确性低、计算效率高</li>
<li>样本质量提高不是线性的，高位样本容量上，边际效用往往较低</li>
<li>同一样本容量的不同样本的样本质量也会有差异，即样本质量不是样本容量的单调函数，包含随机扰动</li>
</ul>
</li>
</ul>
<h4 id="Statistical-Optimal-Sample-Size"><a href="#Statistical-Optimal-Sample-Size" class="headerlink" title="Statistical Optimal Sample Size"></a><em>Statistical Optimal Sample Size</em></h4><p><em>SOSS</em>：统计最优样本数</p>
<blockquote>
<ul>
<li>输入：数据集 $D$，包含 $N$ 个实例</li>
</ul>
</blockquote>
<ul>
<li><p>根据某种抽样方法，随机产生 $R$ 个样本容量分别为 $n_i, n_i \in [1, N]$ 的样本 $S$</p>
<ul>
<li>$n_i$ 取值较小处应密度比较大，因为随着 $n_i$ 增加，样本质量趋近 1，不需要太多样本</li>
<li>可以考虑使用指数序列产生在较大值处稀疏的序列作为 $n_i$ 序列的取值</li>
</ul>
</li>
<li><p>计算每个样本 $S$ 在数据集 $D$ 中的样本质量 $Q$</p>
<ul>
<li>并计算各个样本容量对应的样本质量均值 $\bar {Q_{n}}$</li>
<li>绘制曲线 $(n, \bar {Q_{n}})$</li>
</ul>
</li>
<li><p>根据给定的样本质量要求，在样本容量对应样本质量的曲线上确定近似的最优样本容量</p>
</li>
</ul>
<h2 id="测试集、训练集"><a href="#测试集、训练集" class="headerlink" title="测试集、训练集"></a>测试集、训练集</h2><ul>
<li><p>测试集、训练集划分逻辑前提</p>
<ul>
<li>在样本量足够的情况下，减少部分样本量不会影响模型精度</li>
<li>模型评价需要使用未参与建模数据验证，否则可能夸大模型效果</li>
</ul>
</li>
<li><p>测试集、训练集划分作用</p>
<ul>
<li>测试集直接参与建模，其包含信息体现在模型中</li>
<li>训练集仅仅用于评价模型效果，其包含信息<strong>未被利用</strong>，</li>
<li>因此，若无评价、对比模型需求，或有其他无需划分测试集即可评价模型，则划分测试集无意义</li>
</ul>
</li>
</ul>
<h3 id="测试集、训练集划分"><a href="#测试集、训练集划分" class="headerlink" title="测试集、训练集划分"></a>测试集、训练集划分</h3><h4 id="Hold-Out"><a href="#Hold-Out" class="headerlink" title="Hold Out"></a><em>Hold Out</em></h4><p>旁置法：将样本集随机划分为训练集、测试集，只利用训练集训练
模型</p>
<ul>
<li>适合样本量较大的场合<ul>
<li>减少部分训练数据对模型精度影响小</li>
<li>否则大量样本未参与建模，影响模型精度</li>
</ul>
</li>
<li>常用划分比例<ul>
<li>8:2</li>
<li>7:3</li>
</ul>
</li>
<li>旁置法建立模型可直接作为最终输出模型<ul>
<li>旁置法一般只建立一个模型</li>
<li>且使用旁置法场合，模型应该和全量数据训练模型效果差别不大</li>
</ul>
</li>
</ul>
<h4 id="N-fold-Cross-Validation"><a href="#N-fold-Cross-Validation" class="headerlink" title="N-fold Cross Validation"></a><em>N-fold Cross Validation</em></h4><p><em>N</em> 折交叉验证：将数据分成N份，每次将其中一份作为测试样本集，
其余N-1份作为训练样本集</p>
<ul>
<li><p>N折交叉验证可以视为旁置法、留一法的折中</p>
<ul>
<li>克服了旁置法中测试样本选取随机性的问题：每个样本都
能作为测试样本</li>
<li>解决了留一法计算成本高的问题：重复次数少</li>
</ul>
</li>
<li><p>典型的“袋外验证”</p>
<ul>
<li>袋内数据（训练样本）、袋外数据（测试样本）分开</li>
</ul>
</li>
<li><p>N折交叉验证会训练、得到N个模型，不能直接输出</p>
<ul>
<li>最终应该输出全量数据训练的模型</li>
<li>N折建立N次模型仅是为了合理的评价模型效果，以 <em>N</em> 个模型的评价指标（均值）作为全量模型的评价</li>
</ul>
</li>
</ul>
<h4 id="Leave-One-Out-Cross-Validation"><a href="#Leave-One-Out-Cross-Validation" class="headerlink" title="Leave-One-Out Cross Validation"></a><em>Leave-One-Out Cross Validation</em></h4><p>留一法：每次选择一个样本作为测试样本集，剩余 <em>n-1</em> 个观测值作为训练样本集，重复 <em>n</em> 次计算模型误差</p>
<ul>
<li>可以看作是 <em>N</em> 折交叉验证的特例</li>
</ul>
<h3 id="数据泄露"><a href="#数据泄露" class="headerlink" title="数据泄露"></a>数据泄露</h3><ul>
<li><p>特征泄露：训练过程中使用有包含有上线之后无法获取的数据</p>
<ul>
<li>时序数据中数据穿越：使用未来数据训练模型，模型将学习不应获取的未来信息</li>
</ul>
</li>
<li><p>记录泄露/训练数据泄露：切分数据集时训练集包含了测试集中部分数据</p>
<ul>
<li>会导致评估指标失真</li>
</ul>
</li>
</ul>
<h2 id="样本重抽样"><a href="#样本重抽样" class="headerlink" title="样本重抽样"></a>样本重抽样</h2><h3 id="Bootstrap"><a href="#Bootstrap" class="headerlink" title="Bootstrap"></a><em>Bootstrap</em></h3><p>重抽样自举：有放回的重复抽样，以模拟多组独立样本</p>
<ul>
<li>对样本量为 $n$ 的样本集 $S$</li>
<li>做$k$次有放回的重复抽样<ul>
<li>每轮次抽取 $n$ 个样本</li>
<li>抽取得到样本仍然放回样本集中</li>
</ul>
</li>
<li>得到 $k$ 个样本容量仍然为 $n$ 的随机样本 $S_i，(i=1,2,…,k)$</li>
</ul>
<h3 id="过采样"><a href="#过采样" class="headerlink" title="过采样"></a>过采样</h3><blockquote>
<ul>
<li><em>over-sampling</em>：过采样，小类数据样本增加样本数量</li>
</ul>
</blockquote>
<ul>
<li><em>synthetic minority over-sampling technique</em>：过采样算法，构造不同于已有样本小类样本<ul>
<li>基于距离度量选择小类别下相似样本</li>
<li>选择其中一个样本、随机选择一定数据量邻居样本</li>
<li>对选择样本某属性增加噪声，构造新数据</li>
</ul>
</li>
</ul>
<h4 id="SMOTE"><a href="#SMOTE" class="headerlink" title="SMOTE"></a><em>SMOTE</em></h4><h4 id="Borderline-SMOTE"><a href="#Borderline-SMOTE" class="headerlink" title="Borderline-SMOTE"></a><em>Borderline-SMOTE</em></h4><h3 id="欠采样"><a href="#欠采样" class="headerlink" title="欠采样"></a>欠采样</h3><blockquote>
<ul>
<li><em>under-sampling</em>：欠采样，大类数据样本减少样本数量</li>
</ul>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-08-17T13:20:05.000Z" title="8/17/2020, 9:20:05 PM">2020-08-17</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T08:54:29.000Z" title="7/16/2021, 4:54:29 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/ML-Technique/">ML Technique</a><span> / </span><a class="link-muted" href="/categories/ML-Technique/Feature-Engineering/">Feature Engineering</a></span><span class="level-item">20 minutes read (About 3005 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ML-Technique/Feature-Engineering/feature_encoding.html">特征编码</a></h1><div class="content"><h2 id="数值化：分类-gt-数值"><a href="#数值化：分类-gt-数值" class="headerlink" title="数值化：分类-&gt;数值"></a>数值化：分类-&gt;数值</h2><h3 id="Ordinal-Encoding"><a href="#Ordinal-Encoding" class="headerlink" title="Ordinal Encoding"></a><em>Ordinal Encoding</em></h3><p>序号编码：使用一位序号编码类别</p>
<ul>
<li>一般用于处理类别间具有大小关系的数据<ul>
<li>编码后依然保留了大小关系</li>
</ul>
</li>
</ul>
<h3 id="One-hot-Encoding"><a href="#One-hot-Encoding" class="headerlink" title="One-hot Encoding"></a><em>One-hot Encoding</em></h3><p>独热编码：采用N位状态位对N个可能取值进行编码</p>
<ul>
<li><p>一般用于处理类别间不具有大小关系的特征</p>
</li>
<li><p>独热编码后<strong>特征表达能力变差</strong>，特征的预测能力被人为拆分为多份</p>
<ul>
<li>通常只有部分维度是对分类、预测有帮助，需要借助特征选择降低维度</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>在经典统计中，为避免完全多重共线性，状态位/哑变量会比取值数量少 1</li>
</ul>
</blockquote>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li>能处理非数值属性</li>
<li>一定程度上扩充了特征</li>
<li>编码后向量时稀疏向量：可以使用向量的稀疏存储节省空间</li>
<li>能够处理缺失值：高维映射方法中增加维度表示缺失</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li><p><em>k-NN</em> 算法：高维空间两点间距离难以有效衡量</p>
</li>
<li><p>逻辑回归模型：参数数量随维度增加而增大，增加模型复杂度，容易出现过拟合</p>
</li>
<li><p>决策树模型</p>
<ul>
<li>产生样本切分不平衡问题，切分增益非常小<ul>
<li>每个特征只有少量样本是 1，大量样本是 0</li>
<li>较小的拆分样本集占总体比例太小，增益乘以所占比例之后几乎可以忽略</li>
<li>较大拆分样本集的几乎就是原始样本集，增益几乎为 0</li>
</ul>
</li>
<li>影响决策树的学习<ul>
<li>决策树依赖数据统计信息，独热编码将数据切分到零散小空间上，统计信息不准确、学习效果差</li>
<li>独热编码后特征表达能力边人为拆分，与其他特征竞争最优划分点失败，最终特征重要性会比实际值低</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Binary-Encoding"><a href="#Binary-Encoding" class="headerlink" title="Binary Encoding"></a><em>Binary Encoding</em></h3><p>二进制编码：先用序号编码给每个类别赋予类别 <em>ID</em>，然后将类别 <em>ID</em> 对应二进制编码作为结果</p>
<ul>
<li>本质上利用二进制类别 <em>ID</em> 进行哈希映射，得到 <em>0/1</em> 特征向量</li>
<li>特征维度小于独热编码，更节省存储空间</li>
</ul>
<h3 id="Weight-of-Evidence-Encoding"><a href="#Weight-of-Evidence-Encoding" class="headerlink" title="Weight of Evidence Encoding"></a><em>Weight of Evidence Encoding</em></h3><p><em>WOE</em> 编码：以分类变量各取值的 <em>WOE</em> 值作为编码值</p>
<script type="math/tex; mode=display">\begin{align*}
WOE_i & = log(\frac {\%B_i} {\%G_i}) \\
& = log(\frac {\#B_i / \#B_T} {\#G_i / \#G_T})
\end{align*}</script><blockquote>
<ul>
<li>$\%B_i, \%G_i$：分类变量取第 $i$ 值时，预测变量为 <em>B</em> 类、<em>G</em> 类占所有 <em>B</em> 类、<em>G</em> 类比例</li>
<li>$#B_i, #B_T$：分类变量取第 $i$ 值时，预测变量为 <em>B</em> 类占所有 <em>B</em> 类样本比例</li>
<li>$#G_i, #G_T$：分类变量取第 $i$ 值时，预测变量为 <em>G</em> 类占所有 <em>G</em> 类样本比例</li>
</ul>
</blockquote>
<ul>
<li><p><em>WOE</em> 编码是有监督的编码方式，可以衡量分类变量各取值中</p>
<ul>
<li><em>B</em> 类占所有 <em>B</em> 类样本比例、<em>G</em> 类占所有 <em>G</em> 类样本比例的差异</li>
<li><em>B</em> 类、<em>G</em> 类比例，与所有样本中 <em>B</em> 类、<em>G</em> 类比例的差异</li>
</ul>
</li>
<li><p><em>WOE</em> 编码值能体现分类变量取值的预测能力，变量各取值 <em>WOE</em> 值方差越大，变量预测能力越强</p>
<ul>
<li><em>WOE</em> 越大，表明该取值对应的取 <em>B</em> 类可能性越大</li>
<li><em>WOE</em> 越小，表明该取值对应的取 <em>G</em> 类可能性越大</li>
<li><em>WOE</em> 接近 0，表明该取值预测能力弱，对应取 <em>B</em> 类、<em>G</em> 类可能性相近</li>
</ul>
</li>
</ul>
<h4 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h4><ul>
<li><p>相较于 <em>one-hot</em> 编码</p>
<ul>
<li>特征数量不会增加，同时避免特征过于稀疏、维度灾难</li>
<li>避免特征筛选过程中，一部分特征取值被筛选，一部分被遗弃，造成特征不完整</li>
<li>将特征规范到<strong>同一尺度</strong>的数值变量，同时也便于分析特征间相关性</li>
</ul>
</li>
<li><p>在 <em>LR</em> 模型中，<em>WOE</em> 编码线性化赋予模型良好的解释性</p>
<ul>
<li><em>WOE</em> 编码本身即可反应特征各取值贡献</li>
<li>可以用于给评分卡模型中各分箱评分</li>
</ul>
</li>
</ul>
<h2 id="分类化-离散化：数值-gt-分类"><a href="#分类化-离散化：数值-gt-分类" class="headerlink" title="分类化/离散化：数值-&gt;分类"></a>分类化/离散化：数值-&gt;分类</h2><ul>
<li>分类型变量本质上无法建模，因为取值从含义上无法进行数值计算</li>
<li>将数值型映射为分类型，往往只是中间步骤，最终会将分类型取值映射回数值型</li>
</ul>
<blockquote>
<ul>
<li>若分箱数量为 2，也被成为是二元化/布尔化</li>
</ul>
</blockquote>
<h3 id="离散化综述"><a href="#离散化综述" class="headerlink" title="离散化综述"></a>离散化综述</h3><ul>
<li><p>模型使用离散特征、连续特征，是“海量离散特征+简单模型”、“少量连续特征+复杂模型”的权衡</p>
<ul>
<li><strong>海量离散特征+简单模型</strong>：难点在于特征工程，成功经验可以推广，可以多人并行研究</li>
<li><strong>少量连续特征+复杂模型</strong>：难点在于模型调优，不需要复杂的特征工程</li>
</ul>
</li>
<li><p>一般的，连续特征对预测结果影响不会突变，合理的离散化不应造成<strong>大量信息丢失</strong></p>
<ul>
<li>且若特征存在突变，模型将难以拟合（线性模型尤其）</li>
<li>反而更应该离散化为多个分类特征，方便引入非线性</li>
</ul>
</li>
<li><p>事实上，根据Cover定理，离散化增加特征维度类似于投影至高维，更可能得到较优模型（也更容易过拟合）</p>
<ul>
<li>极限角度，对所有特征、取值均离散化，则可以得到完全可分模型（除特征完全一样分类不同）</li>
</ul>
</li>
</ul>
<h4 id="描述角度"><a href="#描述角度" class="headerlink" title="描述角度"></a>描述角度</h4><p><img src="/imgs/discretization_arch_2.png" alt="discretization_arch"></p>
<ul>
<li><p><em>supervised vs. unsupervised</em>：是否使用分类信息指导离散化过程</p>
<ul>
<li>无监督<ul>
<li>如：等距、等频划分</li>
<li>无法较好的处理异常值、不均匀分布</li>
</ul>
</li>
<li>有监督<ul>
<li>利用分类信息寻找合适切分点、间隔</li>
<li>根据使用分类信息的方式有许多种</li>
</ul>
</li>
</ul>
</li>
<li><p><em>dynamic vs. static</em>：离散化、分类是否同时进行</p>
</li>
<li><p><em>global vs. local</em>：在特征空间的局部还是全局进行离散化</p>
</li>
<li><p><em>spliting vs. merging</em>/<em>top-down vs. bottom-up</em>：自顶向下划分还是自底向上合并</p>
</li>
<li><p><em>direct vs. incremental</em>：直接根据超参数确定分箱数量还是逐步改善直到中止准则</p>
</li>
</ul>
<p><img src="/imgs/discretization_arch_1.png" alt="discretization_arch"></p>
<h4 id="典型过程"><a href="#典型过程" class="headerlink" title="典型过程"></a>典型过程</h4><ul>
<li><em>sort</em>：排序</li>
<li><em>evaluate</em>：评估分割点</li>
<li><em>split or merge</em>：划分、合并</li>
<li><em>stop</em>：停止离散化</li>
</ul>
<p><img src="/imgs/discretization_steps.png" alt="discretization_steps"></p>
<h4 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h4><ul>
<li><em>Simplicity</em>：可用切分点数量衡量简单性</li>
<li><em>Consistency</em>：可以通过<strong>最小不一致数量</strong>衡量一致性<ul>
<li>不一致：样本具有相同的特征取值，但分类不同</li>
<li>分箱最小不一致数量则为，箱内样本数量减最大类别数量</li>
</ul>
</li>
<li><em>Accuracy</em>：可通过分类器进行交叉验证的准确率衡量</li>
</ul>
<h4 id="优势-1"><a href="#优势-1" class="headerlink" title="优势"></a>优势</h4><ul>
<li><p>方便工业应用、实现</p>
<ul>
<li>离散特征的增加、减少容易，方便模型迭代</li>
<li>特征离散化处理缺失值、异常值更方便，可直接将其映射为某取值</li>
<li>数值化后可指定取值类型，如：<em>one-hot</em>编码为为稀疏向量<ul>
<li>內积速度快</li>
<li>存储方便</li>
<li>容易扩展</li>
</ul>
</li>
</ul>
</li>
<li><p>方便引入历史经验</p>
<ul>
<li>可以自由调整离散化结果，结合机器学习和历史经验得到最终的离散化结果</li>
</ul>
</li>
<li><p>模型更稳健</p>
<ul>
<li>模型不再拟合特征具体值，而是拟合某个概念，能够对抗数据扰动，更稳健</li>
<li>对异常数据鲁棒性更好，降低模型过拟合风险</li>
<li>某些场合需要拟合参数值更少，降低模型复杂度</li>
</ul>
</li>
<li><p>（引入）非线性提升模型表达能力</p>
<ul>
<li>利用经验、其他信息将数值特征分段，相当于<strong>引入非线性</strong>，提升线性模型表达能力</li>
<li>方便引入交叉特征，提升模型表达能力</li>
</ul>
</li>
</ul>
<h4 id="适合场景"><a href="#适合场景" class="headerlink" title="适合场景"></a>适合场景</h4><ul>
<li><p>离散化特征更适合 <em>LR</em> 等线性模型</p>
<ul>
<li>如下离散化优势：方便引入非线性等</li>
<li>模型中所有特征都会被考虑，考虑细节、个体（包括 $L_1$ 范数也是被考虑后剔除）</li>
</ul>
</li>
<li><p><em>GBDT</em> 等树、抽样模型则不适合</p>
<ul>
<li>特征离散化后，由于抽样误差的存在，可能存在某些离散特征对<strong>样本预测能力非常强</strong>，非线性模型容易给这些特征更大权重，造成过拟合<ul>
<li>如：刚好抽取的 1000 个样本中某离散特征取值为 1 者全为正样本</li>
</ul>
</li>
<li>树模型每次使用一个特征划分节点，特征数量较多不利于模型训练<ul>
<li>若单个离散化特征预测能力不强，由于树深度限制，只有少量特征被作为划分依据，模型可能不收敛、表达能力更差</li>
<li>若单个离散化特征预测能力强，连续特征也应该也有较好效果</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="无监督"><a href="#无监督" class="headerlink" title="无监督"></a>无监督</h3><ul>
<li>无监督分箱仅仅考虑特征自身数据结构，没有考虑特征与目标之间的关系</li>
</ul>
<h4 id="等频-等距-经验分箱"><a href="#等频-等距-经验分箱" class="headerlink" title="等频/等距/经验分箱"></a>等频/等距/经验分箱</h4><ul>
<li><p>分箱逻辑</p>
<ul>
<li>等频分箱：排序后按数量等分<ul>
<li>避免离散化后特征仍然为长尾分布、大量特征集中在少量组内</li>
<li>对数据区分能力弱</li>
</ul>
</li>
<li>等距分箱：取值范围等分</li>
<li>经验分箱</li>
</ul>
</li>
<li><p>分箱数量、边界超参需要人工指定</p>
<ul>
<li>根据业务领域经验指定</li>
<li>根据模型指定：根据具体任务训练分箱之后的数据集，通过超参数搜索确定最优分桶数量、边界</li>
</ul>
</li>
<li><p>分箱经验、准则</p>
<ul>
<li>若组距过大，组内属性取值差距过大<ul>
<li>逻辑上分类不能够代表组内全部样本，组内取值影响可能完全不同</li>
</ul>
</li>
<li>若组距过小，组内样本过少<ul>
<li>随机性太强，不具备统计意义上说服力</li>
<li>特征影响跳变过多</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="聚类分箱"><a href="#聚类分箱" class="headerlink" title="聚类分箱"></a>聚类分箱</h4><ul>
<li><em>K-Means</em> 聚类</li>
<li>层次聚类</li>
</ul>
<blockquote>
<ul>
<li>聚类过程中需要保证分箱有序</li>
</ul>
</blockquote>
<h3 id="有监督"><a href="#有监督" class="headerlink" title="有监督"></a>有监督</h3><h4 id="Binning：1R-分箱"><a href="#Binning：1R-分箱" class="headerlink" title="Binning：1R 分箱"></a><em>Binning：1R</em> 分箱</h4><ul>
<li>分箱逻辑、步骤<ul>
<li>将样本排序，从当前位置开始<ul>
<li>初始化：以允许的最少样本作为一箱，将箱内最多类别作为箱标签</li>
<li>扩展：若下个样本类别与箱标签相同，则划至箱内</li>
</ul>
</li>
<li>重复以上，得到多个分箱</li>
<li>将相邻具有相同标签的箱合并，得到最终分箱结果</li>
</ul>
</li>
</ul>
<h4 id="Splitting"><a href="#Splitting" class="headerlink" title="Splitting"></a><em>Splitting</em></h4><p><img src="/imgs/discretization_split.png" alt="discretization_split"></p>
<ul>
<li>基于信息熵的 <em>split</em>，具体划分依据如下<ul>
<li><em>ID3</em>：信息增益</li>
<li><em>C4.5</em>：信息增益比</li>
<li><em>D2</em>：</li>
<li><em>Minimum Description Length Principle</em>：描述长度</li>
</ul>
</li>
</ul>
<h4 id="Merge分箱"><a href="#Merge分箱" class="headerlink" title="Merge分箱"></a>Merge分箱</h4><p><img src="/imgs/discretization_merge.png" alt="discretization_merge"></p>
<ul>
<li>基于依赖相关的 <em>merge</em>，具体划分依据如下<ul>
<li><em>Chimerge</em>：使用卡方值衡量两个相邻区间是否具有类似分布，若具有类似分布则将其合并</li>
</ul>
</li>
</ul>
<h5 id="具体算法"><a href="#具体算法" class="headerlink" title="具体算法"></a>具体算法</h5><blockquote>
<ul>
<li>输入：目标分箱数量 $N$</li>
<li>初始化<ul>
<li>将变量升序排列</li>
<li>为减少计算量，若初始分箱数量大于阈值 $N_{max}$，则利用等频分箱进行粗分箱</li>
<li>缺失值单独作为一个分箱</li>
</ul>
</li>
<li>合并区间<ul>
<li>计算每对相邻区间的卡方值</li>
<li>将卡方值最小区间合并</li>
<li>重复以上直至分箱数量不大于 $N$</li>
</ul>
</li>
<li>分箱后处理<ul>
<li>合并纯度为 1（只含有某类样本）的分箱</li>
<li>删除某类样本占比超过 95% 的分箱</li>
<li>若缺失值分箱各类样本占比同非缺失值分箱，则合并</li>
</ul>
</li>
</ul>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-08-10T11:37:47.000Z" title="8/10/2020, 7:37:47 PM">2020-08-10</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T08:26:34.000Z" title="7/16/2021, 4:26:34 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/ML-Specification/">ML Specification</a><span> / </span><a class="link-muted" href="/categories/ML-Specification/FinTech/">FinTech</a><span> / </span><a class="link-muted" href="/categories/ML-Specification/FinTech/Risk-Control/">Risk Control</a></span><span class="level-item">23 minutes read (About 3463 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ML-Specification/FinTech/Risk-Control/rc_models.html">评分卡模型</a></h1><div class="content"><h2 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h2><ul>
<li><p>模型是策略的工具，策略包含模型，是模型的延伸</p>
<ul>
<li>相较于专家规则，机器学习模型<ul>
<li>允许加入更多特征维度，描述更加全面</li>
<li>上限更高、下限更低</li>
<li>涉及更多维度特征时，维护更方便</li>
</ul>
</li>
<li>机器学习模型和专家规则并非相互替代，更多的是串联</li>
</ul>
</li>
<li><p>业务问题转换为带解决数学问题</p>
<ul>
<li>尽量将业务问题转换为更容易解决分类问题而不是回归问题</li>
<li>数学问题应尽量贴近业务：评估指标好不等于业务价值高<ul>
<li>远离业务问题的训练出模型，其线下评估效果好也不意味着上线效果好，如：针对客户而不是订单评价</li>
<li>影响客户体验，如：客户等待时间预估偏低而不是偏高</li>
</ul>
</li>
</ul>
</li>
<li><p>样本构造</p>
<ul>
<li>标签定义<ul>
<li>尽量为客观事实（是否、数量），而非主观判断（等级）</li>
<li>样本粒度贴合实际、业务（订单粒度、客户粒度）</li>
</ul>
</li>
<li>样本数量<ul>
<li>二分类场景：正例样本大于 2000，占比超过 1%</li>
</ul>
</li>
<li>采样<ul>
<li>尽量不进行人工采样，保持训练数据正、负例比例和真实情况对齐</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="传统评分卡"><a href="#传统评分卡" class="headerlink" title="传统评分卡"></a>传统评分卡</h3><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>评分卡</th>
<th>复杂学习</th>
</tr>
</thead>
<tbody>
<tr>
<td>特征筛选</td>
<td>需筛选强特征，依赖业务经验</td>
<td>支持弱特征入模</td>
</tr>
<tr>
<td>特征处理</td>
<td><em>WOE</em> 分箱，稳定性好</td>
<td></td>
</tr>
<tr>
<td>非线性</td>
<td>仅 <em>WOE</em> 分箱提供非线性，解释性好</td>
<td>非线性充分挖掘数据信息，解释性差</td>
</tr>
<tr>
<td>复杂度</td>
<td>模型简单，泛化性好，样本需求小</td>
<td>模型复杂，表达能力强，样本少时容易过拟合</td>
</tr>
<tr>
<td>调参</td>
<td>超参少</td>
<td>调参难度大</td>
</tr>
<tr>
<td>模型提升方向</td>
<td>分（样本）群建模</td>
<td><em>Stacking</em> 结合评分卡</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><p>信用评分卡模型：利用模型将账户的属性特征按取值分组、并赋予一定分数，对账户进行信用评分</p>
<ul>
<li>最常见的金融风控手段之一，用于决定是否给予授信以及授信的额度和利率</li>
<li>常用逻辑回归作为模型</li>
<li>应用形式为查分组得分表、得分加和<ul>
<li>变量总是被分组，同组内得分相同</li>
<li>用户属性变化不足以跨越箱边界，则得分不改变</li>
</ul>
</li>
</ul>
</li>
<li><p>评分卡更关注得分相对值，即得分变动情况，评分绝对值含义意义不大</p>
<ul>
<li>常用 <em>LR</em> 中 <em>sigmoid</em> 函数内线性函数结果作为初始得分<ul>
<li>根据 <em>LR</em> 意义，此时得分可以映射为账户的违约概率</li>
</ul>
</li>
<li>为美观，可能会对得分做线性变换<ul>
<li>常对各特征得分做放缩、对账户得分和做平移，此时放缩比例除以 $ln2$ 即为 <em>PDO</em>
（对特征得分同时做等比例放缩、平移可行但蠢）</li>
<li>线性变换后得分绝对值无意义，特征重要性可用特征各分组得分差距衡量</li>
</ul>
</li>
</ul>
</li>
<li><p>评分卡在不同业务阶段体现的方式、功能不一样，按照借贷用户借贷时间可以分为</p>
<ul>
<li>申请评分卡 <em>Application Score Card</em>：贷前申请评分卡</li>
<li>行为评分卡 <em>Behavior Score Card</em>：贷中行为评分卡</li>
<li>催收评分卡 <em>Collection Score Card</em>：贷后催收评分卡</li>
</ul>
</li>
</ul>
<h3 id="Stacking-评分卡"><a href="#Stacking-评分卡" class="headerlink" title="Stacking 评分卡"></a><em>Stacking</em> 评分卡</h3><blockquote>
<ul>
<li>考虑将评分卡、机器学习模型结合，使用机器学习模型构建特征，在此基础之上建立评分卡模型</li>
</ul>
</blockquote>
<ul>
<li><p><em>Stacking</em> 思想下的模型架构</p>
<ul>
<li>原始数据域</li>
<li>数据挖掘、特征工程</li>
<li>数据域特征子模型</li>
<li>评分卡模型</li>
</ul>
</li>
<li><p>架构优势</p>
<ul>
<li>可解释性：保留在数据域粒度上的可解释性</li>
<li>信息提取：子模型提取弱特征信息，降低特征工程门槛</li>
<li>维度多样性：特征子模型机制，降低特征筛选必要性，保证各数据域都有特征入模</li>
<li>模块化：具有良好扩展性，支持子模型替换、删除</li>
<li>并行化：各数据域特征子模型专业、独立负责，提高效率</li>
</ul>
</li>
<li><p>架构劣势</p>
<ul>
<li>牺牲部分可解释性：若策略、模型使用相同变量，策略阈值调整对模型影响难以估计<ul>
<li>控制入模变量数目，便于快速定位</li>
<li>利用 <em>SHAP</em>、<em>LIME</em> 等工具解释模型</li>
</ul>
</li>
<li>增加上线、维护成本：需要上线多个模型，且对多个架构多个层次都进行监控</li>
<li>协同建模增加对接成本</li>
<li>分数据域特征子模型建模，容易造成数据孤岛，无法捕捉不同数据域间的数据联系<ul>
<li>跨数据域构造特征，构建跨数据域子模型</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="B-卡-Behavior-Scoring"><a href="#B-卡-Behavior-Scoring" class="headerlink" title="B 卡 - Behavior Scoring"></a><em>B</em> 卡 - <em>Behavior Scoring</em></h3><p>贷中风控：根据借款人放贷后行为表现，预测未来逾期风险</p>
<ul>
<li><p><em>B</em> 卡用于动态监控放款后风险变化</p>
<ul>
<li>贷前阶段对借款人履约行为掌握少，且为静态数据</li>
<li>一般无需实时，离线T+1计算即可</li>
</ul>
</li>
<li><p><em>B</em> 卡适合的信贷场景</p>
<ul>
<li>还款周期长<ul>
<li>长周期场景用户风险变化可能性大，与 <em>A</em> 卡形成区分</li>
<li>引入贷中客户信息、还款履约行为，更准确识别客户逾期风险</li>
</ul>
</li>
<li>循环授信<ul>
<li>贷前阶段，无法很好识别客户风险，设置初始额度</li>
<li>贷中与客户更多交互之后，可根据获取的贷中行为信息进行提额、降额操作</li>
</ul>
</li>
</ul>
</li>
<li><p><em>B</em> 卡区分度一般很高</p>
<ul>
<li>除贷前数据之外，还可以使用账户的贷中表现数据</li>
<li>特别的，不考虑排序性的情况下，使用是否逾期作为划分依据也能得到较高的 <em>TPR-FPR</em>，给出 <em>KS</em> 的下限</li>
</ul>
</li>
<li><p><em>B</em> 卡建模主要基于老客</p>
<ul>
<li>老客有足够长的申贷、还款记录</li>
<li>新、老客定义口径<ul>
<li>新客：无历史结清订单</li>
<li>老客：至少有1笔结清订单</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="C-卡-Collection-Scoring"><a href="#C-卡-Collection-Scoring" class="headerlink" title="C 卡 - Collection Scoring"></a><em>C</em> 卡 - <em>Collection Scoring</em></h3><p>贷后催收评分卡：当前状态为逾期情况下，预测未来出催可能性</p>
<ul>
<li><p>现阶段业界对 <em>C</em> 卡不够重视</p>
<ul>
<li>贷前风控最重要，优秀的贷前带来更容易的贷中、贷后</li>
<li>催收效果和人员更相关，而逾期发生之后往往会委外</li>
<li>随信贷行业的发展，贷后催收会趋向于精细化、专业化的发展，模型+策略的优化愈发重要</li>
</ul>
</li>
<li><p>模型分群</p>
<ul>
<li>新老入催用户<ul>
<li>首次入催</li>
<li>再次入催</li>
</ul>
</li>
<li><em>MOB</em> 信息（数据厚薄）<ul>
<li>还款月份数</li>
<li>催记月份数</li>
</ul>
</li>
<li>订单详情<ul>
<li>利率</li>
<li>期限</li>
<li>金额</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="样本选择"><a href="#样本选择" class="headerlink" title="样本选择"></a>样本选择</h4><ul>
<li><p>建模样本窗口选择</p>
<ul>
<li>特征覆盖度：保证数据厚薄程度相同</li>
<li>催收动作变化：出催没有大幅度变动</li>
<li>客群变化：入催没有大幅变动</li>
</ul>
</li>
<li><p>同用户订单合案</p>
<ul>
<li>不合案：同用户多笔订单视为不同样本<ul>
<li>表现期内入催当期结清视为出催</li>
</ul>
</li>
<li>合案：同用户相近观察点入催订单合并<ul>
<li>表现期内入催当期所有账单还清视为出催</li>
<li>对发生过 <em>M2+</em> 逾期者，可将只要出催一期即视为出催</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="C-卡模型"><a href="#C-卡模型" class="headerlink" title="C 卡模型"></a><em>C</em> 卡模型</h4><blockquote>
<ul>
<li>根据模型作用时间段分类</li>
</ul>
</blockquote>
<ul>
<li><p><em>M1</em> 全量模型：预测 <em>M1</em> 阶段（逾期 30 天内）还款概率</p>
<ul>
<li>样本：所有入催样本整体<ul>
<li>若缓催期内催出用户较多，则模型主要学习了缓催样本信息，约等于缓催响应模型，对非缓催样本效果较差</li>
</ul>
</li>
<li>时间窗口<ul>
<li>观察点：还款日</li>
<li>表现期：<em>M1</em> 阶段</li>
</ul>
</li>
</ul>
</li>
<li><p>缓催响应模型：预测适合缓催人群</p>
<ul>
<li>样本：需要积累足够的缓催响应样本<ul>
<li>若有足够缓催响应样本，可以和M1全量模型同时构建</li>
<li>否则，在 <em>M1</em> 全量模型得分高（出催概率高）人群上进行 <em>AB Test</em>，积累缓催响应样本</li>
</ul>
</li>
<li>时间窗口<ul>
<li>观察点：还款日</li>
<li>表现期：缓催响应日(2-3 天)</li>
</ul>
</li>
</ul>
</li>
<li><p>贷后 <em>N</em> 天流转模型：预测贷后N天后的还款概率</p>
<ul>
<li>样本：缓催内未出催样本<ul>
<li>去除缓催样本影响，更多学习缓催期外出催样本信息</li>
<li>优先对催出概率高的人群进行催收，提高出催概率</li>
</ul>
</li>
<li>时间窗口<ul>
<li>观察点：还款日（逾期）后 <em>N</em> 天</li>
<li>表现期：至下个流转模型观察点、逾期阶段结束时间点</li>
</ul>
</li>
</ul>
</li>
<li><p><em>M2+</em> 模型：预测 <em>M2+</em> 阶段的还款概率（类似贷后流转模型）</p>
<ul>
<li>样本：<em>M1</em> 阶段未出催样本</li>
<li>时间窗口<ul>
<li>观察点：<em>M2</em> 阶段起始</li>
<li>表现期：至下个流转模型观察点、逾期阶段结束时间点</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="模型应用方法"><a href="#模型应用方法" class="headerlink" title="模型应用方法"></a>模型应用方法</h4><ul>
<li><p>缓催响应人群确定</p>
<ul>
<li>交叉 <em>M1</em> 模型、缓催响应模型，根据模型交叉结果设置阈值</li>
<li>根据阈值筛选缓催响应人群</li>
<li>限定缓催期（2-3 天），将缓催响应样本分为人工催收、缓催两组，观察两组在缓催期限内出催率变化<ul>
<li>若出催率相同，则认为缓催响应人群分析方法可行，对缓催响应人群可采取缓催策略</li>
<li>若出催率相差较大，则调整缓催响应人群分析方法</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>缓催模型响应时间（缓催期）可根据响应时间段内的出催率变化设置</li>
</ul>
</blockquote>
</li>
<li><p>模型搭建策略</p>
<ul>
<li><em>M1</em> 阶段出催概率较大，在M1阶段会设计多个细分模型<ul>
<li>至少：<em>M1</em> 阶段全量模型</li>
<li>缓催样本足够<ul>
<li>缓催响应模型</li>
<li>贷后 <em>N</em> 天流转模型</li>
</ul>
</li>
<li>精细化管理：多个不同时间窗口的贷后流转模型</li>
</ul>
</li>
<li><em>M2+</em> 阶段根据样本量、精细化程度设置适量模型</li>
</ul>
</li>
</ul>
<h2 id="开发流程标准化"><a href="#开发流程标准化" class="headerlink" title="开发流程标准化"></a>开发流程标准化</h2><ul>
<li>风控模型开发流程标准化意义<ul>
<li>提高建模效率：可批量快速生产模型，提高效率</li>
<li>帮助理解指标逻辑、业务含义，利于调试优化</li>
<li>流程规范约束<ul>
<li>统一建模流程，减少出错概率、便于问题回溯</li>
<li>统一命名方式，便于汇总文档</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h3><h4 id="特征编码"><a href="#特征编码" class="headerlink" title="特征编码"></a>特征编码</h4><ul>
<li><p>特征离散化</p>
</li>
<li><p><em>WOE</em> 编码特征</p>
<ul>
<li><em>WOE</em> 曲线应符合业务逻辑（一般单调），并且经过跨时间
窗口验证，否则应该调整</li>
<li><em>LR</em> 模型中特征权重应该全为正值，否则<ul>
<li>同数据 <em>WOE</em> 值体现的逻辑相违背</li>
<li>负值权重特征存在较严重共线性</li>
</ul>
</li>
</ul>
</li>
<li><p><em>one-hot</em> 编码特征</p>
<ul>
<li>同特征下个分箱单独作为独立变量取值<ul>
<li>权重灵活性更大，模型效果可能较好</li>
<li>变量数量多，需要样本数量大，模型效果可能较差（随机解法）</li>
</ul>
</li>
<li>各特征分箱之间无联系，难以通过模型剔除某个变量</li>
</ul>
</li>
</ul>
<h4 id="样本赋权"><a href="#样本赋权" class="headerlink" title="样本赋权"></a>样本赋权</h4><ul>
<li>样本赋权：充分利用所有样本的信息，避免样本有偏<ul>
<li>按样本距今时间赋权，近期样本高权重</li>
<li>按业务特性赋权，不同额度、利率、期限不同权重</li>
<li>按账户类型赋权</li>
</ul>
</li>
</ul>
<h4 id="拒绝推断"><a href="#拒绝推断" class="headerlink" title="拒绝推断"></a>拒绝推断</h4><ul>
<li><em>Reject Inference</em> 拒绝推断：避免样本偏差导致模型估计过于乐观</li>
</ul>
<h3 id="Exploratory-Data-Analysis"><a href="#Exploratory-Data-Analysis" class="headerlink" title="Exploratory Data Analysis"></a><em>Exploratory Data Analysis</em></h3><ul>
<li><p>风控领域样本较少，一般按月粒度观察，即将样本按月分组为 <em>vintage</em> 进行分析，探索、评估数据</p>
<ul>
<li>稳定性</li>
<li>信息量</li>
<li>信息重复/相关性</li>
</ul>
</li>
<li><p>实操中可逐阶段设置多组阈值，分布进行变量探索、筛选</p>
<ul>
<li>多组阈值逐步剔除能尽可能保留高信息量特征</li>
<li>避免相关性、<em>RF</em> 特征重要度等 <strong>非单变量指标</strong> 剔除过多特征</li>
</ul>
</li>
</ul>
<h3 id="模型评估"><a href="#模型评估" class="headerlink" title="模型评估"></a>模型评估</h3><ul>
<li><p>有效性/区分度</p>
<ul>
<li><em>GINI</em> 指数</li>
<li><em>KS</em> 值</li>
<li>坏样本率：组内、累计</li>
<li>提升度 = 召回样本坏样本率 / 全部样本坏样本率</li>
<li><em>odds</em> = 坏样本率 / 好样本率</li>
</ul>
</li>
<li><p>排序性</p>
<ul>
<li><em>AUC</em> 值/<em>ROC</em> 曲线</li>
</ul>
</li>
<li><p>稳定性</p>
<ul>
<li><em>PSI</em></li>
<li>各 <em>Vintage</em> 内坏占比、<em>Lift</em> 值、<em>odds</em> 等指标稳定性</li>
</ul>
</li>
<li><p>模型得分展示表</p>
<ul>
<li>箱内样本数</li>
<li>好、坏样本数</li>
<li>箱内坏样本、比例</li>
<li>累计好、坏样本</li>
<li>累计好、坏样本比例：<em>TPR</em>、<em>FPR</em>、<em>TPR-FPR</em></li>
<li>累计通过率、坏样本比例</li>
</ul>
</li>
</ul>
<h3 id="模型应用"><a href="#模型应用" class="headerlink" title="模型应用"></a>模型应用</h3><h4 id="Calibration-模型校准"><a href="#Calibration-模型校准" class="headerlink" title="Calibration 模型校准"></a><em>Calibration</em> 模型校准</h4><ul>
<li>一致性校准：将模型预测概率校准到真实概率</li>
<li>尺度变换：将风险概率转换为整数分数</li>
</ul>
<h4 id="导出得分"><a href="#导出得分" class="headerlink" title="导出得分"></a>导出得分</h4><ul>
<li><p>原始得分</p>
<ul>
<li><em>one-hot</em> 编码：<em>LR</em> 模型系数</li>
<li><em>WOE</em> 编码：<em>LR</em> 模型系数（权重）、<em>WOE</em> 值之积</li>
</ul>
</li>
<li><p>常对各特征得分做放缩、对账户得分和做平移</p>
<ul>
<li><em>PDO</em>：违约翻倍得分<ul>
<li>用于缩放原始得分</li>
<li>得分按 $\frac {PDO} {ln2}$ 缩放后，得分减少 $PDO$ 分，用户违约 <em>odds</em> 翻倍，缺省即 $ln2$</li>
</ul>
</li>
<li>账户得分总和平移则仅仅是为了美观</li>
</ul>
<blockquote>
<ul>
<li>对特征得分同时做等比例放缩、平移可行但蠢</li>
</ul>
</blockquote>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-08-04T14:47:06.000Z" title="8/4/2020, 10:47:06 PM">2020-08-04</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-08-04T14:47:06.000Z" title="8/4/2021, 10:47:06 PM">2021-08-04</time></span><span class="level-item"><a class="link-muted" href="/categories/ML-Specification/">ML Specification</a><span> / </span><a class="link-muted" href="/categories/ML-Specification/NLP/">NLP</a></span><span class="level-item">10 minutes read (About 1457 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ML-Specification/NLP/word2vec.html">Word2Vec</a></h1><div class="content"><h2 id="Word2Vec"><a href="#Word2Vec" class="headerlink" title="Word2Vec"></a>Word2Vec</h2><p>Word2Vec：word embeding的一种，使用层次化softmax、负采样
训练词向量</p>
<h2 id="Hierarchical-Softmax"><a href="#Hierarchical-Softmax" class="headerlink" title="Hierarchical Softmax"></a>Hierarchical Softmax</h2><p>层次Softmax</p>
<p><img src="/imgs/word2vec_hierarchical_softmax.png" alt="word2vec_hierarchical_softmax"></p>
<ul>
<li><p>对所有词向量求和取平均作为输入层到隐层的映射
（特指CBOW模型）</p>
</li>
<li><p>使用霍夫曼树代替从隐藏层到输出softmax层的映射</p>
</li>
</ul>
<h3 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h3><ul>
<li><p>softmax需要对$m$个类别求出softmax概率，参数多、计算复杂</p>
</li>
<li><p>考虑将$m$个类别划分为多个二分类sigmoid，即</p>
<ul>
<li>将总类别划分为两组</li>
<li>依次判断数据点属于哪组</li>
<li>直至数据点所属组仅包含一个类别</li>
</ul>
</li>
<li><p>则多个sigmoid划分构成一棵二叉树，树叶子节点即为$m$
类别</p>
<ul>
<li>二叉树结构可以由多种，最优二叉树应该使得对整个
数据集而言，sigmoid判断次数最少</li>
<li>即应该使用按照数据点频数构建的霍夫曼树</li>
<li>霍夫曼树</li>
</ul>
</li>
</ul>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><ul>
<li><p>输入$x^T$所属类别霍夫曼编码为$d={d_1,\cdots,d_M}$，
则应最大化如下似然函数</p>
<script type="math/tex; mode=display">\begin{align*}
\prod_{i=1}^M P(d_i|x, w_{j_i}) & = \prod_{i=1}^M
   [\sigma(x^T w_{j_i} + b_{j_i})]^{d_i}
   [1 - \sigma(x^T w_{j_i} + b_{j_i})]^{1-d_i} \\
P(d_i|x, w_{j_i}) & = \left \{ \begin{array}{l}
   1 - \sigma(x^T w_{j_i} + b_{j_i}), & d_i = 0 \\
   \sigma(x^T w_{j_i} + b_{j_i}), & d_i = 1
   \end{array} \right. \\
\sigma(z) & = \frac 1 {1 + e^z}
\end{align*}</script><blockquote>
<ul>
<li>$w_j, b_j$：节点$j$对应sigmoid参数</li>
<li>$P(d_i)$：以sigmoid激活值作为正例概率
 （也可以其作为负例概率，但似然函数需更改）</li>
</ul>
</blockquote>
</li>
<li><p>则对数似然函数为</p>
<script type="math/tex; mode=display">
L = log \prod_{i=1}^M P(d_i|x, w_{j_i}) = \sum_{i=1}^M
   d_i log [\sigma(x^T w_{j_i} + b_{j_i})]
   {1-d_i} log [1 - \sigma(x^T w_{j_i} + b_{j_i})]</script></li>
</ul>
<h3 id="梯度计算"><a href="#梯度计算" class="headerlink" title="梯度计算"></a>梯度计算</h3><ul>
<li><p>则参数$w_{j_M}$梯度如下</p>
<script type="math/tex; mode=display">\begin{align*}
\frac {\partial L} {\partial w_{j_M}} & =
   d_M [1-\sigma(x^T w_{j_M} + b_{j_M})] x -
   (1 - d_M) \sigma(x^T w_{j_M} + b_{j_M}) x \\
& = (d_M - \sigma(x^T w_{j_M} + b_{j_M})) x
\end{align*}</script></li>
<li><p>词向量$x$梯度如下</p>
<script type="math/tex; mode=display">
\frac {\partial L} {\partial x} = \sum_{i=1}^M
   (d_i - \sigma(x^T w_{j_i} + b_{j_i})) w_{j_i}</script></li>
</ul>
<h3 id="CBOW流程"><a href="#CBOW流程" class="headerlink" title="CBOW流程"></a>CBOW流程</h3><blockquote>
<ul>
<li>特征词周围上下文词均使用梯度更新，<strong>更新输入</strong></li>
</ul>
</blockquote>
<ul>
<li>基于预料训练样本建立霍夫曼树</li>
<li>随机初始化模型参数$w$、词向量$w$</li>
<li><p>对训练集中每个样本 $(context(x), x)$（$2C$个上下文）如下
计算，直至收敛</p>
<ul>
<li><p>置：$e=0, x<em>w=\frac 1 {2C} \sum</em>{c=1}^{2C} x_c$</p>
</li>
<li><p>对$x$的霍夫曼编码 $d={d_1, \cdots, d_M}$ 中 $d_i$ 计算</p>
<script type="math/tex; mode=display">\begin{align*}
\sigma_i & = \sigma(x_w^T w_{j_i} + b_{j_i}) \\
g & = (d_i - \sigma_i) \eta \\
e & = e + g w_{j_i} \\
w_{j_i} & = w_{j_i} + g x_w
\end{align*}</script></li>
<li><p>更新 $2C$ 上下文词对应词向量</p>
<script type="math/tex; mode=display">
x_i = x_i + e</script></li>
</ul>
</li>
</ul>
<h3 id="Skip-Gram流程"><a href="#Skip-Gram流程" class="headerlink" title="Skip-Gram流程"></a>Skip-Gram流程</h3><blockquote>
<ul>
<li>考虑上下文是相互的，则 $P(x<em>{context}|x)$ 最大化时，$P(x|x</em>{context})$ 也最大</li>
<li>为在迭代窗口（样本）内更新仅可能多词向量，应该最大化 $P(x|x_{context})$，使用梯度更新上下文 $2C$ 个词向量，<strong>更新输出</strong>（条件概率中更新条件）</li>
</ul>
</blockquote>
<ul>
<li>基于预料训练样本建立霍夫曼树</li>
<li>随机初始化模型参数 $w$、词向量 $w$</li>
<li><p>对训练集中每个样本 $(x, context(x))$、每个样本中上下文词向量 $x_c$（$2C$ 个上下文），训练直至收敛</p>
<ul>
<li><p>置：$e=0$</p>
</li>
<li><p>对 $x$ 的霍夫曼编码 $d={d_1, \cdots, d_M}$ 中 $d_i$ 计算</p>
<script type="math/tex; mode=display">\begin{align*}
\sigma_i & = \sigma(x_c^T w_{j_i} + b_{j_i}) \\
g & = (d_i - \sigma_i) \eta \\
e & = e + g w_{j_i} \\
w_{j_i} & = w_{j_i} + g x_c
\end{align*}</script></li>
<li><p>更新 $2C$ 上下文词对应词向量</p>
<script type="math/tex; mode=display">
x_c = x_c + e</script></li>
</ul>
</li>
</ul>
<h2 id="Negtive-Sampling"><a href="#Negtive-Sampling" class="headerlink" title="Negtive Sampling"></a>Negtive Sampling</h2><p>负采样</p>
<h3 id="思想-1"><a href="#思想-1" class="headerlink" title="思想"></a>思想</h3><ul>
<li>通过负采样得到$neg$个负例</li>
<li>对正例、负采样负例建立二元逻辑回归</li>
</ul>
<h3 id="模型、梯度"><a href="#模型、梯度" class="headerlink" title="模型、梯度"></a>模型、梯度</h3><ul>
<li><p>对类别为$j$正例、负采样负例应有如下似然函数、对数似然
函数</p>
<script type="math/tex; mode=display">\begin{align*}
P(context(x), x) & = \sigma(x^T w_j)
   \prod_{i=1}^{neg} (1 - \sigma(x^T w_j)) \\
L & = log P(context(x), x) \\
& = \sum_{i=0}^{neg} [y_i log(\sigma(x^T w_j)) + 
   (1 - y_i) log(\sigma (x^T w_j))]
\end{align*}</script><blockquote>
<ul>
<li>$y_i$：样本点标签，$y_0$为正例、其余负例</li>
</ul>
</blockquote>
</li>
<li><p>同普通LR二分类，得到参数、词向量梯度</p>
<script type="math/tex; mode=display">\begin{align*}
\frac {\partial L} {\partial w_j} & =
   (y_i - \sigma(x^T w_j)) x \\
\frac {\partial L} {\partial x} & = \sum_{i=1}^{neg}
   (y_i - \sigma(x^T w_j)) w_j
\end{align*}</script></li>
</ul>
<h3 id="负采样方法"><a href="#负采样方法" class="headerlink" title="负采样方法"></a>负采样方法</h3><ul>
<li><p>每个词对应采样概率为词频取$3/4$次幂后加权</p>
<script type="math/tex; mode=display">
p(x_0) = \frac {count(x_0)^{3/4}}
   {\sum_{x \in vocab} count(x)^{3/4}}</script></li>
</ul>
<h3 id="CBOW流程-1"><a href="#CBOW流程-1" class="headerlink" title="CBOW流程"></a>CBOW流程</h3><ul>
<li>随机初始化所有模型参数、词向量</li>
<li>对每个训练样本$(context(x_0), x_0)$负采样$neg$个中心词
$x_i$，考虑$x_0$为类别$j$</li>
<li><p>在以上训练集$context(x<em>0), x_0, x_1, \cdots, x</em>{neg}$中
训练直至收敛</p>
<ul>
<li><p>置：$e=0, x<em>w=\frac 1 {2C} \sum</em>{c=1}^{2C} x_c$</p>
</li>
<li><p>对样本$x<em>0, x_1, \cdots, x</em>{neg}$，计算</p>
<script type="math/tex; mode=display">\begin{align*}
\sigma_i & = \sigma(x_w^T w_j + b_j) \\
g & = (y_i - \sigma_i) \eta \\
e & = e + g w_j \\
w_j & = w_j + g x_w
\end{align*}</script></li>
<li><p>更新$2C$上下文词对应词向量</p>
<script type="math/tex; mode=display">
x_i = x_i + e</script></li>
</ul>
</li>
</ul>
<h3 id="Skip-gram中心词"><a href="#Skip-gram中心词" class="headerlink" title="Skip-gram中心词"></a>Skip-gram中心词</h3><blockquote>
<ul>
<li>类似Hierarchical Softmax思想，更新输出$2C$个词向量</li>
</ul>
</blockquote>
<ul>
<li>随机初始化所有模型参数、词向量</li>
<li>对每个训练样本$(context(x_0), x_0)$负采样$neg$个中心词
$x_i$，考虑$x_0$为类别$j$</li>
<li><p>以上训练集$context(x<em>0), x_0, x_1, \cdots, x</em>{neg}$中，
对每个上下文词向量$x_c$如下训练直至收敛</p>
<ul>
<li><p>置：$e=0$</p>
<script type="math/tex; mode=display">\begin{align*}
\sigma_i & = \sigma(x_c^T w_j + b_j) \\
g & = (y_i - \sigma_i) \eta \\
e & = e + g w_j \\
w_j & = w_j + g x_c
\end{align*}</script></li>
<li><p>更新$2C$上下文词对应词向量</p>
<script type="math/tex; mode=display">
x_c = x_c + e</script></li>
</ul>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-07-12T10:09:40.000Z" title="7/12/2020, 6:09:40 PM">2020-07-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T09:39:34.000Z" title="7/16/2021, 5:39:34 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a><span> / </span><a class="link-muted" href="/categories/Linux/Tool/">Tool</a></span><span class="level-item">6 minutes read (About 931 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/Tool/pandoc.html">Pandoc介绍</a></h1><div class="content"><h2 id="Pandoc"><a href="#Pandoc" class="headerlink" title="Pandoc"></a>Pandoc</h2><p>Pandoc：将文本在不同标记语言之间相互转换的工具</p>
<ul>
<li><p>Pandoc使用Haskell开发，最新版本Pandoc可以使用Haskell平台
包管理器cabal安装</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install haskell-platform</span><br><span class="line">$ cabal update</span><br><span class="line">$ cabal install pandoc</span><br></pre></td></tr></table></figure>
</li>
<li><p>Pandoc支持的标记语言格式包括
（具体可通过<code>--list-input-formats</code>查看）</p>
<ul>
<li>Markdown</li>
<li>ReStructuredText</li>
<li>HTML</li>
<li>LaTeX</li>
<li>ePub</li>
<li>MS Word Docx</li>
<li>PDF</li>
</ul>
</li>
<li><p>Pandoc输入、输出文本</p>
<ul>
<li>可从输入、输出的文件扩展名推测输入、输出格式</li>
<li>缺省输入格式为Markdown、缺省输出格式为html</li>
<li>若未指明输入、输出文件，则读取、写入标准输入、输出</li>
<li>文本默认为<code>utf-8</code>编码，否则可以用<code>iconv</code>转换文本
编码进行输入、输出</li>
</ul>
</li>
</ul>
<h2 id="Pandoc相关选项"><a href="#Pandoc相关选项" class="headerlink" title="Pandoc相关选项"></a>Pandoc相关选项</h2><h3 id="基础选项"><a href="#基础选项" class="headerlink" title="基础选项"></a>基础选项</h3><ul>
<li><code>-f</code>/<code>-t</code>：输入、输出格式</li>
<li><code>-o</code>：输出文件</li>
<li><code>--number-sections</code>/<code>-N</code>：为标题添加编号</li>
<li><code>--verbose</code>：详细调试信息<ul>
<li>其中会给出资源文件目录<code>~/.pandoc</code>，存放模板等</li>
</ul>
</li>
<li><code>--log</code>：日志信息</li>
<li><code>--file-scope</code>：分别转换每个文件<ul>
<li>指定多个输入文件时默认将多个文件拼接，空行分隔</li>
</ul>
</li>
</ul>
<h3 id="信息选项"><a href="#信息选项" class="headerlink" title="信息选项"></a>信息选项</h3><ul>
<li><code>--list-input-formats</code>/<code>--list-output-formats</code>：输入、
输出格式</li>
<li><code>--list-extensions[=FORMAT]</code>：列出Markdown扩展支持情况<ul>
<li><code>&lt;FORMAT&gt;-&lt;EXT&gt;</code>可以增减格式中一个、多个扩展选项</li>
</ul>
</li>
<li><code>--list-highlight-languages</code>：语法高亮支持语言</li>
<li><code>--list-highlight-styles</code>：语法高亮支持样式</li>
</ul>
<h3 id="模板选项"><a href="#模板选项" class="headerlink" title="模板选项"></a>模板选项</h3><ul>
<li><code>-standalone</code>/<code>-s</code>：生成完整文件
（仅对可生成片段的某些格式：html、LaTeX）<ul>
<li>默认生成文档片段</li>
<li>采用相应内值模板生成完整文件</li>
</ul>
</li>
<li><code>--print-default-template=&lt;FORMAT&gt;</code>/<code>-D &lt;FORMAT&gt;</code>：输出
对应格式的默认模板</li>
<li><code>--template=&lt;TPL&gt;</code>：指定创建文档所需模板</li>
<li><code>--css=&lt;URL&gt;</code>/<code>-c &lt;URL&gt;</code>：指定CSS样式表</li>
</ul>
<h3 id="自定义值传递"><a href="#自定义值传递" class="headerlink" title="自定义值传递"></a>自定义值传递</h3><ul>
<li><code>--variable=&lt;KEY[:&lt;VAL&gt;]&gt;</code>/<code>-V &lt;KEY[:&lt;VAL&gt;]&gt;</code>：指定模板
变量取值</li>
<li><code>--metadata=&lt;KEY[:&lt;VAL&gt;]&gt;</code>/<code>-M &lt;KEY[:&lt;VAL&gt;]&gt;</code>：指定
元数据字段取值<ul>
<li>元数据字段影响模板变量取值，同时影响底层文档元数据</li>
</ul>
</li>
<li><code>--metadata-file=&lt;FILE&gt;</code>：从YAML格式文件中设置元数据字段
取值</li>
</ul>
<h3 id="PDF生成相关"><a href="#PDF生成相关" class="headerlink" title="PDF生成相关"></a>PDF生成相关</h3><ul>
<li><code>--toc</code>：生成目录</li>
<li><code>--template=&lt;TPL&gt;</code>：编译使用的LaTeX模板，缺省为自带</li>
<li><code>--latex-engine=&lt;ENG&gt;</code>：指定LaTeX引擎，需安装<ul>
<li>默认<code>pdflatex</code>对中文支持缺失，建议使用<code>xelatex</code></li>
</ul>
</li>
<li><code>--highlight-style=&lt;STY&gt;</code>：代码块语法高亮<ul>
<li>自带高亮样式可通过<code>--list-highlight-styles</code>查看</li>
<li>也可指定高亮样式文件</li>
</ul>
</li>
<li><code>--listings</code>：LeTeX文档中使用Listings包格式化代码块</li>
<li><code>--biblatex</code>/<code>--natbib</code>：指定处理参考文献程序</li>
<li><code>--bibliography=&lt;FILE&gt;</code>：设置文档元数据中参考文献信息</li>
</ul>
<blockquote>
<ul>
<li><code>-f markdown-implicit_figures</code>设置Markdown格式，指定
  图像保持原始位置，避免pdf中错位</li>
</ul>
</blockquote>
<h3 id="HTML生成相关"><a href="#HTML生成相关" class="headerlink" title="HTML生成相关"></a>HTML生成相关</h3><ul>
<li><code>--self-contained</code>：将css、图片等所有外部文件压缩进html
文件中</li>
</ul>
<blockquote>
<ul>
<li>Markdown中使用html标记可以在转换为html后保留，可以据此
  设置转换后的样式</li>
</ul>
</blockquote>
<h3 id="DOCX生成相关"><a href="#DOCX生成相关" class="headerlink" title="DOCX生成相关"></a>DOCX生成相关</h3><ul>
<li><code>--reference-doc=&lt;FILE&gt;</code>：指定格式参考文件<ul>
<li>参考文件内容被忽略，就样式、文档属性被使用</li>
</ul>
</li>
<li><code>--print-default-data-file=reference.docx</code>：输出系统默认
模板</li>
<li><code>--extract-media=&lt;DIR&gt;</code>：提取文档中多媒体文件至文件夹，
并在目标文件中设置对其引用</li>
</ul>
<h3 id="EPUB生成相关"><a href="#EPUB生成相关" class="headerlink" title="EPUB生成相关"></a>EPUB生成相关</h3><ul>
<li><code>--epub-cover-image=&lt;FILE&gt;</code></li>
<li><code>--epub-metadata=&lt;FILE&gt;</code></li>
<li><code>--epub-embed-font=&lt;FILE&gt;</code></li>
</ul>
<h3 id="数学公式渲染"><a href="#数学公式渲染" class="headerlink" title="数学公式渲染"></a>数学公式渲染</h3><ul>
<li><code>--mathjax[=&lt;URL&gt;]</code></li>
<li><code>--mathml</code></li>
<li><code>--katex[=&lt;URL&gt;]</code></li>
</ul>
<h2 id="Pandoc模板"><a href="#Pandoc模板" class="headerlink" title="Pandoc模板"></a>Pandoc模板</h2><h3 id="模板变量"><a href="#模板变量" class="headerlink" title="模板变量"></a>模板变量</h3><p>模板变量：Pandoc模板中可以包含变量用于自定义模板</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$title$						# 变量表示方法</span><br><span class="line"></span><br><span class="line">$if(var)$					# 变量条件语句</span><br><span class="line">X</span><br><span class="line">$else$</span><br><span class="line">Y</span><br><span class="line">$endif$</span><br><span class="line"></span><br><span class="line">$for(var)$					# 变量循环语句</span><br><span class="line">X</span><br><span class="line">$endfor$</span><br></pre></td></tr></table></figure>
<ul>
<li>变量赋值方式<ul>
<li>命令行参数提供</li>
<li>文档元数据中查找</li>
</ul>
</li>
</ul>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/5/">Previous</a></div><div class="pagination-next"><a href="/page/7/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><a class="pagination-link is-current" href="/page/6/">6</a></li><li><a class="pagination-link" href="/page/7/">7</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/40/">40</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">36</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Heuristic/"><span class="level-start"><span class="level-item">Heuristic</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Issue/"><span class="level-start"><span class="level-item">Issue</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Problem/"><span class="level-start"><span class="level-item">Problem</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Specification/"><span class="level-start"><span class="level-item">Specification</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">34</span></span></a><ul><li><a class="level is-mobile" href="/categories/C-C/Cppref/"><span class="level-start"><span class="level-item">Cppref</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/Cstd/"><span class="level-start"><span class="level-item">Cstd</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/MPI/"><span class="level-start"><span class="level-item">MPI</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/STL/"><span class="level-start"><span class="level-item">STL</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/CS/"><span class="level-start"><span class="level-item">CS</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/CS/Character/"><span class="level-start"><span class="level-item">Character</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Parallel/"><span class="level-start"><span class="level-item">Parallel</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Program-Design/"><span class="level-start"><span class="level-item">Program Design</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Storage/"><span class="level-start"><span class="level-item">Storage</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Daily-Life/"><span class="level-start"><span class="level-item">Daily Life</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Daily-Life/Maxism/"><span class="level-start"><span class="level-item">Maxism</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">27</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/Hadoop/"><span class="level-start"><span class="level-item">Hadoop</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/SQL-DB/"><span class="level-start"><span class="level-item">SQL DB</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/Spark/"><span class="level-start"><span class="level-item">Spark</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Scala/"><span class="level-start"><span class="level-item">Scala</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">42</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Bash-Programming/"><span class="level-start"><span class="level-item">Bash Programming</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Configuration/"><span class="level-start"><span class="level-item">Configuration</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/File-System/"><span class="level-start"><span class="level-item">File System</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/IPC/"><span class="level-start"><span class="level-item">IPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Process-Schedual/"><span class="level-start"><span class="level-item">Process Schedual</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Shell/"><span class="level-start"><span class="level-item">Shell</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Tool/Vi/"><span class="level-start"><span class="level-item">Vi</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Model/"><span class="level-start"><span class="level-item">ML Model</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Model/Linear-Model/"><span class="level-start"><span class="level-item">Linear Model</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Model-Component/"><span class="level-start"><span class="level-item">Model Component</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Nolinear-Model/"><span class="level-start"><span class="level-item">Nolinear Model</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Unsupervised-Model/"><span class="level-start"><span class="level-item">Unsupervised Model</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/"><span class="level-start"><span class="level-item">ML Specification</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/"><span class="level-start"><span class="level-item">Click Through Rate</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/Recommandation-System/"><span class="level-start"><span class="level-item">Recommandation System</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Computer-Vision/"><span class="level-start"><span class="level-item">Computer Vision</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/"><span class="level-start"><span class="level-item">FinTech</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/Risk-Control/"><span class="level-start"><span class="level-item">Risk Control</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Graph-Analysis/"><span class="level-start"><span class="level-item">Graph Analysis</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Technique/"><span class="level-start"><span class="level-item">ML Technique</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Technique/Feature-Engineering/"><span class="level-start"><span class="level-item">Feature Engineering</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Technique/Neural-Network/"><span class="level-start"><span class="level-item">Neural Network</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Theory/"><span class="level-start"><span class="level-item">ML Theory</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Theory/Loss/"><span class="level-start"><span class="level-item">Loss</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Model-Enhencement/"><span class="level-start"><span class="level-item">Model Enhencement</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Algebra/"><span class="level-start"><span class="level-item">Math Algebra</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Algebra/Linear-Algebra/"><span class="level-start"><span class="level-item">Linear Algebra</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Algebra/Universal-Algebra/"><span class="level-start"><span class="level-item">Universal Algebra</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Analysis/"><span class="level-start"><span class="level-item">Math Analysis</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Analysis/Fourier-Analysis/"><span class="level-start"><span class="level-item">Fourier Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Functional-Analysis/"><span class="level-start"><span class="level-item">Functional Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Real-Analysis/"><span class="level-start"><span class="level-item">Real Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Mixin/"><span class="level-start"><span class="level-item">Math Mixin</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Mixin/Statistics/"><span class="level-start"><span class="level-item">Statistics</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Mixin/Time-Series/"><span class="level-start"><span class="level-item">Time Series</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Probability/"><span class="level-start"><span class="level-item">Probability</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">89</span></span></a><ul><li><a class="level is-mobile" href="/categories/Python/Cookbook/"><span class="level-start"><span class="level-item">Cookbook</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Jupyter/"><span class="level-start"><span class="level-item">Jupyter</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Keras/"><span class="level-start"><span class="level-item">Keras</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Matplotlib/"><span class="level-start"><span class="level-item">Matplotlib</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Numpy/"><span class="level-start"><span class="level-item">Numpy</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pandas/"><span class="level-start"><span class="level-item">Pandas</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3Ref/"><span class="level-start"><span class="level-item">Py3Ref</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3std/"><span class="level-start"><span class="level-item">Py3std</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pywin32/"><span class="level-start"><span class="level-item">Pywin32</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Readme/"><span class="level-start"><span class="level-item">Readme</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/TensorFlow/"><span class="level-start"><span class="level-item">TensorFlow</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Twists/"><span class="level-start"><span class="level-item">Twists</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/RLang/"><span class="level-start"><span class="level-item">RLang</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Rust/"><span class="level-start"><span class="level-item">Rust</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Set/"><span class="level-start"><span class="level-item">Set</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tool/Editor/"><span class="level-start"><span class="level-item">Editor</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Markup-Language/"><span class="level-start"><span class="level-item">Markup Language</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Web-Browser/"><span class="level-start"><span class="level-item">Web Browser</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/Web/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/NPM/"><span class="level-start"><span class="level-item">NPM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Proxy/"><span class="level-start"><span class="level-item">Proxy</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Thrift/"><span class="level-start"><span class="level-item">Thrift</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="UBeaRLy"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">UBeaRLy</p><p class="is-size-6 is-block">Protector of Proxy</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">392</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">93</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">522</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xyy15926" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/xyy15926"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-04T15:07:54.896Z">2021-08-04</time></p><p class="title"><a href="/uncategorized/README.html"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T07:46:51.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/hexo_config.html">Hexo 建站</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T02:32:45.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/config.html">NPM 总述</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-02T08:11:11.000Z">2021-08-02</time></p><p class="title"><a href="/Python/Py3std/internet_data.html">互联网数据</a></p><p class="categories"><a href="/categories/Python/">Python</a> / <a href="/categories/Python/Py3std/">Py3std</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-29T13:55:00.000Z">2021-07-29</time></p><p class="title"><a href="/Linux/Shell/sh_apps.html">Shell 应用程序</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Shell/">Shell</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5385776267343559" data-ad-slot="6995841235" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="https://api.follow.it/subscription-form/WWxwMVBsOUtoNTdMSlJ4Z1lWVnRISERsd2t6ek9MeVpEUWs0YldlZGxUdXlKdDNmMEZVV1hWaFZFYWFSNmFKL25penZodWx3UzRiaVkxcnREWCtOYUJhZWhNbWpzaUdyc1hPangycUh5RTVjRXFnZnFGdVdSTzZvVzJBcTJHKzl8aXpDK1ROWWl4N080YkFEK3QvbEVWNEJuQjFqdWdxODZQcGNoM1NqbERXST0=/8" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="UBeaRLy" height="28"></a><p class="is-size-7"><span>&copy; 2021 UBeaRLy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>