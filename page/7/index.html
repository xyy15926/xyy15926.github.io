<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UBeaRLy&#039;s Proxy"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UBeaRLy&#039;s Proxy"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Hexo"><meta property="og:url" content="https://xyy15926.github.io/"><meta property="og:site_name" content="Hexo"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://xyy15926.github.io/img/og_image.png"><meta property="article:author" content="UBeaRLy"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xyy15926.github.io"},"headline":"Hexo","image":["https://xyy15926.github.io/img/og_image.png"],"author":{"@type":"Person","name":"UBeaRLy"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"https://xyy15926.github.io/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/darcula.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-5385776267343559" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Visit on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-07-12T02:53:21.000Z" title="7/12/2020, 10:53:21 AM">2020-07-12</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T09:43:48.000Z" title="7/16/2021, 5:43:48 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Tool/">Tool</a><span> / </span><a class="link-muted" href="/categories/Tool/Markup-Language/">Markup Language</a></span><span class="level-item">6 minutes read (About 848 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Tool/Markup-Language/tex.html">TeX、LaTeX、XeLaTeX</a></h1><div class="content"><h2 id="TeX"><a href="#TeX" class="headerlink" title="TeX"></a>TeX</h2><p>TeX：由Donald Knuth开发的高质量排版系统</p>
<ul>
<li><p>TeX的范畴包括标记语法（命令）、具体实现（引擎），在不同
场合含义不同，类似语言、编译器</p>
</li>
<li><p>初版TeX包含300左右命令，随后Donald添加Plain TeX扩展包
定义了600左右常用宏命令</p>
</li>
</ul>
<blockquote>
<ul>
<li>TeX中将标记关键字称为命令，其实关键字确实类似命令，可能
  系统对应命令、语言对应关键字</li>
</ul>
</blockquote>
<h2 id="TeX宏包"><a href="#TeX宏包" class="headerlink" title="TeX宏包"></a>TeX宏包</h2><ul>
<li><code>*.cls</code>类文件：定义文档结构</li>
<li><code>*.sty</code>包/样式文件：提供类未包括的任何东西<ul>
<li>对类文件功能的补充：提供从属于类文件的功能</li>
<li>对类文件功能的修改：改变类文件的风格</li>
</ul>
</li>
</ul>
<h3 id="基础排版宏包"><a href="#基础排版宏包" class="headerlink" title="基础排版宏包"></a>基础排版宏包</h3><ul>
<li><p>LaTeX：Leslie Lamport设计的更高层次、更抽象的排版格式</p>
<ul>
<li>包含以TeX命令为基础的一系列高层、抽象宏命令，包括
<code>\section</code>、<code>\usepackage</code>等</li>
<li>用户可以使用模板而不必决定具体排版、打印，使用更加
方便</li>
<li>是学界事实上的标准排版格式</li>
</ul>
</li>
<li><p>ConTeXt：Pragma-ADE公司设计的文档制造格式</p>
<ul>
<li>为TeX提供对先进打印特性的易用接口</li>
<li>生成的编译文件更美观，适合专业印刷行业使用</li>
</ul>
</li>
<li><p>TeXinfo：FSF（Free Software Foundation）设计的格式</p>
<ul>
<li>是Linux系统的标准文档系统</li>
</ul>
</li>
</ul>
<h3 id="中文排版宏包"><a href="#中文排版宏包" class="headerlink" title="中文排版宏包"></a>中文排版宏包</h3><ul>
<li><p>xeCJK：在XeTeX引擎下处理中日韩文字断行、标点调整、字体
选择的基础性宏包</p>
<ul>
<li>基础从CCT、CJK以来的标点禁则、标点压缩、NFSS字体补丁</li>
<li>实际上仅对简体中文处理机制比较完全</li>
<li>XeTeX本身已经能够大概处理中文文档的排版，但在某些
细节部分仍然可以改进</li>
</ul>
<blockquote>
<ul>
<li>类似的宏包还有：zhspacing、xCJK、xCCT</li>
</ul>
</blockquote>
</li>
<li><p>CTeX：提供了编写中文文档时常用的宏命令</p>
</li>
</ul>
<h3 id="其他宏包"><a href="#其他宏包" class="headerlink" title="其他宏包"></a>其他宏包</h3><ul>
<li>AMS-TeX/AMS-LaTeX：AMS（American Mathematical Society）
设计的格式<ul>
<li>提供了额外的数学字体、多行数学表述排版</li>
</ul>
</li>
</ul>
<h2 id="TeX引擎"><a href="#TeX引擎" class="headerlink" title="TeX引擎"></a>TeX引擎</h2><ul>
<li><p>pdfTex：将TeX文本编译输出为pdf格式的引擎实现</p>
<ul>
<li>最初TeX/LaTeX实现将TeX编译为DVI格式，然后方便转换为
PostScript文件用于打印</li>
<li>而pdf格式超越PostScript格式成为更流行的预打印格式</li>
<li>因此事实上，现在LaTeX发行版中包含4个部分：TeX、
pdfTeX、LaTeX、pdfLaTeX</li>
</ul>
</li>
<li><p>XeTeX：扩展了TeX的字符、字体支持的引擎实现</p>
<ul>
<li>最初TeX/LaTeX仅仅支持英语数字、字母</li>
<li>XeTeX提供了对Unicode字符和TrueType/OpenType字体的
直接支持</li>
</ul>
</li>
<li><p>LuaTeX：将TeX扩展为更sensible的编程语言的实现</p>
</li>
</ul>
<h2 id="TeX发行版"><a href="#TeX发行版" class="headerlink" title="TeX发行版"></a>TeX发行版</h2><h3 id="TeX-Live"><a href="#TeX-Live" class="headerlink" title="TeX Live"></a>TeX Live</h3><p>TeX Live：TUG（TeX User Group）发布、维护的TeX系统</p>
<ul>
<li>TeX Live包含<ul>
<li>与TeX系统相关的各种程序<ul>
<li>pdfTeX</li>
<li>XeTeX</li>
<li>LuaTeX</li>
</ul>
</li>
<li>编辑查看工具<ul>
<li>DVIOUT DVI Viewer</li>
<li>PS View</li>
<li>TeXworks</li>
</ul>
</li>
<li>常用宏包<ul>
<li>LaTeX</li>
</ul>
</li>
<li>常用字体</li>
<li>多个语言支持</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>TeX Live官网：<a target="_blank" rel="noopener" href="https://tug.org/texlive">https://tug.org/texlive</a></li>
</ul>
</blockquote>
<h3 id="MiKTeX"><a href="#MiKTeX" class="headerlink" title="MiKTeX"></a>MiKTeX</h3><p>MiKTeX：Christian Schenk开发的在MSWin下运行文字处理系统</p>
<blockquote>
<ul>
<li>MiKTeX官网：<a target="_blank" rel="noopener" href="http://miktex.org">http://miktex.org</a></li>
</ul>
</blockquote>
<h3 id="CTeX"><a href="#CTeX" class="headerlink" title="CTeX"></a>CTeX</h3><p>CTeX：CTeX学会开发，将MiKTeX及常用应用封装</p>
<ul>
<li>集成WinEdt编辑器</li>
<li>强化了对中文的处理</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-06-29T16:48:32.000Z" title="6/30/2020, 12:48:32 AM">2020-06-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-07-16T09:40:19.000Z" title="7/16/2021, 5:40:19 PM">2021-07-16</time></span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a><span> / </span><a class="link-muted" href="/categories/Linux/Tool/">Tool</a></span><span class="level-item">3 minutes read (About 501 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Linux/Tool/todotxt.html">Todo.txt</a></h1><div class="content"><h2 id="Todo-txt格式"><a href="#Todo-txt格式" class="headerlink" title="Todo.txt格式"></a>Todo.txt格式</h2><ul>
<li>todo.txt格式使用纯文本存储、表示任务</li>
<li>存储任务的文本文件中每行表示一项task</li>
<li>todo.txt类清单管理应用因此一般具备如下特点<ul>
<li>待完成任务、已完成任务分为两个文件分别存储</li>
<li>可以自由修改任务存储文件以修改任务内容</li>
</ul>
</li>
</ul>
<h3 id="基本要素"><a href="#基本要素" class="headerlink" title="基本要素"></a>基本要素</h3><p><img src="/imgs/todotxt_format_description.png" alt="todotxt_format_description"></p>
<ul>
<li><p>任务结构：各部分之间使用空格分隔</p>
<ul>
<li><code>x</code>：任务完成标识符</li>
<li>优先级：<code>([A-Z])</code></li>
<li>完成日期、创建日期：<code>Y-m-d</code>格式</li>
<li>任务描述：任务主体部分</li>
</ul>
</li>
<li><p>任务描述部分可以包含各种类型的tag，tag格式上可以放在任务
任何部分，但习惯上放在末尾</p>
<ul>
<li><em>project</em>：<code>+</code>标识</li>
<li><em>context</em>：<code>@</code>标识</li>
<li><em>[key]:[value]</em>：metadata键值对，<em>key</em>表示键值对含义
（中间一般不用空格分隔，便于处理）</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>常用特殊metadata键值对<blockquote>
<ul>
<li>时间戳：<code>t:Y-m-d</code></li>
<li>截至日期：<code>due:Y-m-d</code></li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<h2 id="Todo-txt工具"><a href="#Todo-txt工具" class="headerlink" title="Todo.txt工具"></a>Todo.txt工具</h2><h3 id="todo-txt-cli"><a href="#todo-txt-cli" class="headerlink" title="todo.txt-cli"></a>todo.txt-cli</h3><p><em>todo.txt-cli</em>：基于shell脚本管理todo.txt文件</p>
<ul>
<li><p>只提供基本todo.txt功能，可以通过自行添加脚本插件方式扩展</p>
<ul>
<li>插件文件即普通可执行脚本文件，<code>todo.sh</code>会将命令参数
传递给相应脚本文件</li>
<li><code>todo.sh [action]</code>将直接调用相应<code>action</code>名称脚本
（可建立同名文件夹、文件管理，同名文件夹文件被调用）</li>
</ul>
</li>
<li><p>使用两个文件分别存储待完成任务、已完成任务</p>
<ul>
<li>待完成任务文件中可以自行<code>x</code>标记完成，然后使用命令
归档至已完成任务文件中</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/todotxt/todo.txt-cli">https://github.com/todotxt/todo.txt-cli</a></li>
</ul>
</blockquote>
<h3 id="topydo"><a href="#topydo" class="headerlink" title="topydo"></a>topydo</h3><p><em>topydo</em>：基本python脚本管理todo.txt文件</p>
<ul>
<li>提供了cli、prompt、column三种模式</li>
<li>原生支持以下标签<ul>
<li>due、start日期</li>
<li>管理任务之间依赖管理</li>
<li>重复任务</li>
</ul>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-29T10:12:36.000Z" title="8/29/2019, 6:12:36 PM">2019-08-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-08-29T10:12:43.000Z" title="8/29/2019, 6:12:43 PM">2019-08-29</time></span><span class="level-item"><a class="link-muted" href="/categories/ML-Theory/">ML Theory</a><span> / </span><a class="link-muted" href="/categories/ML-Theory/Model-Enhencement/">Model Enhencement</a></span><span class="level-item">a few seconds read (About 1 word)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ML-Theory/Model-Enhencement/lightgbm.html">LightGBM</a></h1><div class="content"><h2 id="LightGBM"><a href="#LightGBM" class="headerlink" title="LightGBM"></a>LightGBM</h2></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-26T01:53:43.000Z" title="8/26/2019, 9:53:43 AM">2019-08-26</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-08-26T01:53:48.000Z" title="8/26/2019, 9:53:48 AM">2019-08-26</time></span><span class="level-item"><a class="link-muted" href="/categories/Math-Analysis/">Math Analysis</a><span> / </span><a class="link-muted" href="/categories/Math-Analysis/Optimization/">Optimization</a></span><span class="level-item">10 minutes read (About 1504 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Math-Analysis/Optimization/online_optimization.html">在线最优化</a></h1><div class="content"><h2 id="Truncated-Gradient"><a href="#Truncated-Gradient" class="headerlink" title="Truncated Gradient"></a>Truncated Gradient</h2><h3 id="L1正则化法"><a href="#L1正则化法" class="headerlink" title="L1正则化法"></a>L1正则化法</h3><p>L1正则化</p>
<script type="math/tex; mode=display">
w^{(t+1)} = w^{(t)} - \eta^{(t)}g^{(t)} - \eta^{(t)} \lambda sgn(w^{(t)})</script><blockquote>
<ul>
<li>$\lambda$：正则化项参数</li>
<li>$sgn$：符号函数</li>
<li>$g^{(t)}=\nabla_w L(w^{(t)}, Z^{(t)})$：损失函数对参数梯度</li>
</ul>
</blockquote>
<ul>
<li>L1正则化项在0处不可导，每次迭代使用次梯度计算正则项梯度</li>
<li>OGD中每次根据观测到的一个样本进行权重更新
（所以后面正则项次梯度只考虑非0处？？？）</li>
</ul>
<h3 id="简单截断法"><a href="#简单截断法" class="headerlink" title="简单截断法"></a>简单截断法</h3><p>简单截断法：以$k$为窗口，当$t/k$非整数时，使用标准SGD迭代，
否则如下更新权重</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t+1)} & = T_0 (w^{(t)} - \eta^{(t)} G^{(t)}, \theta) \\

T_0(v_i, \theta) & = \left \{ \begin{array}{l}
    0, & |v_i| \leq \theta \\
    v_i, & otherwise
\end{array} \right.
\end{align*}</script><blockquote>
<ul>
<li>$w^{(t)}$：模型参数</li>
<li>$g^{(t)}$：损失函数对模型参数梯度</li>
<li>$T_0$：截断函数</li>
<li>$\theta$：控制参数稀疏性</li>
</ul>
</blockquote>
<h3 id="截断梯度法"><a href="#截断梯度法" class="headerlink" title="截断梯度法"></a>截断梯度法</h3><p>截断梯度法：以$k$为窗口，当$t/k$非整数时，使用标准SGD迭代，
否则如下更新权重</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t+1)} & = T_1(w^{(t)} - \eta^{(t)} g^{(t)}, \lambda^{(t)} \eta^{(t)},
    \theta) \\

T_1(v_i, \alpha, \theta) & = \left \{ \begin{array}{l}
    max(0, v_i - \alpha), & v_i \in [0, \theta] \\
    min(0, v_1 + \alpha), & v_i \in [-\theta, 0] \\
    v_i, & otherwise
\end{array} \right.
\end{align*}</script><blockquote>
<ul>
<li>$\lambda, \theta$：控制参数$w$稀疏性</li>
</ul>
</blockquote>
<ul>
<li><p>对简单截断的改进，避免在实际（OgD）中参数因训练不足过小
而被错误截断，造成特征丢失</p>
<p><img src="/imgs/truncated_gradient_compared_with_l1.png" alt="truncated_gradient_compared_with_l1"></p>
</li>
</ul>
<h2 id="Forward-Backward-Spliting"><a href="#Forward-Backward-Spliting" class="headerlink" title="Forward-Backward Spliting"></a>Forward-Backward Spliting</h2><p>FOBOS：前向后向切分，权重更新方式为<em>proximal method</em>如下</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t.5)} & = w^{(t)} - \eta^{(t)} g^{(t)} \\
w^{(t+1)} & = \arg\min_w \{ \frac 1 2 \|w - w^{(t.5)}\|
    + \eta^{(t+0.5)} \Phi(w) \} \\
& = \arg\min_w \{ \frac 1 2 \|w - w^{(t)} + \eta^{(t)} g^{(t)}\|
    + \eta^{(t+0.5)} \Phi(w) \}
\end{align*}</script><h3 id="L1-FOBOS"><a href="#L1-FOBOS" class="headerlink" title="L1-FOBOS"></a>L1-FOBOS</h3><p>L1-FOBOS：即令$Phi(w)=\lambda |w|_1$，则根据可加性如下</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t+1)} & = \arg\min_w \sum_{i=1}^N (\frac 1 2 (w_i - v_i)^2
    + \tilde \lambda |w_i|)
w_i^{(t+1)} = \arg\min_{w_i} (\frac 1 2 (w_i - v_i)^2
    + \tilde \lambda |w_i|)
\end{align*}</script><blockquote>
<ul>
<li>$V=[v_1, v_2, \cdots, v_N]:=w^{(t.5)}$：为方便</li>
<li>$\tilde \lambda := \eta^{t.5} \lambda$：为方便</li>
<li>$\eta^{t.5}$：学习率，常取
  $\eta^{(t)} \in \theta(\frac 1 {\sqrt t})$</li>
</ul>
</blockquote>
<ul>
<li><p>则对$w_i$求次梯度、分类讨论，解得</p>
<script type="math/tex; mode=display">
w_i^{(t+1)} = \left \{ \begin{array}{l}
   v_i - \tilde \lambda, & v_i > \tilde \lambda \\
   0, & |v_i| < \tilde \lambda \\
   v_i + \tilde \lambda, & v_i < -\tilde \lambda
\end{array} \right.</script><ul>
<li><p>可以理解为：到当前样本为止，维度权重小于阈值
$\eta^{(t.5)} \lambda$）时，认为该维度不够重要，
权重置为0</p>
</li>
<li><p>可视为$k=1, \theta=\infty$的Tg算法</p>
</li>
</ul>
</li>
<li><p>另外，显然有$w_i^{(t+1)} v_i \geq 0$</p>
<script type="math/tex; mode=display">\begin{align*}
\frac 1 2 (w_i^{(t+1)} - v_i)^2 + \tilde \lambda |w_i^{(t+1)}|
& = \frac 1 2((w_i^{(t+1)})^2 - 2 w_i^{(t+1)} v_i + v_i^2)
   + \tilde \lambda |w_i^{(t+1)}| \\
& \leq \frac 1 2 v_i^2
\end{align*}</script><blockquote>
<ul>
<li>考虑$w_i^{(t+1)}$使得目标函数最小，带入$w=0$则得</li>
</ul>
</blockquote>
</li>
</ul>
<h2 id="Regularized-Dual-Averaging"><a href="#Regularized-Dual-Averaging" class="headerlink" title="Regularized Dual Averaging"></a>Regularized Dual Averaging</h2><p>RDA算法：正则对偶平均算法，权重更新方式为
<strong>包含[增广]正则项的最速下降</strong></p>
<script type="math/tex; mode=display">
w^{(t+1)} = \arg\min_w {\frac 1 t \sum_{r=1}^t g^{(r)} w + \Phi(w)
    + \frac {\beta^{(t)}} t h(w)}</script><ul>
<li><p>目标函数包括三个部分</p>
<ul>
<li>$\frac 1 t \sum_{r=1}^t g^{(r)} w$：包含之前所有梯度
均值</li>
<li>$\Phi(w)$：正则项</li>
<li>$\frac {\beta^{(t)}} t h(w)$：额外正则项，严格凸，且
不影响稀疏性</li>
</ul>
</li>
<li><p>相较于TG、FOBOS是从另一方面求解在线最优化，更有效地提升
特征权重稀疏性</p>
</li>
</ul>
<h3 id="L1-RDA"><a href="#L1-RDA" class="headerlink" title="L1 RDA"></a>L1 RDA</h3><p>L1 RDA：令$\Phi(w) := \lambda |w|_1$，
再设$h(w) := |w|_2^2$，根据可加性则有</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t+1)} & = \arg\min_w \{ \frac 1 t \sum_{r=1}^t <g^{(t)}, w>
    + \lambda \|w\|_1 + \frac {\gamma} {2\sqrt t} \|w\|_2^2 \} \\
w_i^{(t+1)} & = \arg\min_{w_i} \{bar g_i^{(t)} w_i + \lambda |w_i|
    \frac {\gamma} {2 \sqrt t} w_i^2 \}
\end{align*}</script><blockquote>
<ul>
<li>$\lambda &gt; 0, \gamma &gt; 0$</li>
<li>$\bar g<em>i^{(t)} = \frac 1 t \sum</em>{r=1}^t g_i^{(r)}$</li>
</ul>
</blockquote>
<ul>
<li><p>对$w_i$求次梯度、置零、求解得</p>
<script type="math/tex; mode=display">
w_i^{(t+1)} = \left \{ \begin{array}{l}
   -\frac {\sqrt t} {\gamma} (\bar g^{(t)} - \lambda),
       & \bar g_i^{(t)} > \lambda \\
   0, & |\bar g_i^{(t)}| \leq \lambda \\
   -\frac {\sqrt t} {\gamma} (\bar g^{(t)} + \lambda),
       & \bar g_i^{(t)} < -\lambda \\
\end{array} \right.</script><ul>
<li>可以理解为：某维度梯度累计均值绝对值$|bar g_i^{(t)}$
小于阈值$\lambda$时，对应权重被置零、产生稀疏性</li>
</ul>
</li>
<li><p>相较于L1-FOBOS的截断</p>
<ul>
<li>截断阈值为常数，更加激进、容易产生稀疏性</li>
<li>截断判断对象为梯度累加均值，避免由于训练不足而产生
截断</li>
<li>只需条件$\lambda$参数，容易权衡精度、稀疏性</li>
</ul>
</li>
</ul>
<h2 id="Follow-the-Regularized-Leader"><a href="#Follow-the-Regularized-Leader" class="headerlink" title="Follow the Regularized Leader"></a>Follow the Regularized Leader</h2><p>FTRL：综合考虑L1-RDA、L1-FOBOS</p>
<h3 id="L1-FOBOS、L1-RDA变换"><a href="#L1-FOBOS、L1-RDA变换" class="headerlink" title="L1-FOBOS、L1-RDA变换"></a>L1-FOBOS、L1-RDA变换</h3><ul>
<li><p>将L1-FOBOS类似近端算法收敛证明中展开、去除无关项、放缩，
得到类似L1-RDA目标函数</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t+1)} & = \arg\min_w \{ \frac 1 2 \|w - w^{(t)} +
   \eta^{(t)} g^{(t)}\| + \eta^{(t)} \lambda \|w\|_1 \} \\
& = \arg\min_w \{ g^{(t)} w + \lambda \|w\|_1 +
   \frac 1 {2 \eta^{(t)}} \|w - w^{(t)}\|_2^2 \}
\end{align*}</script></li>
<li><p>将L1-RDA目标函数整体整体放缩，得到</p>
<script type="math/tex; mode=display">
w^{(t+1)} = \arg\min_w \{ g^{(1:t)} w + t \lambda \|w\|_1
   + \frac 1 {2\eta^{(t)}} \|w - 0\|_2^2 \}</script><blockquote>
<ul>
<li>$g^{(1:t)} := \sum_{r=1}^t g^{(r)}$</li>
</ul>
</blockquote>
</li>
<li><p>FTRL综合考虑L1-FOBOS、L1-RDA，得到目标函数</p>
<script type="math/tex; mode=display">
w^{(t+1)} = \arg\min_w \{ g^{(1:t)} W + \lambda_1 \|w\|_1
   + \frac {\lambda_2} 2 \|w\|_2^2 + \frac 1 2
   \sum_{r=1}^t \sigma^{(r)} \|w - w^{(r)}\|_2^2 \}</script><ul>
<li>使用累加梯度更新，避免因训练不充分错误截断</li>
<li>包含L1-FOBOS、L1-RDA全部正则化项</li>
</ul>
</li>
</ul>
<h3 id="求解"><a href="#求解" class="headerlink" title="求解"></a>求解</h3><ul>
<li><p>将FTRL中最后一项拆分、去除无关项</p>
<script type="math/tex; mode=display">\begin{align*}
w^{(t+1)} & = \arg\min_w \{(g^{(1:t)} - \sum_{r=1}^t
   \sigma^{(r)} w^{(r)})w + \lambda_1 \|w\|_1 +
   \frac 1 2 (\lambda_2 + \sum_{r=1}^t \sigma^{(r)})
   \|w\|_2^2 + \frac 1 2 \sum_{r=1}^t \sigma^{(r)}
   \|w^{(r)}\|_2^2 \} \\
& = \arg\min_w \{ z^{(t)} w + \lambda_1 \|w\|_1
   + \frac 1 2 (\lambda_2 + \sum_{r=1}^t \sigma^{(r)})
   \|w\|_2^2 \} \\
z^{(t)} &= g^{(1:t)} - \sum_{r=1}^t \sigma^{(r)} w^{(r)}
\end{align*}</script></li>
<li><p>则同样根据可加性，对各分量求次梯度、置零、求解得</p>
<script type="math/tex; mode=display">
w_i^{(t+1)} = \left \{ \begin{array}{l}
   \frac 1 {\lambda_1 + \sum_{r=1}^t \sigma^{(r)}}
       (z_i^{(t)} - \lambda_1 z_i), & z_i > \lambda_1 \\
   0, & |z_i^{(t)}| \leq \lambda_1 \\
   \frac 1 {\lambda_1 + \sum_{r=1}^t \sigma^{(r)}}
       (z_i^{(t)} + \lambda_1 z_i), & z_i < -\lambda_1 \\
\end{array} \right.</script></li>
<li><p>其中学习率$\eta$为类似Adagrad优化器的学习率，但包括可学习
参数$\alpha, \beta$</p>
<script type="math/tex; mode=display">
\eta_i^{(t)} = \frac {\alpha} {\beta + \sqrt{\sum_{r=1}^t
   (g_i^{(r)})^2}}</script></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-25T13:53:20.000Z" title="8/25/2019, 9:53:20 PM">2019-08-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-08-04T09:40:21.000Z" title="8/4/2021, 5:40:21 PM">2021-08-04</time></span><span class="level-item"><a class="link-muted" href="/categories/ML-Theory/">ML Theory</a><span> / </span><a class="link-muted" href="/categories/ML-Theory/Loss/">Loss</a></span><span class="level-item">21 minutes read (About 3154 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/ML-Theory/Loss/loss_thoery.html">损失函数理论</a></h1><div class="content"><h2 id="参数估计"><a href="#参数估计" class="headerlink" title="参数估计"></a>参数估计</h2><ul>
<li><p>矩估计：<strong>建立参数和总体矩的关系</strong>，求解参数</p>
<ul>
<li>除非参数本身即为样本矩，否则基本无应用价值</li>
<li>应用场合<ul>
<li>均值：对应二次损失 $\arg\min<em>{\mu} \sum</em>{i=1}^N (x_i - \mu)^2$</li>
<li>方差：对应二次损失?</li>
</ul>
</li>
</ul>
</li>
<li><p>极大似然估计：极大化似然函数，求解概率上最合理参数</p>
<ul>
<li>需知道（假设）总体 <strong>概率分布形式</strong></li>
<li>似然函数形式复杂，求解困难<ul>
<li>往往无法直接给出参数的解析解，只能求数值解</li>
</ul>
</li>
<li>应用场合<ul>
<li>估计回归参数：对数损失
$\mathop{\arg\min}<em>{\beta} \sum</em>{i=1}^N lnP(y_i|x_i, \beta)$</li>
</ul>
</li>
</ul>
</li>
<li><p>损失函数估计：极小化损失函数，求解损失最小的参数</p>
<ul>
<li>最泛用的参数求解方法<ul>
<li>适合求解有大量参数的待求解的问题</li>
<li>往往通过迭代方式逐步求解</li>
</ul>
</li>
<li>特别的<ul>
<li>线性回归使用 <em>MSE</em> 作为损失函数时，也被称为最小二乘估计</li>
<li>极大似然估计同对数损失函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>参数估计都可以找到合适损失函数，通过迭代求解损失最小化</li>
</ul>
</blockquote>
<h3 id="随机模拟估计参数"><a href="#随机模拟估计参数" class="headerlink" title="随机模拟估计参数"></a>随机模拟估计参数</h3><ul>
<li>需要<strong>设计随机模拟实验</strong>估计参数</li>
<li>应用场合<ul>
<li>蒙特卡洛类似算法：随机化损失</li>
</ul>
</li>
</ul>
<h3 id="迭代求解参数"><a href="#迭代求解参数" class="headerlink" title="迭代求解参数"></a>迭代求解参数</h3><ul>
<li><p>损失函数定义不同</p>
<ul>
<li>包含样本量数量不同</li>
<li>惩罚项设置不同</li>
</ul>
</li>
<li><p>异步更新参数</p>
<ul>
<li>同时求解参数数量：全部、部分、单个</li>
<li>参数升维</li>
</ul>
</li>
<li><p>更新方向</p>
<ul>
<li>梯度</li>
<li>海瑟矩阵</li>
<li>次梯度</li>
</ul>
</li>
<li><p>更新方式</p>
<ul>
<li>叠加惯性</li>
<li>动态学习率</li>
</ul>
</li>
</ul>
<h2 id="Loss-Models"><a href="#Loss-Models" class="headerlink" title="Loss Models"></a><em>Loss Models</em></h2><p>模型（目标函数）在样本整体的损失：度量模型整体预测效果</p>
<ul>
<li>代表模型在整体上的性质，有不同的设计形式</li>
<li><p>可以用于 <strong>设计学习策略、评价模型</strong></p>
<ul>
<li>风险函数</li>
<li>评价函数</li>
</ul>
</li>
<li><p>有时在算法中也会使用整体损失</p>
</li>
</ul>
<h3 id="Expected-Risk-Expected-Loss-Generalization-Loss"><a href="#Expected-Risk-Expected-Loss-Generalization-Loss" class="headerlink" title="Expected Risk / Expected Loss / Generalization Loss"></a><em>Expected Risk</em> / <em>Expected Loss</em> / <em>Generalization Loss</em></h3><p>期望风险（函数）：损失函数 $L(Y, f(X))$（随机变量）期望</p>
<script type="math/tex; mode=display">
R_{exp}(f) = E_p[L(Y, f(X))] = \int_{x*y} L(y,f(x))P(x,y) dxdy</script><blockquote>
<ul>
<li>$P(X, Y)$：随机变量 $(X, Y)$ 遵循的联合分布，未知</li>
</ul>
</blockquote>
<ul>
<li><p>风险函数值度量模型预测错误程度</p>
<ul>
<li>反映了学习方法的泛化能力</li>
<li>评价标准（<strong>监督学习目标</strong>）就应该是选择期望风险最小</li>
</ul>
</li>
<li><p>联合分布未知，所以才需要学习，否则可以直接计算条件分布概率，而计算期望损失需要知道联合分布，因此监督学习是一个病态问题</p>
</li>
</ul>
<h3 id="Empirical-Risk-Empirical-Loss"><a href="#Empirical-Risk-Empirical-Loss" class="headerlink" title="Empirical Risk / Empirical Loss"></a><em>Empirical Risk</em> / <em>Empirical Loss</em></h3><p>经验风险：模型关于给定训练数据集的平均损失</p>
<script type="math/tex; mode=display">\begin{align*}
R_{emp}(f) & = \sum_{i=1}^N D_i L(y_i, f(x_i;\theta)) \\
E(R_{emp}(f)) & = R_{exp}(f)
\end{align*}</script><blockquote>
<ul>
<li>$\theta$：模型参数</li>
<li>$D_i$：样本损失权重，常为 $\frac 1 N$，在 <em>Boosting</em> 框架中不同</li>
</ul>
</blockquote>
<ul>
<li><p>经验风险损失是模型 $f(x)$ 的函数</p>
<ul>
<li>训练时，模型是模型参数的函数</li>
<li>即其为模型参数函数</li>
</ul>
</li>
<li><p>根据大数定律，样本量容量 $N$ 趋于无穷时，$R<em>{emp}(f)$ 趋于 $R</em>{exp}(f)$</p>
<ul>
<li>但是现实中训练样本数目有限、很小</li>
<li>利用经验风险估计期望常常并不理想，需要对经验风险进行矫正</li>
</ul>
</li>
<li><p>例子</p>
<ul>
<li><em>maximum probability estimation</em>：极大似然估计<ul>
<li>模型：条件概率分布（贝叶斯生成模型、逻辑回归）</li>
<li>损失函数：对数损失函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Structual-Risk-Structual-Loss"><a href="#Structual-Risk-Structual-Loss" class="headerlink" title="Structual Risk / Structual Loss"></a><em>Structual Risk</em> / <em>Structual Loss</em></h3><p>结构风险：在经验风险上加上表示 <strong>模型复杂度</strong> 的 <em>regularizer</em>（<em>penalty term</em>）</p>
<script type="math/tex; mode=display">
R_{srm} = \frac 1 N \sum_{i=1}^N L(y_i, f(x_i)) +
    \lambda J(f)</script><blockquote>
<ul>
<li>$J(f)$：模型复杂度，定义在假设空间$F$上的泛函</li>
<li>$\lambda$：权衡经验风险、模型复杂度的系数</li>
</ul>
</blockquote>
<ul>
<li>结构风险最小化<ul>
<li>添加 <em>regularization</em>（正则化），调节损失函数（目标函数）</li>
</ul>
</li>
<li>模型复杂度 $J(f)$ 表示对复杂模型的惩罚：模型 $f$ 越复杂，复杂项 $J(f)$ 越大</li>
<li>案例<ul>
<li><em>maximum posterior probability estimation</em>：最大后验概率估计<ul>
<li>损失函数：对数损失函数</li>
<li>模型复杂度：模型先验概率对数后取负</li>
<li>先验概率对应模型复杂度，先验概率越小，复杂度越大</li>
</ul>
</li>
<li>岭回归：平方损失 + $L<em>2$ 正则化
$\mathop{\arg\min}</em>{\beta} \sum_{i=1}^N (y_i - f(x_i, \beta))^2 + |\beta|$</li>
<li><em>LASSO</em>：平方损失 + $L<em>1$ 正则化
$\mathop{\arg\min}</em>{\beta} \sum_{i=1}^N (y_i - f(x_i, \beta))^2 + |\beta|_1$</li>
</ul>
</li>
</ul>
<h2 id="Generalization-Ability"><a href="#Generalization-Ability" class="headerlink" title="Generalization Ability"></a><em>Generalization Ability</em></h2><p>泛化能力：方法学习到的模型对未知数据的预测能力，是学习方法本质、重要的性质</p>
<ul>
<li>测试误差衡量学习方法的泛化能力不可靠，其依赖于测试集，而测试集有限</li>
<li>学习方法的泛化能力往往是通过研究泛化误差的概率上界进行</li>
</ul>
<h3 id="Generalization-Error-Bound"><a href="#Generalization-Error-Bound" class="headerlink" title="Generalization Error Bound"></a>Generalization Error Bound</h3><p>泛化误差上界：泛化误差的 <strong>概率</strong> 上界</p>
<ul>
<li>是样本容量函数，样本容量增加时，泛化上界趋于 0</li>
<li>是假设空间容量函数，假设空间容量越大，模型越难学习，泛化误差上界越大</li>
</ul>
<h4 id="泛化误差"><a href="#泛化误差" class="headerlink" title="泛化误差"></a>泛化误差</h4><ul>
<li><p>根据 <em>Hoeffding</em> 不等式，泛化误差满足</p>
<script type="math/tex; mode=display">\begin{align*}
& \forall h \in H, & P(|E(h) - \hat E(h)| \geq \epsilon) \leq 2 e^{-2 N \epsilon^2} \\
\Rightarrow & \forall h \in H, & P(|E(h) - \hat E(h)|
   \leq \epsilon) \geq 1 - 2|H|e^{-2N\epsilon^2}
\end{align*}</script><blockquote>
<ul>
<li>$H$：假设空间</li>
<li>$N$：样本数量</li>
<li>$E(h) := R_{exp}(h)$</li>
<li>$\hat E(h) := R_{emp}(h)$</li>
</ul>
</blockquote>
</li>
<li><p>证明如下：</p>
<script type="math/tex; mode=display">\begin{align*}
P(\forall h \in H: |E(h) - \hat E(h)| \leq \epsilon|)
   & = 1 - P(\exists h \in H: |E(h) - \hat E(h)|
   \geq \epsilon) \\
& = 1 - P((|E(h_1) - \hat E(h_1) \geq \epsilon) \vee \cdots
   \vee (|E(h_{|H|}) - \hat E_{|H|}| \geq \epsilon)) \\
& \geq 1 - \sum_{i=1}^{|H|} P(|E(h_i) - \hat E(h_i)|
   \geq \epsilon) \\
& \geq 1 - 2|H|e^{-2N \epsilon^2}
\end{align*}</script></li>
<li><p>对任意 $\epsilon$，随样本数量 $m$ 增大， $|E(h) - \hat E(h)| \leq \epsilon$ 概率增大，可以使用经验误差近似泛化误差</p>
</li>
</ul>
<h4 id="二分类泛化误差上界"><a href="#二分类泛化误差上界" class="headerlink" title="二分类泛化误差上界"></a>二分类泛化误差上界</h4><ul>
<li><p>由 <em>Hoeffding</em> 不等式</p>
<script type="math/tex; mode=display">\begin{align*}
P(E(h) - \hat E(h) & \geq \epsilon) \leq exp(-2N\epsilon^2) \\
P(\exists h \in H: E(h) - \hat E(h) \geq \epsilon) & =
   P(\bigcup_{h \in H} \{ E(h) - \hat E(h) \geq \epsilon \}) \\
& \leq \sum_{h \in H} P(E(h) - \hat E(h) \geq \epsilon) \\
& \leq |H| exp(-2 N \epsilon^2)
\end{align*}</script></li>
<li><p>则 $\forall h \in H$，有</p>
<script type="math/tex; mode=display">
P(E(h) - \hat E(h) < \epsilon) \geq 1 - |H| exp(-2 N \epsilon)</script><p>则令 $\sigma = |H| exp(-2N\epsilon^2)$，则至少以概率 $1-\sigma$ 满足如下，即得到泛化误差上界</p>
<script type="math/tex; mode=display">\begin{align*}
E(h)  & \leq \hat E(h) + \epsilon(|H|, N, \sigma) \\
\epsilon(|H|, N, \sigma) & = \sqrt
   {\frac 1 {2N} (log |H| + log \frac 1 {\sigma})}
\end{align*}</script></li>
</ul>
<h3 id="Probably-Approximate-Correct-可学习"><a href="#Probably-Approximate-Correct-可学习" class="headerlink" title="Probably Approximate Correct 可学习"></a><em>Probably Approximate Correct</em> 可学习</h3><p><em>PAC</em> 可学习：在短时间内利用少量（多项式级别）样本能够找到假设 $h^{‘}$，满足</p>
<script type="math/tex; mode=display">
P(E(h^{'}) \leq \epsilon) \geq 1 - \sigma, 0 < \epsilon, \sigma < 1</script><ul>
<li><p>即需要假设满足两个 <em>PAC</em> 辨识条件</p>
<ul>
<li>近似条件：泛化误差 $E(h^{‘})$ 足够小</li>
<li>可能正确：满足近似条件概率足够大</li>
</ul>
</li>
<li><p>同等条件下</p>
<ul>
<li>模型越复杂，泛化误差越大</li>
<li>满足条件的样本数量越大，模型泛化误差越小</li>
</ul>
</li>
<li><p><em>PAC</em> 学习理论关心能否从假设空间 $H$ 中学习到好的假设 $h$</p>
<ul>
<li>由以上泛化误差可得，取 $\sigma = 2|H|e^{-2N\epsilon^2}$，则样本量满足 $N = \frac {ln \frac {2|H|} \sigma} {2 \epsilon^2}$ 时，模型是 <em>PAC</em> 可学习的</li>
</ul>
</li>
</ul>
<h2 id="Regularization"><a href="#Regularization" class="headerlink" title="Regularization"></a><em>Regularization</em></h2><p>正则化：（向目标函数）添加额外信息以求解病态问题、避免过拟合</p>
<ul>
<li><p>常应用在机器学习、逆问题求解</p>
<ul>
<li>对模型（目标函数）复杂度惩罚</li>
<li>提高学习模型的泛化能力、避免过拟合</li>
<li>学习简单模型：稀疏模型、引入组结构</li>
</ul>
</li>
<li><p>有多种用途</p>
<ul>
<li>最小二乘也可以看作是简单的正则化</li>
<li>岭回归中的 $\mathcal{l_2}$ 范数</li>
</ul>
</li>
</ul>
<h3 id="模型复杂度"><a href="#模型复杂度" class="headerlink" title="模型复杂度"></a>模型复杂度</h3><p>模型复杂度：经常作为正则化项添加作为额外信息添加的，衡量模型复杂度方式有很多种</p>
<ul>
<li><p>函数光滑限制</p>
<ul>
<li>多项式最高次数</li>
</ul>
</li>
<li><p>向量空间范数</p>
<ul>
<li>$\mathcal{L_0} - norm$：参数个数</li>
<li>$\mathcal{L_1} - norm$：参数绝对值和</li>
<li>$\mathcal{L_2}$- norm$：参数平方和</li>
</ul>
</li>
</ul>
<h3 id="mathcal-L-0-norm"><a href="#mathcal-L-0-norm" class="headerlink" title="$\mathcal{L_0} - norm$"></a>$\mathcal{L_0} - norm$</h3><ul>
<li>$\mathcal{l_0} - norm$ 特点<ul>
<li>稀疏化约束</li>
<li>解 $\mathcal{L_0}$ 范数正则化是 <em>NP-hard</em> 问题</li>
</ul>
</li>
</ul>
<h3 id="mathcal-L-1-norm"><a href="#mathcal-L-1-norm" class="headerlink" title="$\mathcal{L_1} - norm$"></a>$\mathcal{L_1} - norm$</h3><ul>
<li><p>$\mathcal{L_1} - norm$ 特点</p>
<ul>
<li>$\mathcal{L_1}$ 范数可以通过凸松弛得到 $\mathcal{L_0}$ 的近似解</li>
<li>有时候出现解不唯一的情况</li>
<li>$\mathcal{L_1}$ 范数凸但不严格可导，可以使用依赖次梯度的方法求解极小化问题</li>
</ul>
</li>
<li><p>应用</p>
<ul>
<li><em>LASSO</em></li>
</ul>
</li>
<li><p>求解</p>
<ul>
<li><em>Proximal Method</em></li>
<li><em>LARS</em></li>
</ul>
</li>
</ul>
<h3 id="mathcal-L-2-norm"><a href="#mathcal-L-2-norm" class="headerlink" title="$\mathcal{L_2} - norm$"></a>$\mathcal{L_2} - norm$</h3><ul>
<li>$\mathcal{L_2} - norm$ 特点<ul>
<li>凸且严格可导，极小化问题有解析解</li>
</ul>
</li>
</ul>
<h3 id="mathcal-L-1-L-2"><a href="#mathcal-L-1-L-2" class="headerlink" title="$\mathcal{L_1 + L_2}$"></a>$\mathcal{L_1 + L_2}$</h3><ul>
<li><p>$\mathcal{L_1 + L_2}$ 特点</p>
<ul>
<li>有组效应，相关变量权重倾向于相同</li>
</ul>
</li>
<li><p>应用</p>
<ul>
<li><em>Elastic Net</em></li>
</ul>
</li>
</ul>
<h3 id="稀疏解产生"><a href="#稀疏解产生" class="headerlink" title="稀疏解产生"></a>稀疏解产生</h3><p>稀疏解：待估参数系数在某些分量上为 0</p>
<h4 id="mathcal-L-1-norm-稀疏解的产生"><a href="#mathcal-L-1-norm-稀疏解的产生" class="headerlink" title="$\mathcal{L_1} - norm$ 稀疏解的产生"></a>$\mathcal{L_1} - norm$ 稀疏解的产生</h4><blockquote>
<ul>
<li>$\mathcal{L_1}$ 范数在参数满足 <strong>一定条件</strong> 情况下，能对 <strong>平方损失</strong> 产生稀疏效果</li>
</ul>
</blockquote>
<ul>
<li><p>在 $[-1,1]$ 内 $y=|x|$ 导数大于 $y=x^2$（除 0 点）</p>
<ul>
<li>则特征在 0 点附近内变动时，为了取到极小值，参数必须始终为 0</li>
<li>高阶项在 0 点附近增加速度较慢，所以 $\mathcal{L_1} - norm$ 能产生稀疏解是很广泛的</li>
<li>$mathcal{L_1} - norm$ 前系数（权重）越大，能够容许高阶项增加的幅度越大，即压缩能力越强</li>
</ul>
</li>
<li><p>在 0 附近导数 “不小”，即导数在 0 点非 0</p>
<ul>
<li>对多项式正则化项<ul>
<li>$\mathcal{L_1} - norm$ 项对稀疏化解起决定性作用</li>
<li>其他项对稀疏解无帮助</li>
</ul>
</li>
<li>对“非多项式”正则化项<ul>
<li>$e^{|x|}-1$、$ln(|x|+1)$ 等在0点泰勒展开同样得到 $\mathcal{L_1} - norm$ 项</li>
<li>但是此类正则化项难以计算数值，不常用</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="mathcal-L-1-norm-稀疏解推广"><a href="#mathcal-L-1-norm-稀疏解推广" class="headerlink" title="$\mathcal{L_1} - norm$ 稀疏解推广"></a>$\mathcal{L_1} - norm$ 稀疏解推广</h4><ul>
<li><p>正负差异化：在正负设置权重不同的 $\mathcal{L_1}$，赋予在正负不同的压缩能力，甚至某侧完全不压缩</p>
</li>
<li><p>分段函数压缩：即只要保证在 0 点附近包含 $\mathcal{L_1}$ 用于产生稀疏解，远离 0 处可以设计为常数等不影响精确解的值</p>
<ul>
<li><p><em>Smoothly Clipped Absolute Deviation</em></p>
<script type="math/tex; mode=display">
R(x|\lambda, \gamma) = \left \{ \begin{array} {l}
  \lambda|x| \qquad & if |x| \leq \lambda \\
  \frac {2\gamma\lambda|x| - x^2 - {\lambda}^2 }
      {2(\gamma - 1)} &
      if \gamma< |x| <\gamma\lambda \\
  \frac { {\lambda}^2(\gamma+1)} 2 &
      if |x| \geq \gamma\lambda
\end{array} \right.</script></li>
<li><p><em>Derivate of SCAD</em></p>
<script type="math/tex; mode=display">
R(x; \lambda, \gamma) = \left \{ \begin{array} {l}
  \lambda \qquad & if |x| \leq \gamma \\
  \frac {\gamma\lambda - |x|} {\gamma - 1} &
      if \lambda < |x| < \gamma\lambda \\
  0 & if |x| \geq \gamma\lambda
\end{array} \right.</script></li>
<li><p><em>Minimax Concave Penalty</em></p>
<script type="math/tex; mode=display">
R_{\gamma}(x;\lambda) = \left \{ \begin{array} {l}
  \lambda|x| - \frac {x^2} {2\gamma} \qquad &
      if |x| \leq \gamma\lambda \\
  \frac 1 2 \gamma{\lambda}^2 &
      if |x| > \gamma\lambda
\end{array} \right.</script></li>
</ul>
</li>
<li><p>分指标：对不同指标动态设置 $\mathcal{L_0}$ 系数</p>
<ul>
<li><em>Adaptive Lasso</em>：$\lambda \sum_J w_jx_j$</li>
</ul>
</li>
</ul>
<h4 id="稀疏本质"><a href="#稀疏本质" class="headerlink" title="稀疏本质"></a>稀疏本质</h4><p>稀疏本质：极值、<strong>不光滑</strong>，即导数符号突然变化</p>
<ul>
<li><p>若某约束项导数符号突然变化、其余项在该点处导数为 0，为保证仍然取得极小值，解会聚集（极小）、疏远（极大）该点（类似坡的陡峭程度）</p>
<ul>
<li>即此类不光滑点会<strong>抑制解的变化</strong>，不光滑程度即导数变化幅度越大，抑制解变化能力越强，即吸引、排斥解能力越强</li>
<li>容易构造压缩至任意点的约束项</li>
<li>特殊的，不光滑点为 0 时，即得到稀疏解</li>
</ul>
</li>
<li><p>可以设置的多个极小不光滑点，使得解都在不连续集合中</p>
<ul>
<li>可以使用三角函数、锯齿函数等构造，但此类约束项要起效果，必然会使得目标函数非凸<ul>
<li>但是多变量场合，每个变量实际解只会在某个候选解附近，其邻域内仍然是凸的</li>
<li>且锯齿函数这样的突变非凸可能和凸函数具有相当的优秀性质</li>
</ul>
</li>
<li>当这些点均为整数时，这似乎可以近似求解 <strong>整数规划</strong></li>
</ul>
</li>
</ul>
<h2 id="Early-Stopping"><a href="#Early-Stopping" class="headerlink" title="Early Stopping"></a><em>Early Stopping</em></h2><p><em>Early Stopping</em>：提前终止（训练）</p>
<ul>
<li><em>Early Stopping</em> 也可以被视为是 <em>regularizing on time</em><ul>
<li>迭代式训练随着迭代次数增加，往往会有学习复杂模型的倾向</li>
<li>对时间施加正则化，可以减小模型复杂度、提高泛化能力</li>
</ul>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-19T09:25:00.000Z" title="8/19/2019, 5:25:00 PM">2019-08-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-08-02T07:08:50.000Z" title="8/2/2021, 3:08:50 PM">2021-08-02</time></span><span class="level-item"><a class="link-muted" href="/categories/Python/">Python</a><span> / </span><a class="link-muted" href="/categories/Python/TensorFlow/">TensorFlow</a></span><span class="level-item">3 minutes read (About 495 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Python/TensorFlow/tf_resources.html">TensorFlow资源管理</a></h1><div class="content"><h2 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h2><h3 id="tf-placeholder"><a href="#tf-placeholder" class="headerlink" title="tf.placeholder"></a><code>tf.placeholder</code></h3><p><em>placeholder</em>：占位符，执行时通过<code>feed_dict</code>参数设置值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tf.placeholder(</span><br><span class="line">	dtype,</span><br><span class="line">	shape=<span class="literal">None</span>,</span><br><span class="line">	name=<span class="literal">None</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li><code>shape</code>：并不必须，但最好设置参数方便debug</li>
</ul>
</blockquote>
<ul>
<li>需要导入数据给placeholder，可能影响程序速度</li>
<li>方便用户替换图中值</li>
</ul>
<h3 id="tf-data-DataSet"><a href="#tf-data-DataSet" class="headerlink" title="tf.data.DataSet"></a><code>tf.data.DataSet</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">data</span>.<span class="title">DataSet</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	# 从<span class="title">tensor</span> <span class="title">slice</span>创建`<span class="title">Dataset</span>`</span></span><br><span class="line"><span class="function">	<span class="title">def</span> <span class="title">from_tensor_slices</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		?data=(<span class="params">?features, ?labels</span>)</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 从生成器创建`Dataset`</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">from_generator</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		gen,</span></span></span><br><span class="line"><span class="params"><span class="function">		output_types,</span></span></span><br><span class="line"><span class="params"><span class="function">		output_shapes</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 迭代数据集一次，无需初始化</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">make_one_shot_iterator</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 迭代数据集任意次，每轮迭代需要初始化</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">make_initializable_iterator</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># shuffle数据集</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">shuffle</span>(<span class="params">self, ?seed:<span class="built_in">int</span></span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 重复复制数据集</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">repeat</span>(<span class="params">self, ?times:<span class="built_in">int</span></span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 将数据集划分为batch</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">batch</span>(<span class="params">self, batch_size:<span class="built_in">int</span></span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">map</span>(<span class="params">self, func:<span class="built_in">callable</span></span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>创建只能迭代一轮的迭代器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">iterator = dataset.make_one_shot_iterator()</span><br><span class="line"><span class="comment"># 这里`X`、`Y`也是OPs，在执行时候才返回Tensor</span></span><br><span class="line">X, Y = iterator.get_next()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">	<span class="built_in">print</span>(sess.run([X, Y]))</span><br><span class="line">	<span class="built_in">print</span>(sess.run([X, Y]))</span><br><span class="line">	<span class="built_in">print</span>(sess.run([X, Y]))</span><br><span class="line">		<span class="comment"># 每次不同的值</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建可以多次初始化的迭代器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">iterator = data.make_initializable_iterator()</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">		<span class="comment"># 每轮重新初始化迭代器，重新使用</span></span><br><span class="line">		sess.run(iterator.initializer)</span><br><span class="line">		total_loss = <span class="number">0</span></span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">				sess.run([optimizer])</span><br><span class="line">		<span class="comment"># 手动处理迭代器消耗完毕</span></span><br><span class="line">		<span class="keyword">except</span> tf.error.OutOfRangeError:</span><br><span class="line">			<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>tf.data</code>和<code>tf.placeholder</code>适合场景对比</p>
<ul>
<li><code>tf.data</code>速度更快、适合处理多数据源</li>
<li><code>tf.placeholder</code>更pythonic、原型开发迭代速度快</li>
</ul>
</li>
</ul>
<h4 id="读取文件数据"><a href="#读取文件数据" class="headerlink" title="读取文件数据"></a>读取文件数据</h4><p>可以从多个文件中读取数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 文件每行为一个entry</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">data</span>.<span class="title">TextLineDataset</span>(<span class="params">filenames</span>):</span></span><br><span class="line"> <span class="comment"># 文件中entry定长</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">data</span>.<span class="title">FixedLengthRecordDataset</span>(<span class="params">filenames</span>):</span></span><br><span class="line"> <span class="comment"># 文件为tfrecord格式</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">data</span>.<span class="title">TFRecordDataset</span>(<span class="params">filenames</span>):</span></span><br></pre></td></tr></table></figure>
<h4 id="tf-data-Iterator"><a href="#tf-data-Iterator" class="headerlink" title="tf.data.Iterator"></a><code>tf.data.Iterator</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">data</span>.<span class="title">Iterator</span>:</span></span><br><span class="line">	<span class="comment"># 获取下组迭代数据</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get_next</span>():</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 根据dtype、shape创建迭代器</span></span><br><span class="line"><span class="meta">	@classmethod</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">from_structure</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		?dtype: <span class="built_in">type</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		?shape: [<span class="built_in">int</span>]/(<span class="params"><span class="built_in">int</span></span>)</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 从数据中初始化迭代器</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">make_initializer</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		?dataset: tf.data.Dataset</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-19T09:20:00.000Z" title="8/19/2019, 5:20:00 PM">2019-08-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-08-19T09:20:00.000Z" title="8/19/2019, 5:20:00 PM">2019-08-19</time></span><span class="level-item"><a class="link-muted" href="/categories/Python/">Python</a><span> / </span><a class="link-muted" href="/categories/Python/TensorFlow/">TensorFlow</a></span><span class="level-item">2 minutes read (About 250 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Python/TensorFlow/tf_pythonio.html">TensorFlow Python IO接口</a></h1><div class="content"><h2 id="TFRecord"><a href="#TFRecord" class="headerlink" title="TFRecord"></a>TFRecord</h2><p>TFRecord格式：序列化的<code>tf.train.Example</code> protbuf对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">python_io</span>.<span class="title">TFRecordWriter</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		?fileanme: <span class="built_in">str</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		options: tf.python_io.TFRecordOptions,</span></span></span><br><span class="line"><span class="params"><span class="function">		name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">python_io</span>.<span class="title">TFRecordReader</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		options: tf.python_io.TFRecordOptions,</span></span></span><br><span class="line"><span class="params"><span class="function">		name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###	Feature/Features</span></span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">train</span>.<span class="title">Features</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		feature: &#123;<span class="built_in">str</span>: tf.train.Feature&#125;</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">train</span>.<span class="title">Feature</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		int64_list: tf.train.Int64List,</span></span></span><br><span class="line"><span class="params"><span class="function">		float64_list: tf.train.Float64List,</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>)</span></span><br></pre></td></tr></table></figure>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><ul>
<li><p>转换、写入TFRecord</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建写入文件</span></span><br><span class="line">writer = tf.python_io.TFRecord(out_file)</span><br><span class="line">shape, binary_image = get_image_binary(image_file)</span><br><span class="line"><span class="comment"># 创建Features对象</span></span><br><span class="line">featurs = tf.train.Features(</span><br><span class="line">	feature = &#123;</span><br><span class="line">		<span class="string">&quot;label&quot;</span>: tf.train.Feature(int64_list=tf.train.Int64List(label)),</span><br><span class="line">		<span class="string">&quot;shape&quot;</span>: tf.train.Feature(bytes_list=tf.train.BytesList(shape)),</span><br><span class="line">		<span class="string">&quot;image&quot;</span>: tf.train.Feature(bytes_list=tf.train.BytesList(binary_image))</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment"># 创建包含以上特征的示例对象</span></span><br><span class="line">sample = tf.train.Example(features=Features)</span><br><span class="line"><span class="comment"># 写入文件</span></span><br><span class="line">writer.write(sample.SerializeToString())</span><br><span class="line">writer.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p>读取TFRecord</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dataset = tf.data.TFRecordDataset(tfrecord_files)</span><br><span class="line">dataset = dataset.<span class="built_in">map</span>(_parse_function)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_parse_function</span>(<span class="params">tf_record_serialized</span>):</span></span><br><span class="line">	features = &#123;</span><br><span class="line">		<span class="string">&quot;labels&quot;</span>: tf.FixedLenFeature([], tf.int64),</span><br><span class="line">		<span class="string">&quot;shape&quot;</span>: tf.FixedLenFeature([], tf.string),</span><br><span class="line">		<span class="string">&quot;image&quot;</span>: tf.FixedLenFeature([], tf.string)</span><br><span class="line">	&#125;</span><br><span class="line">	parsed_features = tf.parse_single_example(tfrecord_serialized, features)</span><br><span class="line">	<span class="keyword">return</span> parsed_features[<span class="string">&quot;label&quot;</span>], parsed_features[<span class="string">&quot;shape&quot;</span>],</span><br><span class="line">			parsed_features[<span class="string">&quot;image&quot;</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-19T09:20:00.000Z" title="8/19/2019, 5:20:00 PM">2019-08-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-08-19T09:20:00.000Z" title="8/19/2019, 5:20:00 PM">2019-08-19</time></span><span class="level-item"><a class="link-muted" href="/categories/Python/">Python</a><span> / </span><a class="link-muted" href="/categories/Python/TensorFlow/">TensorFlow</a></span><span class="level-item">a few seconds read (About 84 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Python/TensorFlow/tf_flow_control.html">TensorFlow控制算符</a></h1><div class="content"><h2 id="控制OPs"><a href="#控制OPs" class="headerlink" title="控制OPs"></a>控制OPs</h2><h3 id="Neural-Network-Building-Blocks"><a href="#Neural-Network-Building-Blocks" class="headerlink" title="Neural Network Building Blocks"></a>Neural Network Building Blocks</h3><h4 id="tf-softmax"><a href="#tf-softmax" class="headerlink" title="tf.softmax"></a><code>tf.softmax</code></h4><h4 id="tf-Sigmod"><a href="#tf-Sigmod" class="headerlink" title="tf.Sigmod"></a><code>tf.Sigmod</code></h4><h4 id="tf-ReLU"><a href="#tf-ReLU" class="headerlink" title="tf.ReLU"></a><code>tf.ReLU</code></h4><h4 id="tf-Convolution2D"><a href="#tf-Convolution2D" class="headerlink" title="tf.Convolution2D"></a><code>tf.Convolution2D</code></h4><h4 id="tf-MaxPool"><a href="#tf-MaxPool" class="headerlink" title="tf.MaxPool"></a><code>tf.MaxPool</code></h4><h3 id="Checkpointing"><a href="#Checkpointing" class="headerlink" title="Checkpointing"></a>Checkpointing</h3><h4 id="tf-Save"><a href="#tf-Save" class="headerlink" title="tf.Save"></a><code>tf.Save</code></h4><h4 id="tf-Restore"><a href="#tf-Restore" class="headerlink" title="tf.Restore"></a><code>tf.Restore</code></h4><h3 id="Queue-and-Synchronization"><a href="#Queue-and-Synchronization" class="headerlink" title="Queue and Synchronization"></a>Queue and Synchronization</h3><h4 id="tf-Enqueue"><a href="#tf-Enqueue" class="headerlink" title="tf.Enqueue"></a><code>tf.Enqueue</code></h4><h4 id="tf-Dequeue"><a href="#tf-Dequeue" class="headerlink" title="tf.Dequeue"></a><code>tf.Dequeue</code></h4><h4 id="tf-MutexAcquire"><a href="#tf-MutexAcquire" class="headerlink" title="tf.MutexAcquire"></a><code>tf.MutexAcquire</code></h4><h4 id="tf-MutexRelease"><a href="#tf-MutexRelease" class="headerlink" title="tf.MutexRelease"></a><code>tf.MutexRelease</code></h4><h3 id="Control-Flow"><a href="#Control-Flow" class="headerlink" title="Control Flow"></a>Control Flow</h3><h4 id="tf-count-up-to"><a href="#tf-count-up-to" class="headerlink" title="tf.count_up_to"></a><code>tf.count_up_to</code></h4><h4 id="tf-cond"><a href="#tf-cond" class="headerlink" title="tf.cond"></a><code>tf.cond</code></h4><p><code>pred</code>为<code>True</code>，执行<code>true_fn</code>，否则执行<code>false_fn</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tf.cond(</span><br><span class="line">	pred,</span><br><span class="line">	true_fn=<span class="literal">None</span>,</span><br><span class="line">	false_fn =<span class="literal">None</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="tf-case"><a href="#tf-case" class="headerlink" title="tf.case"></a><code>tf.case</code></h4><h4 id="tf-while-loop"><a href="#tf-while-loop" class="headerlink" title="tf.while_loop"></a><code>tf.while_loop</code></h4><h4 id="tf-group"><a href="#tf-group" class="headerlink" title="tf.group"></a><code>tf.group</code></h4><h4 id="tf-Merge"><a href="#tf-Merge" class="headerlink" title="tf.Merge"></a><code>tf.Merge</code></h4><h4 id="tf-Switch"><a href="#tf-Switch" class="headerlink" title="tf.Switch"></a><code>tf.Switch</code></h4><h4 id="tf-Enter"><a href="#tf-Enter" class="headerlink" title="tf.Enter"></a><code>tf.Enter</code></h4><h4 id="tf-Leave"><a href="#tf-Leave" class="headerlink" title="tf.Leave"></a><code>tf.Leave</code></h4><h4 id="tf-NextIteration"><a href="#tf-NextIteration" class="headerlink" title="tf.NextIteration"></a><code>tf.NextIteration</code></h4></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-19T09:13:00.000Z" title="8/19/2019, 5:13:00 PM">2019-08-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-08-02T07:08:09.000Z" title="8/2/2021, 3:08:09 PM">2021-08-02</time></span><span class="level-item"><a class="link-muted" href="/categories/Python/">Python</a><span> / </span><a class="link-muted" href="/categories/Python/TensorFlow/">TensorFlow</a></span><span class="level-item">10 minutes read (About 1531 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Python/TensorFlow/tf_operators.html">TensorFlow操作符</a></h1><div class="content"><h2 id="Tensor"><a href="#Tensor" class="headerlink" title="Tensor"></a>Tensor</h2><p>张量：n-dimensional array，类型化的多维数组</p>
<ul>
<li>TF使用Tensor表示所有的数据</li>
<li>Tensor包含一个静态类型rank、一个shape</li>
<li>TF会将python原生类型转换为相应的Tensor<ul>
<li>0-d tensor：scalar</li>
<li>1-d tensor：vector，1d-array</li>
<li>2-d tensor：matrix，2d-array</li>
</ul>
</li>
</ul>
<h3 id="Data-Type"><a href="#Data-Type" class="headerlink" title="Data Type"></a>Data Type</h3><ul>
<li><p>TF被设计为和numpy可以无缝结合</p>
<ul>
<li>TF的变量类型基于numpy变量类型：<code>tf.int32==np.int32</code></li>
<li>bool、numeric等大部分类型可以不加转换的使用TF、np
变量类型</li>
<li>TF、np中string类型不完全一样，但TF仍然可以从numpy
中导入string数组，但是不能在numpy中指定类型</li>
</ul>
</li>
<li><p>但尽量使用TF变量类型</p>
<ul>
<li>python原生类型：没有<strong>细分</strong>类型，TF需要推断类型</li>
<li>numpy类型：numpy不兼容GPU，也不能自动计算衍生类型</li>
</ul>
</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tf.float16</code></td>
<td>16-bit half-precision floating-point</td>
</tr>
<tr>
<td><code>tf.float32</code></td>
<td>32-bit single-presicion floating-point</td>
</tr>
<tr>
<td><code>tf.float64</code></td>
<td>64-bit double-presicion floating-point</td>
</tr>
<tr>
<td><code>tf.bfloat16</code></td>
<td>16-bit truncated floating-point</td>
</tr>
<tr>
<td><code>tf.complex64</code></td>
<td>64-bit single-presicion complex</td>
</tr>
<tr>
<td><code>tf.complex128</code></td>
<td>128-bit double-presicion complex</td>
</tr>
<tr>
<td><code>tf.int8</code></td>
<td>8-bit signed integer</td>
</tr>
<tr>
<td><code>tf.uint8</code></td>
<td>8-bit unsigned integer</td>
</tr>
<tr>
<td><code>tf.int16</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.uint16</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.int32</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.int64</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.bool</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.string</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.qint8</code></td>
<td>quantized 8-bit signed integer</td>
</tr>
<tr>
<td><code>tf.quint8</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.qint16</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.quint16</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.qint32</code></td>
<td></td>
</tr>
<tr>
<td><code>tf.resource</code></td>
<td>handle to a mutable resource</td>
</tr>
</tbody>
</table>
</div>
<h2 id="Constant-OPs"><a href="#Constant-OPs" class="headerlink" title="Constant OPs"></a>Constant OPs</h2><h3 id="tf-constant"><a href="#tf-constant" class="headerlink" title="tf.constant"></a><code>tf.constant</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">constant</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	value,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=none,</span></span></span><br><span class="line"><span class="params"><span class="function">	shape=none,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="string">&quot;Const&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	verify_shape=<span class="literal">False</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
<h3 id="同值常量OPs"><a href="#同值常量OPs" class="headerlink" title="同值常量OPs"></a>同值常量OPs</h3><ul>
<li><p><em>zeros</em>：类似np中相应函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `np.zeros`</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">zeros</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	shape,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=tf.float32,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"># `<span class="title">np</span>.<span class="title">zores_like</span>`</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">zeros_like</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	input_tensor,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	optimizeTrue</span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>若没有指明<code>dtype</code>，根据<code>input_tensor</code>确定其中值<ul>
<li>对数值型为<code>0.0</code></li>
<li>对bool型为<code>False</code></li>
<li>对字符串为<code>b&#39;&#39;</code></li>
</ul>
</li>
</ul>
</li>
<li><p><em>ones</em>：类似np中相应函数</p>
</li>
</ul>
<pre><code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `np.ones`</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">ones</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	shape,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=tf.float32,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"># `<span class="title">np</span>.<span class="title">ones_like</span>`</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">ones_like</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	input_tensor,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	optimize=<span class="literal">True</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>

-    若没有指明`dtype`，根据`input_tensor`确定
    -    对数值型为`0.0`
    -    对bool型为`True`
    -    对字符串报错
</code></pre><ul>
<li><p><em>fill</em>：以<code>value</code>填充<code>dims</code>给定形状</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `np.fill`</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">fill</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	dims,</span></span></span><br><span class="line"><span class="params"><span class="function">	value,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="列表常量OPs"><a href="#列表常量OPs" class="headerlink" title="列表常量OPs"></a>列表常量OPs</h3><blockquote>
<ul>
<li>tensor列表不能直接<code>for</code>语句等迭代</li>
</ul>
</blockquote>
<ul>
<li><p><code>tf.lin_space</code>：<code>start</code>、<code>stop</code>直接均分为<code>num</code>部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `np.linspace`</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lin_space</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	start,</span></span></span><br><span class="line"><span class="params"><span class="function">	stop,</span></span></span><br><span class="line"><span class="params"><span class="function">	num,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>tf.range</code>：<code>start</code>、<code>stop</code>间等间隔<code>delta</code>取值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `np.arange`</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">range</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	start,</span></span></span><br><span class="line"><span class="params"><span class="function">	limit=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	delta=<span class="number">1</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="string">&quot;range&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="随机常量OPs"><a href="#随机常量OPs" class="headerlink" title="随机常量OPs"></a>随机常量OPs</h3><ul>
<li><p><em>seed</em>：设置随机数种子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># np.random.seed</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">set_random_seed</span>(<span class="params">seed</span>):</span></span><br><span class="line">	<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><em>random</em>：随机生成函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">random_normal</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">truncated_normal</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	?avg=<span class="number">0</span>/<span class="built_in">int</span>/(<span class="params"><span class="built_in">int</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="function">	stddev=<span class="number">1.0</span>/<span class="built_in">float</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	seed=<span class="literal">None</span>/<span class="built_in">int</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>):</span></span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">random_uniform</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	shape(<span class="params">1d-arr</span>),</span></span></span><br><span class="line"><span class="params"><span class="function">	minval=<span class="number">0</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	maxval=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=tf.float32,</span></span></span><br><span class="line"><span class="params"><span class="function">	seed=<span class="literal">None</span>/<span class="built_in">int</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=<span class="literal">None</span>/<span class="built_in">str</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>):</span></span><br><span class="line">	<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">random_crop</span>()</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">multinomial</span>()</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">random_gamma</span>()</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><em>shuffle</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">random_shuffle</span>()</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="运算OPs"><a href="#运算OPs" class="headerlink" title="运算OPs"></a>运算OPs</h2><h3 id="元素OPs"><a href="#元素OPs" class="headerlink" title="元素OPs"></a>元素OPs</h3><h4 id="四则运算"><a href="#四则运算" class="headerlink" title="四则运算"></a>四则运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">subtract</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">sub</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">multiply</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">mul</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function">	# 加、减、乘</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">floordiv</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">floor_div</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">div</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">truncatediv</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function">	# 地板除</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">divide</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">truediv</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function">	# 浮点除</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">realdiv</span>(<span class="params">x, y, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function">	# 实数除法，只能用于实数？</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">add_n</span>(<span class="params"><span class="built_in">input</span>, name=<span class="literal">None</span></span>)</span></span><br><span class="line"><span class="function">	# `<span class="title">input</span>`：<span class="title">list</span>-<span class="title">like</span>，元素<span class="title">shape</span>、<span class="title">type</span>相同</span></span><br><span class="line"><span class="function">	# 累加`<span class="title">input</span>`中元素的值</span></span><br></pre></td></tr></table></figure>
<h4 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">greater</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">less</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">equal</span>()</span></span><br></pre></td></tr></table></figure>
<h4 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">log</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">square</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">round</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">sqrt</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">rsqrt</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">pow</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">abs</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">negative</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">sign</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">reciprocal</span>()		# 倒数</span></span><br></pre></td></tr></table></figure>
<h3 id="列表运算OPs"><a href="#列表运算OPs" class="headerlink" title="列表运算OPs"></a>列表运算OPs</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">Concat</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">Slice</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">Split</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">Rank</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">Shape</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">Shuffle</span>()</span></span><br></pre></td></tr></table></figure>
<h3 id="矩阵OPs"><a href="#矩阵OPs" class="headerlink" title="矩阵OPs"></a>矩阵OPs</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">MatMul</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">MatrixInverse</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">MatrixDeterminant</span>()</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">tf</span>.<span class="title">tensordot</span>()				# 矩阵点乘</span></span><br></pre></td></tr></table></figure>
<h3 id="梯度OPs"><a href="#梯度OPs" class="headerlink" title="梯度OPs"></a>梯度OPs</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">def tf.gradients(				# 求`y`对`[xs]`个元素偏导</span><br><span class="line">	ys: tf.OPs,</span><br><span class="line">	xs: tf.OPs/[tf.OPs],</span><br><span class="line">	grad_ys=None,</span><br><span class="line">	name=None</span><br><span class="line">)</span><br><span class="line">def tf.stop_gradient(</span><br><span class="line">	input,</span><br><span class="line">	name=None</span><br><span class="line">)</span><br><span class="line"><span class="function">def <span class="title">clip_by_value</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	t,</span></span></span><br><span class="line"><span class="params"><span class="function">	clip_value_min,</span></span></span><br><span class="line"><span class="params"><span class="function">	clip_value_max,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=None</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br><span class="line"><span class="function">def tf.<span class="title">clip_by_norm</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	t,</span></span></span><br><span class="line"><span class="params"><span class="function">	clip_norm,</span></span></span><br><span class="line"><span class="params"><span class="function">	axes=None,</span></span></span><br><span class="line"><span class="params"><span class="function">	name=None</span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Variable"><a href="#Variable" class="headerlink" title="Variable"></a>Variable</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Variable</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		init_value=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		trainable=<span class="literal">True</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		collections=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		validata_shape=<span class="literal">True</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		caching_device=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		name=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		variable_def=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		dtype=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		expected_shape=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		import_scope=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		constraint=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function">	</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	# 初始化变量</span></span><br><span class="line"><span class="function">	# `<span class="title">sess</span>.<span class="title">run</span>`其即初始化变量</span></span><br><span class="line"><span class="function">	<span class="title">def</span> <span class="title">intializer</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 读取变量值</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">value</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 获取变量初始化值，其他变量调用、声明依赖该变量</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">initilized_value</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 计算、获取变量值，类似`sess.run(OP)`</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">eval</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 给变量赋值</span></span><br><span class="line">	<span class="comment"># `assgin`内部有初始化Variable，所以有时可以不用初始化</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">assign</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line">	<span class="comment">#`assgin_add`等依赖于原始值，不会初始化变量</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">assign_add</span>(<span class="params">self, ?dec</span>)</span></span><br><span class="line"><span class="function">	<span class="title">def</span> <span class="title">assign_divide</span>(<span class="params">self, ?dec</span>)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>Variable</code>是包含很多方法的类</p>
<ul>
<li>其中<strong>方法OPs</strong>和一般的OP一样，也需要在Session中执行
才能生效</li>
<li><code>Variable</code>必须在会话中<strong>初始化</strong>后，才能使用</li>
<li>会话维护自身独立<code>Variable</code>副本，不相互影响</li>
</ul>
</li>
<li><p><code>Variable</code>和图分开存储，甚至是存储在独立参数服务器上</p>
<ul>
<li>存储大量数据也不会拖慢图载入速度</li>
<li>通常用于存储训练过程中weight、bias、维护图执行过程
中状态信息</li>
</ul>
</li>
<li><p>constants是常数OPs</p>
<ul>
<li>存储在图中：每次载入图会同时被载入，过大的constants
会使得载入图非常慢</li>
<li>所以最好只对原生类型使用constants</li>
</ul>
</li>
</ul>
<h3 id="Variable创建"><a href="#Variable创建" class="headerlink" title="Variable创建"></a>Variable创建</h3><h4 id="tf-get-variable"><a href="#tf-get-variable" class="headerlink" title="tf.get_variable"></a><code>tf.get_variable</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_variable</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	name,</span></span></span><br><span class="line"><span class="params"><span class="function">	shape=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	dtype=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	initializer=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	regularizer=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	trainable=<span class="literal">True</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	collections=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	caching_device=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	partitioner=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	validate_shape=<span class="literal">True</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	use_resource=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	custom_getter=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	constraint=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>此封装工厂方法相较于直接通过<code>tf.Variable</code>更好<ul>
<li>若变量已设置，可通过变量名获取变量，方便变量共享</li>
<li>可以提供更多的参数定制变量值</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment"># `tf.Variable`创建变量</span></span><br><span class="line">s = tf.Variable(<span class="number">2</span>, name=<span class="string">&quot;scalar&quot;</span>)</span><br><span class="line">m = tf.Variable([[<span class="number">0</span>,<span class="number">1</span>], [<span class="number">2</span>,<span class="number">3</span>]], name=<span class="string">&quot;matrix&quot;</span>)</span><br><span class="line">w = tf.Variable(tf.zeros([<span class="number">784</span>, <span class="number">10</span>]))</span><br><span class="line">	<span class="comment"># `tf.get_variable`创建、获取变量</span></span><br><span class="line">s = tf.get_variable(<span class="string">&quot;scalar&quot;</span>, initializer=tf.constant(<span class="number">2</span>))</span><br><span class="line">m = tf.get_variable(<span class="string">&quot;matrix&quot;</span>, initializer=tf.constant([[<span class="number">0</span>,<span class="number">1</span>], [<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">W = tf.get_variable(<span class="string">&quot;big_matrix&quot;</span>,</span><br><span class="line">	shape=(<span class="number">784</span>, <span class="number">10</span>),</span><br><span class="line">	initializer=tf.zeros_initializer()</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="Variable初始化"><a href="#Variable初始化" class="headerlink" title="Variable初始化"></a>Variable初始化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">	<span class="comment"># 初始化所有Variables</span></span><br><span class="line">	sess.run(tf.global_variable_initialier())</span><br><span class="line">	<span class="comment"># 初始化变量子集</span></span><br><span class="line">	sess.run(tf.variable_initializer([s, m])</span><br><span class="line">	<span class="comment"># 初始化指定单个变量</span></span><br><span class="line">	sess.run(s.initializer)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>若某Variable依赖其他Variable，需要使用
<code>initialized_value</code>指明依赖，确保依赖线性初始化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">W = tr.Variable(tf.truncated_normal([<span class="number">700</span>, <span class="number">100</span>])</span><br><span class="line"><span class="comment"># 指明依赖，保证依赖线性初始化</span></span><br><span class="line">U = tf.Variable(W.initialized_value() * <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-08-19T09:13:00.000Z" title="8/19/2019, 5:13:00 PM">2019-08-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-08-19T09:13:00.000Z" title="8/19/2019, 5:13:00 PM">2019-08-19</time></span><span class="level-item"><a class="link-muted" href="/categories/Python/">Python</a><span> / </span><a class="link-muted" href="/categories/Python/TensorFlow/">TensorFlow</a></span><span class="level-item">5 minutes read (About 714 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Python/TensorFlow/tf_persistence.html">TensorFlow 持久化</a></h1><div class="content"><h2 id="Session-Checkpoint"><a href="#Session-Checkpoint" class="headerlink" title="Session Checkpoint"></a>Session Checkpoint</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">train</span>.<span class="title">Saver</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		var_list=<span class="literal">None</span>/<span class="built_in">list</span>/<span class="built_in">dict</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		reshape=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		sharded=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		max_to_keep=<span class="number">5</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		keep_checkpoint_every_n_hours=<span class="number">10000.0</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		name=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		restore_sequentially=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		saver_def=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		builder=<span class="literal">None</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		defer_build=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		allow_empty=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		write_version=tf.train.SaverDef.V2,</span></span></span><br><span class="line"><span class="params"><span class="function">		pad_step_number=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		save_relative_paths=<span class="literal">False</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		filename=<span class="literal">None</span></span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		self.last_checkpoints</span><br></pre></td></tr></table></figure>
<ul>
<li><p>用途：保存Session中变量（张量值），将变量名映射至张量值</p>
</li>
<li><p>参数</p>
<ul>
<li><code>var_list</code>：待保存、恢复变量，缺省所有<ul>
<li>变量需在<code>tf.train.Saver</code>实例化前创建</li>
</ul>
</li>
<li><code>reshape</code>：允许恢复并重新设定张量形状</li>
<li><code>sharded</code>：碎片化保存至多个设备</li>
<li><code>max_to_keep</code>：最多保存checkpoint数目</li>
<li><code>keep_checkpoint_every_n_hours</code>：checkpoint有效时间</li>
<li><code>restore_sequentially</code>：各设备中顺序恢复变量，可以
减少内存消耗</li>
</ul>
</li>
<li><p>成员</p>
<ul>
<li><code>last_checkpoints</code>：最近保存checkpoints</li>
</ul>
</li>
</ul>
<h3 id="保存Session"><a href="#保存Session" class="headerlink" title="保存Session"></a>保存Session</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Saver</span>.<span class="title">save</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">	sess,</span></span></span><br><span class="line"><span class="params"><span class="function">	save_path,</span></span></span><br><span class="line"><span class="params"><span class="function">	global_step=<span class="literal">None</span>/<span class="built_in">str</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	latest_filename=<span class="literal">None</span>(<span class="params"><span class="string">&quot;checkpoint&quot;</span></span>)/<span class="built_in">str</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	meta_graph_suffix=<span class="string">&quot;meta&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	write_meta_graph=<span class="literal">True</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	write_state=<span class="literal">True</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>) -&gt; <span class="built_in">str</span>(path):</span></span><br><span class="line">	<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>用途：保存Session，要求变量已初始化</p>
</li>
<li><p>参数</p>
<ul>
<li><code>global_step</code>：添加至<code>save_path</code>以区别不同步骤</li>
<li><code>latest_filename</code>：checkpoint文件名</li>
<li><code>meta_graph_suffix</code>：MetaGraphDef文件名后缀</li>
</ul>
</li>
</ul>
<h3 id="恢复Session"><a href="#恢复Session" class="headerlink" title="恢复Session"></a>恢复Session</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Saver</span>.<span class="title">restore</span>(<span class="params">sess, save_path(<span class="params"><span class="built_in">str</span></span>)</span>):</span></span><br><span class="line">	<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<ul>
<li>用途：从<code>save_path</code>指明的路径中恢复模型</li>
</ul>
<blockquote>
<ul>
<li>模型路径可以通过<code>Saver.last_checkpoints</code>属性、
  <code>tf.train.get_checkpoint_state()</code>函数获得</li>
</ul>
</blockquote>
<h3 id="tf-train-get-checkpoint-state"><a href="#tf-train-get-checkpoint-state" class="headerlink" title="tf.train.get_checkpoint_state"></a><code>tf.train.get_checkpoint_state</code></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def tf.train.get_checkpoint_state(</span><br><span class="line">	checkpoint_dir(str),</span><br><span class="line">	latest_filename=None</span><br><span class="line">):</span><br><span class="line">	pass</span><br></pre></td></tr></table></figure>
<ul>
<li>用途：获取指定checkpoint目录下checkpoint状态<ul>
<li>需要图结构已经建好、Session开启</li>
<li>恢复模型得到的变量无需初始化</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ckpt = tf.train.get_checkpoint_state(checkpoint_dir)</span><br><span class="line">saver.restore(ckpt.model_checkpoint_path)</span><br><span class="line">saver.restore(ckpt.all_model_checkpoint_paths[-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<h2 id="Graph-Saver"><a href="#Graph-Saver" class="headerlink" title="Graph Saver"></a>Graph Saver</h2><h3 id="tf-train-write-graph"><a href="#tf-train-write-graph" class="headerlink" title="tf.train.write_graph"></a><code>tf.train.write_graph</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tf</span>.<span class="title">train</span>.<span class="title">write_graph</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">	graph_or_graph_def: tf.Graph,</span></span></span><br><span class="line"><span class="params"><span class="function">	logdir: <span class="built_in">str</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	name: <span class="built_in">str</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">	as_text=<span class="literal">True</span></span></span></span><br><span class="line"><span class="params"><span class="function"></span>)</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>用途：存储图至文件中</p>
</li>
<li><p>参数</p>
<ul>
<li><code>as_text</code>：以ASCII方式写入文件</li>
</ul>
</li>
</ul>
<h2 id="Summary-Saver"><a href="#Summary-Saver" class="headerlink" title="Summary Saver"></a>Summary Saver</h2><h3 id="tf-summary-FileWriter"><a href="#tf-summary-FileWriter" class="headerlink" title="tf.summary.FileWriter"></a><code>tf.summary.FileWriter</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tf</span>.<span class="title">summary</span>.<span class="title">FileWriter</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		?path=<span class="built_in">str</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">		graph=tf.Graph</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">	# 添加<span class="title">summary</span>记录</span></span><br><span class="line"><span class="function">	<span class="title">def</span> <span class="title">add_summary</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="params"><span class="function">		summary: OP,</span></span></span><br><span class="line"><span class="params"><span class="function">		global_step</span></span></span><br><span class="line"><span class="params"><span class="function">	</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># 关闭`log`记录</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">close</span>(<span class="params">self</span>):</span></span><br><span class="line">		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>用途：创建<code>FileWriter</code>对象用于记录log</p>
<ul>
<li>存储图到<strong>文件夹</strong>中，文件名由TF自行生成</li>
<li>可通过TensorBoard组件查看生成的event log文件</li>
</ul>
</li>
<li><p>说明</p>
<ul>
<li>一般在图定义完成后、Session执行前创建<code>FileWriter</code>
对象，Session结束后关闭</li>
</ul>
</li>
</ul>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 创建自定义summary</span></span><br><span class="line"><span class="keyword">with</span> tf.name_scope(<span class="string">&quot;summaries&quot;</span>):</span><br><span class="line">	tf.summary.scalar(<span class="string">&quot;loss&quot;</span>, self.loss)</span><br><span class="line">	tf.summary.scalar(<span class="string">&quot;accuracy&quot;</span>, self.accuracy)</span><br><span class="line">	tf.summary.histogram(<span class="string">&quot;histogram loss&quot;</span>, self.loss)</span><br><span class="line">	summary_op = tf.summary.merge_all()</span><br><span class="line"></span><br><span class="line">saver = tf.train.Saver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">	sess.run(tf.global_variables_initializer())</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 从checkpoint中恢复Session</span></span><br><span class="line">	ckpt = tf.train.get_check_state(os.path.dirname(<span class="string">&quot;checkpoint_dir&quot;</span>))</span><br><span class="line">	<span class="keyword">if</span> ckpt <span class="keyword">and</span> ckpt.model_check_path:</span><br><span class="line">		saver.restore(sess, ckpt.mode_checkpoint_path)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># summary存储图</span></span><br><span class="line">	writer = tf.summary.FileWriter(<span class="string">&quot;./graphs&quot;</span>, sess.graph)</span><br><span class="line">	<span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">		loas_batch, _, summary = session.run([loss, optimizer, summary_op])</span><br><span class="line">		writer.add_summary(summary, global_step=index)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (index + <span class="number">1</span>) % <span class="number">1000</span> = <span class="number">0</span>:</span><br><span class="line">			saver.save(sess, <span class="string">&quot;checkpoint_dir&quot;</span>, index)</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 关闭`FileWriter`，生成event log文件</span></span><br><span class="line">write.close()</span><br></pre></td></tr></table></figure>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/6/">Previous</a></div><div class="pagination-next"><a href="/page/8/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/6/">6</a></li><li><a class="pagination-link is-current" href="/page/7/">7</a></li><li><a class="pagination-link" href="/page/8/">8</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/40/">40</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">36</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Heuristic/"><span class="level-start"><span class="level-item">Heuristic</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Issue/"><span class="level-start"><span class="level-item">Issue</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Problem/"><span class="level-start"><span class="level-item">Problem</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Specification/"><span class="level-start"><span class="level-item">Specification</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">34</span></span></a><ul><li><a class="level is-mobile" href="/categories/C-C/Cppref/"><span class="level-start"><span class="level-item">Cppref</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/Cstd/"><span class="level-start"><span class="level-item">Cstd</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/MPI/"><span class="level-start"><span class="level-item">MPI</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/STL/"><span class="level-start"><span class="level-item">STL</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/CS/"><span class="level-start"><span class="level-item">CS</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/CS/Character/"><span class="level-start"><span class="level-item">Character</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Parallel/"><span class="level-start"><span class="level-item">Parallel</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Program-Design/"><span class="level-start"><span class="level-item">Program Design</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Storage/"><span class="level-start"><span class="level-item">Storage</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Daily-Life/"><span class="level-start"><span class="level-item">Daily Life</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Daily-Life/Maxism/"><span class="level-start"><span class="level-item">Maxism</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">27</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/Hadoop/"><span class="level-start"><span class="level-item">Hadoop</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/SQL-DB/"><span class="level-start"><span class="level-item">SQL DB</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/Spark/"><span class="level-start"><span class="level-item">Spark</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Scala/"><span class="level-start"><span class="level-item">Scala</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">42</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Bash-Programming/"><span class="level-start"><span class="level-item">Bash Programming</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Configuration/"><span class="level-start"><span class="level-item">Configuration</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/File-System/"><span class="level-start"><span class="level-item">File System</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/IPC/"><span class="level-start"><span class="level-item">IPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Process-Schedual/"><span class="level-start"><span class="level-item">Process Schedual</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Shell/"><span class="level-start"><span class="level-item">Shell</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Tool/Vi/"><span class="level-start"><span class="level-item">Vi</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Model/"><span class="level-start"><span class="level-item">ML Model</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Model/Linear-Model/"><span class="level-start"><span class="level-item">Linear Model</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Model-Component/"><span class="level-start"><span class="level-item">Model Component</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Nolinear-Model/"><span class="level-start"><span class="level-item">Nolinear Model</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Unsupervised-Model/"><span class="level-start"><span class="level-item">Unsupervised Model</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/"><span class="level-start"><span class="level-item">ML Specification</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/"><span class="level-start"><span class="level-item">Click Through Rate</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/Recommandation-System/"><span class="level-start"><span class="level-item">Recommandation System</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Computer-Vision/"><span class="level-start"><span class="level-item">Computer Vision</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/"><span class="level-start"><span class="level-item">FinTech</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/Risk-Control/"><span class="level-start"><span class="level-item">Risk Control</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Graph-Analysis/"><span class="level-start"><span class="level-item">Graph Analysis</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Technique/"><span class="level-start"><span class="level-item">ML Technique</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Technique/Feature-Engineering/"><span class="level-start"><span class="level-item">Feature Engineering</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Technique/Neural-Network/"><span class="level-start"><span class="level-item">Neural Network</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Theory/"><span class="level-start"><span class="level-item">ML Theory</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Theory/Loss/"><span class="level-start"><span class="level-item">Loss</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Model-Enhencement/"><span class="level-start"><span class="level-item">Model Enhencement</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Algebra/"><span class="level-start"><span class="level-item">Math Algebra</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Algebra/Linear-Algebra/"><span class="level-start"><span class="level-item">Linear Algebra</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Algebra/Universal-Algebra/"><span class="level-start"><span class="level-item">Universal Algebra</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Analysis/"><span class="level-start"><span class="level-item">Math Analysis</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Analysis/Fourier-Analysis/"><span class="level-start"><span class="level-item">Fourier Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Functional-Analysis/"><span class="level-start"><span class="level-item">Functional Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Real-Analysis/"><span class="level-start"><span class="level-item">Real Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Mixin/"><span class="level-start"><span class="level-item">Math Mixin</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Mixin/Statistics/"><span class="level-start"><span class="level-item">Statistics</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Mixin/Time-Series/"><span class="level-start"><span class="level-item">Time Series</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Probability/"><span class="level-start"><span class="level-item">Probability</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">89</span></span></a><ul><li><a class="level is-mobile" href="/categories/Python/Cookbook/"><span class="level-start"><span class="level-item">Cookbook</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Jupyter/"><span class="level-start"><span class="level-item">Jupyter</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Keras/"><span class="level-start"><span class="level-item">Keras</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Matplotlib/"><span class="level-start"><span class="level-item">Matplotlib</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Numpy/"><span class="level-start"><span class="level-item">Numpy</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pandas/"><span class="level-start"><span class="level-item">Pandas</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3Ref/"><span class="level-start"><span class="level-item">Py3Ref</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3std/"><span class="level-start"><span class="level-item">Py3std</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pywin32/"><span class="level-start"><span class="level-item">Pywin32</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Readme/"><span class="level-start"><span class="level-item">Readme</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/TensorFlow/"><span class="level-start"><span class="level-item">TensorFlow</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Twists/"><span class="level-start"><span class="level-item">Twists</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/RLang/"><span class="level-start"><span class="level-item">RLang</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Rust/"><span class="level-start"><span class="level-item">Rust</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Set/"><span class="level-start"><span class="level-item">Set</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tool/Editor/"><span class="level-start"><span class="level-item">Editor</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Markup-Language/"><span class="level-start"><span class="level-item">Markup Language</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Web-Browser/"><span class="level-start"><span class="level-item">Web Browser</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/Web/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/NPM/"><span class="level-start"><span class="level-item">NPM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Proxy/"><span class="level-start"><span class="level-item">Proxy</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Thrift/"><span class="level-start"><span class="level-item">Thrift</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="UBeaRLy"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">UBeaRLy</p><p class="is-size-6 is-block">Protector of Proxy</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">392</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">93</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">522</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xyy15926" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/xyy15926"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-04T15:07:54.896Z">2021-08-04</time></p><p class="title"><a href="/uncategorized/README.html"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T07:46:51.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/hexo_config.html">Hexo 建站</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T02:32:45.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/config.html">NPM 总述</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-02T08:11:11.000Z">2021-08-02</time></p><p class="title"><a href="/Python/Py3std/internet_data.html">互联网数据</a></p><p class="categories"><a href="/categories/Python/">Python</a> / <a href="/categories/Python/Py3std/">Py3std</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-29T13:55:00.000Z">2021-07-29</time></p><p class="title"><a href="/Linux/Shell/sh_apps.html">Shell 应用程序</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Shell/">Shell</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5385776267343559" data-ad-slot="6371777973" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2021 UBeaRLy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>