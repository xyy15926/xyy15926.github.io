<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Rust 自定义数据类型 - Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UBeaRLy&#039;s Proxy"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UBeaRLy&#039;s Proxy"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Rust自定义数据类型"><meta property="og:type" content="blog"><meta property="og:title" content="Rust 自定义数据类型"><meta property="og:url" content="https://xyy15926.github.io/Rust/struct_enum.html"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="Rust自定义数据类型"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://xyy15926.github.io/img/og_image.png"><meta property="article:published_time" content="2019-03-21T09:27:37.000Z"><meta property="article:modified_time" content="2019-02-17T03:57:08.000Z"><meta property="article:author" content="UBeaRLy"><meta property="article:tag" content="Rust"><meta property="article:tag" content="Typedef"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xyy15926.github.io/Rust/struct_enum.html"},"headline":"Rust 自定义数据类型","image":["https://xyy15926.github.io/img/og_image.png"],"datePublished":"2019-03-21T09:27:37.000Z","dateModified":"2019-02-17T03:57:08.000Z","author":{"@type":"Person","name":"UBeaRLy"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"https://xyy15926.github.io/img/logo.svg"}},"description":"Rust自定义数据类型"}</script><link rel="canonical" href="https://xyy15926.github.io/Rust/struct_enum.html"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/darcula.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-5385776267343559" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Visit on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-03-21T09:27:37.000Z" title="3/21/2019, 5:27:37 PM">2019-03-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-02-17T03:57:08.000Z" title="2/17/2019, 11:57:08 AM">2019-02-17</time></span><span class="level-item"><a class="link-muted" href="/categories/Rust/">Rust</a></span><span class="level-item">35 minutes read (About 5224 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Rust 自定义数据类型</h1><div class="content"><h2 id="结构体struct"><a href="#结构体struct" class="headerlink" title="结构体struct"></a>结构体struct</h2><p>rust不允许只将特定字段标记为可变（很正常，因为结构体应当
作为一个整体考虑）</p>
<ul>
<li>定义结构体时字段不能添加<code>mut</code></li>
<li>声明结构体时，语法上也难以做到，字段不是单独声明</li>
</ul>
<blockquote>
<p>   结构体中若有字段是引用类型，需要添加生命周期</p>
</blockquote>
<h3 id="普通结构体"><a href="#普通结构体" class="headerlink" title="普通结构体"></a>普通结构体</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stct</span></span>&#123;</span><br><span class="line">	field1: <span class="built_in">i32</span>,</span><br><span class="line">	field2: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> field1 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> stct=&#123;</span><br><span class="line">	field1,</span><br><span class="line">	field2: <span class="built_in">String</span>::from(<span class="string">&quot;fy&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//变量字段同名时字段初始化简略写法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> struct1 = stct&#123;</span><br><span class="line">	field1: <span class="number">1</span>,</span><br><span class="line">	..struct2</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//结构体更新语法</span></span><br></pre></td></tr></table></figure>
<h3 id="元组结构体"><a href="#元组结构体" class="headerlink" title="元组结构体"></a>元组结构体</h3><p>结构体名称提供的含义，但只有字段类型没有字段名，用于命名
元组、指定类型，区别于其他相同（结构）的元组</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tuple_stct</span></span>=(<span class="built_in">i32</span>, <span class="built_in">i32</span>, <span class="built_in">i32</span>)</span><br></pre></td></tr></table></figure>
<h3 id="类单元结构体unit-like-struct"><a href="#类单元结构体unit-like-struct" class="headerlink" title="类单元结构体unit-like struct"></a>类单元结构体unit-like struct</h3><p>不定义任何字段，类似于<code>()</code>（<code>()</code>一般用于泛型中占位，表示
当前类型为空，比如<code>T</code>表示返回值泛型参数，无返回值就可以使用
<code>()</code>代替，因为Rust中类似于<code>typedef</code>用于自定义类型），常用于
在某个类型上实现trait，但不需要在 类型内存储数据时发挥作用</p>
<h2 id="枚举enum"><a href="#枚举enum" class="headerlink" title="枚举enum"></a>枚举enum</h2><p>rust枚举更像C语言中<code>enum</code>+<code>struct</code></p>
<ul>
<li><code>enum</code>：定义了新的枚举类型，取值范围有限</li>
<li><code>struct</code>：枚举成员可以关联数据类型，且可以定义方法</li>
</ul>
<h3 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IpArr</span></span>&#123;</span><br><span class="line">	V4,</span><br><span class="line">	V6,</span><br><span class="line">&#125;</span><br><span class="line">	<span class="comment">//基础版本</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">IpArr</span></span>&#123;</span><br><span class="line">	V4(<span class="built_in">u8</span>, <span class="built_in">u8</span>, <span class="built_in">u8</span>, <span class="built_in">u8</span>&#125;,</span><br><span class="line">	V6(<span class="built_in">String</span>),</span><br><span class="line">&#125;</span><br><span class="line">	<span class="comment">//附加数据版本</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span>&#123;</span><br><span class="line">	Quit,</span><br><span class="line">	Move&#123;x: <span class="built_in">i32</span>, y:<span class="built_in">i32</span>&#125;,</span><br><span class="line">	Write(<span class="built_in">String</span>),</span><br><span class="line">	ChangeColor(<span class="built_in">i32</span>, <span class="built_in">i32</span>, <span class="built_in">i32</span>),</span><br><span class="line">&#125;</span><br><span class="line">	<span class="comment">//含有匿名结构体版本</span></span><br></pre></td></tr></table></figure>
<h3 id="标准库中的枚举"><a href="#标准库中的枚举" class="headerlink" title="标准库中的枚举"></a>标准库中的枚举</h3><h4 id="处理null值"><a href="#处理null值" class="headerlink" title="处理null值"></a>处理<code>null</code>值</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option</span></span>&lt;T&gt;&#123;</span><br><span class="line">	<span class="literal">Some</span>&lt;T&gt;,</span><br><span class="line">	<span class="literal">None</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Option</code>被包含在prelude中，包括其成员，rust标准库中唯一
支持创建任何类型枚举值的枚举类型。rust不允许像有效的<code>T</code>类型
数据一样处理<code>Option&lt;T&gt;</code>类型数据，要求在使用之前处理为<code>None</code>
的情况，此即能够保证在可能为空的值会被处理</p>
<h4 id="处理潜在panic"><a href="#处理潜在panic" class="headerlink" title="处理潜在panic"></a>处理潜在<code>panic</code></h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Result</span></span>&lt;T, E&gt;&#123;</span><br><span class="line">	<span class="literal">Ok</span>&lt;T&gt;,</span><br><span class="line">	<span class="literal">Err</span>&lt;E&gt;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="方法、关联函数"><a href="#方法、关联函数" class="headerlink" title="方法、关联函数"></a>方法、关联函数</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Message&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>() -&gt; Message&#123;</span><br><span class="line">	&#125;</span><br><span class="line">		<span class="comment">//关联函数associated functions，没有`self`作为参数</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fn1</span></span>(&amp;<span class="keyword">self</span>) -&gt; ret_type&#123;</span><br><span class="line">	&#125;</span><br><span class="line">		<span class="comment">//在结构体（枚举、trait对像）的上下文中定义</span></span><br><span class="line">		<span class="comment">//第一个参数总是`self`，代表调用方法的结构体实例</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fn2</span></span>(<span class="keyword">mut</span> <span class="keyword">self</span>) -&gt; ret_type&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法-Methods"><a href="#方法-Methods" class="headerlink" title="方法 Methods"></a>方法 Methods</h3><ul>
<li><p>定义方法的好处主要在于组织性，将某类型实例能做的事均放入
<code>impl</code>块</p>
</li>
<li><p>方法签名中<code>self</code>会由rust根据<code>impl</code>关键字后的“替换”为
相应类型（运行过程中是当前实例）</p>
</li>
<li><p>方法可以获取<code>self</code>（当前实例）所有权，常用于将<code>self</code>转换
为其他实例，防止调用者转换之后仍使用原始实例</p>
</li>
<li><p>方法是rust中少数几个可以“自动引用和解引用”的地方，因为
方法中<code>self</code>类型是明确的（调用者类型也明确），rust可以
根据方法签名自动为对象添加<code>&amp;</code>、<code>&amp;mut</code>或<code>*</code>以适应方法签名，
所以rust调用方法只有<code>.</code>，没有<code>-&gt;</code></p>
</li>
</ul>
<h3 id="关联函数-Associated-Functions"><a href="#关联函数-Associated-Functions" class="headerlink" title="关联函数 Associated Functions"></a>关联函数 Associated Functions</h3><p>与结构体相关联，不作用于一个结构体实例，常被用于返回一个
结构体新实例的构造函数</p>
<h2 id="Trait"><a href="#Trait" class="headerlink" title="Trait"></a>Trait</h2><p>将方法（关联函数）签名（可以有默认实现）组合起来、定义实现
某些目的所必需的行为的集合</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">Summarizable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 无默认实现</span></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">author_summary</span></span>() -&gt; <span class="built_in">String</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 有默认实现</span></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">summary</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span>&#123;</span><br><span class="line">		<span class="built_in">String</span>::from(<span class="string">&quot;Read more...&#123;&#125;&quot;</span>, <span class="keyword">self</span>.author_summary())</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义trait</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Summarizable <span class="keyword">for</span> Message&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">author_summary</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">summary</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">String</span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//为类型实现trait，之后就可以和普通非trait方法一样调用</span></span><br></pre></td></tr></table></figure>
<h3 id="默认实现"><a href="#默认实现" class="headerlink" title="默认实现"></a>默认实现</h3><ul>
<li><p>trait中有默认实现的方法可以不重载，实现trait就可直接
调用，没有默认实现的方法则需要全部实现</p>
</li>
<li><p>默认实现重载之后不可能被调用</p>
</li>
<li><p>默认实现可以调用<strong>同trait</strong>中的其他方法，包括没有默认
实现的方法，如此trait可以实现很多功能而只需要实现少部分</p>
<ul>
<li><p>同trait：trait之间本就应该保持独立，这个是trait的
意义</p>
</li>
<li><p>因为实现trait一定要实现所有没有默认实现的方法，所以
默认实现总是“可以调用”</p>
</li>
</ul>
</li>
</ul>
<h3 id="孤儿规则-Orphan-Rule"><a href="#孤儿规则-Orphan-Rule" class="headerlink" title="孤儿规则 Orphan Rule"></a>孤儿规则 Orphan Rule</h3><p>orphan rule：父类型不存在</p>
<p>仅<strong>trait</strong>或<strong>类型</strong>位于（之一）本地crate才能实现trait，
如果没有此限制，可能出现两个crate同时对相同类型实现同一trait
，出现冲突</p>
<h3 id="Box-lt-trait-gt-Trait对像"><a href="#Box-lt-trait-gt-Trait对像" class="headerlink" title="Box&lt;trait&gt; Trait对像"></a><code>Box&lt;trait&gt;</code> Trait对像</h3><p>trait对像指向一个实现了指定trait的类型实例，Rust类型系统在
编译时会确保，任何在此上下文中使用的值会实现其trait对像的
trait，如此无需在编译时知晓所有可能类型。</p>
<h4 id="Trait对象、泛型Trait-Bound对比"><a href="#Trait对象、泛型Trait-Bound对比" class="headerlink" title="Trait对象、泛型Trait Bound对比"></a>Trait对象、泛型Trait Bound对比</h4><ul>
<li><p>trait对像在运行时替代多种具体类型</p>
<ul>
<li>编译时都是同质的<code>Box&lt;trait&gt;</code>类型</li>
<li>只关心值反映的信息而不是其具体类型，类似于动态语言中
<strong>鸭子类型</strong></li>
<li>编译器无法知晓所有可能用于trait对象的类型，因此也
不知道应该调用哪个类型的哪个方法，因此Rust必须使用
<strong>动态</strong>分发</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">Draw</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">draw</span></span>(&amp;<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Screen</span></span>&#123;</span><br><span class="line">	<span class="keyword">pub</span> components: <span class="built_in">Vec</span>&lt;<span class="built_in">Box</span>&lt;Draw&gt;&gt;,</span><br><span class="line">		<span class="comment">//`Box&lt;Draw&gt;`就是trait对像，可以代替任何实现了</span></span><br><span class="line">		<span class="comment">//`Draw`trait的值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Screen&#123;</span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">run</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="keyword">for</span> component <span class="keyword">in</span> <span class="keyword">self</span>.components.iter()&#123;</span><br><span class="line">			component.draw();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Button</span></span>&#123;</span><br><span class="line">	<span class="keyword">pub</span> width: <span class="built_in">u32</span>,</span><br><span class="line">	<span class="keyword">pub</span> height: <span class="built_in">u32</span>,</span><br><span class="line">	<span class="keyword">pub</span> label: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Draw <span class="keyword">for</span> Button&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">Draw</span>&#123;</span></span><br><span class="line"><span class="function">	&#125;</span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 外部crate使用时</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">crate</span> rust::gui;</span><br><span class="line"><span class="keyword">use</span> rust_gui::&#123;Screen, Button, Draw&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SelectBox</span></span>&#123;</span><br><span class="line">	width: <span class="built_in">u32</span>,</span><br><span class="line">	height: <span class="built_in">u32</span>,</span><br><span class="line">	options: <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;,</span><br><span class="line">&#125;</span><br><span class="line">	<span class="comment">//此类型对于`Screen`是未知的，但是`components`中仍然能够</span></span><br><span class="line">	<span class="comment">//包含此类型</span></span><br><span class="line"><span class="keyword">impl</span> Draw <span class="keyword">for</span> SelectBox&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">draw</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> screen = Screen&#123;</span><br><span class="line">		components: <span class="built_in">vec!</span>[</span><br><span class="line">			<span class="built_in">Box</span>::new(SelectBox&#123;</span><br><span class="line">				width: <span class="number">75</span>,</span><br><span class="line">				height: <span class="number">10</span>,</span><br><span class="line">				option: <span class="built_in">vec!</span>[</span><br><span class="line">					<span class="built_in">String</span>::from(<span class="string">&quot;yes&quot;</span>),</span><br><span class="line">					<span class="built_in">String</span>::from(<span class="string">&quot;maybe&quot;</span>),</span><br><span class="line">				],</span><br><span class="line">			&#125;),</span><br><span class="line">			<span class="built_in">Box</span>::new(Button&#123;</span><br><span class="line">				width: <span class="number">50</span>,</span><br><span class="line">				height: <span class="number">10</span>,</span><br><span class="line">				label: <span class="built_in">String</span>::from(<span class="string">&quot;OK&quot;</span>),</span><br><span class="line">			&#125;),</span><br><span class="line">		],</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	screen.run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>trait bound泛型类型参数结构体在编译时单态化</p>
<ul>
<li>一次只能替代一个具体类型，多个类型之间不同质</li>
<li>单态化产生的代码进行<strong>静态分发</strong></li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Screen</span></span>&lt;T: Draw&gt;&#123;</span><br><span class="line">	<span class="keyword">pub</span> components: <span class="built_in">Vec</span>&lt;T&gt;,</span><br><span class="line">		<span class="comment">//trait bound泛型参数`T`只能替代一种类型</span></span><br><span class="line">		<span class="comment">//不同的实现`Draw`trait类型不能放在同一个vector中</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; Screen&lt;T&gt;</span><br><span class="line">	<span class="keyword">where</span> T: Draw&#123;</span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">run</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="keyword">for</span> component <span class="keyword">in</span> <span class="keyword">self</span>.components.iter()&#123;</span><br><span class="line">			component.draw();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<ul>
<li><p>鸭子类型：如果它走起来像一只鸭子，叫起来像一只鸭子，那么
  它就是一直鸭子</p>
</li>
<li><p>静态分发：编译器知晓调用何种方法</p>
</li>
<li>动态分发：编译器在编译时不知晓调用何种方法，生成在运行时
  确定调用某种方法的代码。动态分发阻止编译器有选择的内联
  方法代码，这会禁用部分优化，但获得了额外的灵活性</li>
</ul>
</blockquote>
<h4 id="对象安全"><a href="#对象安全" class="headerlink" title="对象安全"></a>对象安全</h4><p>trait对象要求对象安全，只有<strong>对象安全</strong>的trait才能组成trait
对象，这有一些复杂的规则，但是实践中只涉及</p>
<ul>
<li>返回值类型不为<code>Self</code>：如果trait中的方法返回<code>Self</code>类型，
而使用trait对象后就不再知晓具体的类型，那方法就不可能
使用已经忘却的原始具体类型（<code>Clone</code>trait不是对象安全）</li>
<li>方法没有任何泛型类型参数：具体类型实现trait时会放入具体
类型单态化，但是使用trait对象时无法得知具体类型</li>
</ul>
<h3 id="状态模式（面向对象设计）"><a href="#状态模式（面向对象设计）" class="headerlink" title="状态模式（面向对象设计）"></a>状态模式（面向对象设计）</h3><ul>
<li>值某些内部状态，其行为随着内部状态而改变</li>
<li>内部状态由一系列集成了共享功能的对象表现，每个状态对象
负责自身行为和需要转变为另一个状态时的规则</li>
<li>值对不同状态的行为、何时状态转移不知情，需求改变时无需
改变值持有的状态、值实现代码，只需更新某个状态对象代码
或者是增加更多状态对象</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">struct</span> <span class="title">Post</span></span>&#123;</span><br><span class="line">	state: <span class="built_in">Option</span>&lt;<span class="built_in">Box</span>&lt;State&gt;&gt;,</span><br><span class="line">	content: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Post&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">add_text</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, text: &amp;<span class="built_in">str</span>)&#123;</span><br><span class="line">		<span class="keyword">self</span>.content.push_str(&amp;<span class="built_in">str</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">request_review</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(s) = <span class="keyword">self</span>.state.take()&#123;</span><br><span class="line">			<span class="comment">//`Option&lt;T&gt;.take()`返回值，并设置为`None`</span></span><br><span class="line">			<span class="keyword">self</span>.state = <span class="literal">Some</span>(s.request_review())</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">approve</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(s) = <span class="keyword">self</span>.state.take()&#123;</span><br><span class="line">			<span class="keyword">self</span>.state = <span class="literal">Some</span>(s.approve())</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">content</span></span>(&amp;<span class="keyword">self</span>) -&gt; &amp;<span class="built_in">str</span>&#123;</span><br><span class="line">		<span class="keyword">self</span>.state.as_ref().unwrap().content(&amp;<span class="keyword">self</span>)</span><br><span class="line">			<span class="comment">//`Option&lt;T&gt;.as_ref()`返回`Option&lt;&amp;T&gt;`，因为参数</span></span><br><span class="line">			<span class="comment">//是`&amp;self`，只能获取不可变引用</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">State</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">request_review</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;;</span><br><span class="line">		<span class="comment">//`self: Box&lt;Self&gt;`意味着这个方法调用只对`Self`</span></span><br><span class="line">		<span class="comment">//类型的`Box`指针有效，这里`Self`表示值类型，因为</span></span><br><span class="line">		<span class="comment">//值的类型到struct实现trait的时候才能确定，编译时</span></span><br><span class="line">		<span class="comment">//应该会替换成具体类型</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//这个方法会获取对象的所有权（消费）</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//返回值`Box&lt;State&gt;`是trait对象</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">approve</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">content</span></span>&lt;<span class="symbol">&#x27;a</span>&gt;(&amp;<span class="keyword">self</span>, post:&amp;<span class="symbol">&#x27;a</span> Post) -&gt; &amp;<span class="symbol">&#x27;a</span> <span class="built_in">str</span>&#123;</span><br><span class="line">		<span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Draft</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> State <span class="keyword">for</span> Draft&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">request_review</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;&#123;</span><br><span class="line">		<span class="built_in">Box</span>::new(PendingReview&#123;&#125;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">approve</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;&#123;</span><br><span class="line">		<span class="keyword">self</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PendingReview</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> State <span class="keyword">for</span> PendingReview&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">request_review</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;&#123;</span><br><span class="line">		<span class="keyword">self</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">approve</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;&#123;</span><br><span class="line">		<span class="built_in">Box</span>::new(Published&#123;&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Published</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> State <span class="keyword">for</span> Published&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">request_review</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;&#123;</span><br><span class="line">		<span class="keyword">self</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">approve</span></span>(<span class="keyword">self</span>: <span class="built_in">Box</span>&lt;<span class="keyword">Self</span>&gt;) -&gt; <span class="built_in">Box</span>&lt;State&gt;&#123;</span><br><span class="line">		<span class="keyword">self</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">content</span></span>&lt;<span class="symbol">&#x27;a</span>&gt;(&amp;<span class="keyword">self</span> , post:&amp;<span class="symbol">&#x27;a</span> Post) -&gt; &amp;<span class="symbol">&#x27;a</span> <span class="built_in">str</span>&#123;</span><br><span class="line">		&amp;post.content</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="高级trait"><a href="#高级trait" class="headerlink" title="高级trait"></a>高级trait</h2><h3 id="Associated-Type"><a href="#Associated-Type" class="headerlink" title="Associated Type"></a>Associated Type</h3><p>关联类型：将类型占位符和trait相关联的方式</p>
<ul>
<li>可在trait方法中使用这些占位符类型</li>
<li>实现trait时需要指定为具体类型</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="class"><span class="keyword">trait</span> <span class="title">Iterator</span></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">type</span> <span class="title">Item</span></span>;</span><br><span class="line">		<span class="comment">//关联类型`Item`，实现时需要指定具体类型</span></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">next</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) -&gt; <span class="built_in">Option</span>&lt;Self::Item&gt;;</span><br><span class="line">		<span class="comment">//trait方法（签名）中使用关联类型</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关联类型可以看作时trait中“泛型”（弱化版）。只能实现一次
trait，因此关联类型也只能指定一次，保证了一定的抽象</p>
<h3 id="默认泛型类型参数"><a href="#默认泛型类型参数" class="headerlink" title="默认泛型类型参数"></a>默认泛型类型参数</h3><p>使用泛型类型参数时，可为泛型指定默认类型
<code>&lt;PlaceholderType = ConcreteType&gt;</code></p>
<ul>
<li>扩展类型而不破坏现有代码（普通trait改为泛型trait不需要
改变之前实现trait的代码）</li>
<li>在特殊情况下自定义trait及其中的方法</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::ops::Add;</span><br><span class="line"><span class="meta">#[derive(Debug, PartialEq)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">	x: <span class="built_in">i32</span>,</span><br><span class="line">	y: <span class="built_in">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Add <span class="keyword">for</span> Point&#123;</span><br><span class="line">	<span class="comment">//`Add`是`+`运算符对应的trait</span></span><br><span class="line">	<span class="comment">//`Add`有默认类型参数，此时未指定泛型参数的具体类型，</span></span><br><span class="line">	<span class="comment">//`RHS`将是默认类型</span></span><br><span class="line">	<span class="class"><span class="keyword">type</span> <span class="title">Output</span></span> = Point;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">add</span></span>(<span class="keyword">self</span>, other: Point) -&gt; Point&#123;</span><br><span class="line">		Point&#123;</span><br><span class="line">			x: <span class="keyword">self</span>.x + other.x,</span><br><span class="line">			y: <span class="keyword">self</span>.x + other.y,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Add</span></span>&lt;RHS=<span class="keyword">Self</span>&gt;&#123;</span><br><span class="line">	<span class="comment">//`Add`trait定义，包含有泛型参数，但是在实现该trait之前</span></span><br><span class="line">	<span class="comment">//应该必须要为泛型指定具体类型</span></span><br><span class="line">	<span class="comment">//`RHS=Self`就是*默认类型参数*语法，泛型参数`RHS`默认为</span></span><br><span class="line">	<span class="comment">//`Self`类型（`+`左值类型）</span></span><br><span class="line">	<span class="comment">//RHS：right hand side</span></span><br><span class="line">	<span class="class"><span class="keyword">type</span> <span class="title">Output</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">add</span></span>(<span class="keyword">self</span>, rhs: RHS) -&gt; <span class="keyword">Self</span>:Output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="运算符重载"><a href="#运算符重载" class="headerlink" title="运算符重载"></a>运算符重载</h3><p>Rust不允许<strong>创建</strong>自定义运算符、重载<strong>任意</strong>运算符，不过
<code>std::ops</code>中的运算符、相应的trait可以通过实现相关trait重载</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::ops::Add;</span><br><span class="line"><span class="meta">#[derive(Debug, PartialEq)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Millimeters</span></span>(<span class="built_in">u32</span>);</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Meters</span></span>(<span class="built_in">u32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Add&lt;Meters&gt; <span class="keyword">for</span> Millimeters&#123;</span><br><span class="line">	<span class="comment">//`Add`trait中`RHS`不是默认类型`Self`，`Add&lt;Meters&gt;`</span></span><br><span class="line">	<span class="comment">//设置`RHS`为`Meters`</span></span><br><span class="line">	<span class="comment">//此运算符重载允许`Millmeters`类型和`Meters`类型能够</span></span><br><span class="line">	<span class="comment">//直接相加</span></span><br><span class="line">	<span class="class"><span class="keyword">type</span> <span class="title">Output</span></span> = Millimeters;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">add</span></span>(<span class="keyword">self</span>, other: Meters) -&gt; Millimeters&#123;</span><br><span class="line">		Millimters(<span class="keyword">self</span>.<span class="number">0</span> + (other.<span class="number">0</span> * <span class="number">1000</span>))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="消歧义"><a href="#消歧义" class="headerlink" title="消歧义"></a>消歧义</h3><p>Rust无法避免两个trait具有相同名称的方法，也无法阻止某类型
同时实现两个这样的trait（或者是类型已经实现同名方法），此时
需要明确指定使用哪个方法</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Pilot</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fly</span></span>(&amp;<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Wizard</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fly</span></span>(&amp;<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Human</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> Pilot <span class="keyword">for</span> Human&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fly</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;this is your captain speaking&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Wizard <span class="keyword">for</span> Human&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fly</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;up!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Human&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fly</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;waving arms furiously!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> person = Human;</span><br><span class="line">	Pilot::fly(&amp;person);</span><br><span class="line">		<span class="comment">//`Pilot`trait中方法的消歧义写法</span></span><br><span class="line">	Wizard::fly(&amp;person);</span><br><span class="line">	person.fly();</span><br><span class="line">		<span class="comment">//默认调用直接实现在**类型**上的方法</span></span><br><span class="line">	Person::fly(&amp;person);</span><br><span class="line">		<span class="comment">//`Person`类型中方法消歧义写法，一般不使用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Fully-Qualified-Syntax"><a href="#Fully-Qualified-Syntax" class="headerlink" title="Fully Qualified Syntax"></a>Fully Qualified Syntax</h3><p>方法获取<code>self</code>参数</p>
<ul>
<li>不同类型、同方法名，Rust根据<code>self</code>类型可以判断调用何函数</li>
<li>同类型、同方法名，消歧义语法可以指定调用何函数</li>
</ul>
<p>而对于关联函数，没有<code>self</code>参数，某类型有同名的两个关联函数
时，无法使用消歧义语法指定调用何函数，需要使用完全限定语法
<code>&lt;Type as Trait&gt;::function(receiver_if_method), next_args, ...)</code></p>
<p>当然，完全限定语法可以用于所有trait方法、关联函数场合，其中
<code>recevier_if_method</code>即表示方法中<code>self</code>参数</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">trati Animal&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">baby_name</span></span>() -&gt; <span class="built_in">String</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Dog</span></span>;</span><br><span class="line"><span class="keyword">impl</span> Dog&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">baby_name</span></span>() -&gt; <span class="built_in">String</span>&#123;</span><br><span class="line">		<span class="built_in">String</span>::from(<span class="string">&quot;Spot&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Animal <span class="keyword">for</span> Dog&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">baby_name</span></span>() -&gt; <span class="built_in">String</span>&#123;</span><br><span class="line">		<span class="built_in">String</span>::from(<span class="string">&quot;puppy&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;A baby dog is called a &#123;&#125;&quot;</span>, Dog::baby_name());</span><br><span class="line">		<span class="comment">//调用`Dog`的关联函数</span></span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;A baby dog-animal is called a &#123;&#125;&quot;</span>, &lt;Dog <span class="keyword">as</span> Animal&gt;::baby_name());</span><br><span class="line">		<span class="comment">//完全限定语法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Super-Trait"><a href="#Super-Trait" class="headerlink" title="Super Trait"></a>Super Trait</h3><p>有时某个trait可能需要使用另一个trait的功能，要求某类型实现
该trait之前实现被依赖的trait，此所需的trait就是超（父）trait</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">OutlinePrint</span></span>: fmt::Display&#123;</span><br><span class="line">	<span class="comment">//`OutlinePrint`trait依赖于`fmt::Display`trait</span></span><br><span class="line">	<span class="comment">//在实现`OutlinePrint`之前，需要实现`fmt::Display`</span></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">outline_print</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">		<span class="keyword">let</span> output = <span class="keyword">self</span>.to_string();</span><br><span class="line">		<span class="keyword">let</span> len = output.len();</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, <span class="string">&quot;*&quot;</span>.repeat(len + <span class="number">4</span>));</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;* &#123;&#125; *&quot;</span>, output);</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, <span class="string">&quot;*&quot;</span>.repeat(len+<span class="number">4</span>));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">	x: <span class="built_in">i32</span>,</span><br><span class="line">	y: <span class="built_in">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> fmt::Display <span class="keyword">for</span> Point&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fmt</span></span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> fmt::Formatter) -&gt; fmt::<span class="built_in">Result</span>&#123;</span><br><span class="line">		<span class="built_in">write!</span>(f, <span class="string">&quot;(&#123;&#125;, &#123;&#125;)&quot;</span>, <span class="keyword">self</span>,x, <span class="keyword">self</span>.y)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> OutlinePrint <span class="keyword">for</span> Point&#123;&#125;</span><br><span class="line">	<span class="comment">//`OutlinePrint`中所有方法均有默认实现</span></span><br></pre></td></tr></table></figure>
<h2 id="高级类型"><a href="#高级类型" class="headerlink" title="高级类型"></a>高级类型</h2><h3 id="Newtype-Pattern"><a href="#Newtype-Pattern" class="headerlink" title="Newtype Pattern"></a>Newtype Pattern</h3><p>孤儿规则限制了只有trait、类型其中只有位于当前crate时，才能对
类型实现trait，使用newtype模式可以“绕过”该限制，即创建新的
元组结构体类型，其中只包含该类型一个成员，此时封装类型对于
crate是本地的。newtype概念源自于Haskell，此模式没有运行时
性能损失，封装类型在编译器时已经省略了</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fmt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Wrapper</span></span>(<span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt;);</span><br><span class="line"><span class="keyword">impl</span> fmt::Display <span class="keyword">for</span> Wrapper&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">fmt</span></span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> fmt:Formatter) -&gt; fmt:<span class="built_in">Result</span>&#123;</span><br><span class="line">		<span class="built_in">write!</span>(f, <span class="string">&quot;[&#123;&#125;]&quot;</span>, <span class="keyword">self</span>.<span class="number">0</span>.join(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> w = Wrapper(<span class="built_in">vec!</span>[<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>), <span class="built_in">String</span>::from(<span class="string">&quot;world&quot;</span>)]);</span><br><span class="line">	prinlnt!(<span class="string">&quot;w = &#123;&#125;&quot;</span>, w);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是Newtype模式中<code>Wrapper</code>是一个新类型，其上没有定义方法，
需要手动实现<code>self.0</code>的所有方法。或者，为<code>Wrapper</code>实现
<code>Deref</code>trait，并返回<code>self.0</code>，但是此方式下<code>Wrapper</code>会具有
所有<code>self.0</code>的所有方法，如果需要限制封装类型行为，只能自行
实现所需的方法。</p>
<h3 id="Type创建类型别名"><a href="#Type创建类型别名" class="headerlink" title="Type创建类型别名"></a><code>Type</code>创建类型别名</h3><p><code>type</code>关键字可以给予现有类型别名</p>
<ul>
<li><p><code>type</code>不是创建新、单独类型，而是创建别名，而newtype模式
则是真正创建了新类型，也因此无法像newtype模式一样进行
类型检查</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">type</span> <span class="title">Kilometers</span></span> = <span class="built_in">i32</span>;</span><br><span class="line">	<span class="comment">//`type`不是创建新、单独的类型，而是赋予别名，两个类型</span></span><br><span class="line">	<span class="comment">//将得到相同的对待</span></span><br><span class="line"><span class="keyword">let</span> x: <span class="built_in">i32</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> y: Kilometers = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;x + y = &#123;&#125;&quot;</span>, x + y);</span><br><span class="line">	<span class="comment">//`Kilometers`类型和`i32`类型完全相同，直接进行运算</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>类型别名主要用途是避免重复</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">type</span> <span class="title">Thunk</span></span> = <span class="built_in">Box</span>::&lt;<span class="built_in">Fn</span>() + <span class="built_in">Send</span> + `<span class="keyword">static</span>&gt;;</span><br><span class="line"><span class="keyword">let</span> f: Thunk = <span class="built_in">Box</span>::new(|| <span class="built_in">println!</span>(<span class="string">&quot;hi&quot;</span>));</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">takes_long_type</span></span>(f: Thunk)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">returns_long_type</span></span>() -&gt; Thunk&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Never-Type"><a href="#Never-Type" class="headerlink" title="Never Type"></a>Never Type</h3><p>Rust中有一个特殊的类型<code>!</code>，被称为empty type（never type)</p>
<ul>
<li><code>!</code>的正式说法：never type可以强转为其他任何类型</li>
<li>无法被创建</li>
<li>用于发散函数（diverging functions，从不返回的函数）的
返回值<h1 id="todo-这个和无返回值函数有何区别"><a href="#todo-这个和无返回值函数有何区别" class="headerlink" title="todo 这个和无返回值函数有何区别"></a>todo 这个和无返回值函数有何区别</h1></li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> guess: <span class="built_in">u32</span> = metch guess.trim().parse()&#123;</span><br><span class="line">	<span class="literal">Ok</span>(num) =&gt; num,</span><br><span class="line">	<span class="literal">Err</span>(_) =&gt; <span class="keyword">continue</span>,</span><br><span class="line">		<span class="comment">//`continue`的值即为`!`，`match`分支的返回值必须相同</span></span><br><span class="line">		<span class="comment">//而`!`没有值，因此确定`match`的返回值类型为`u32`</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; <span class="built_in">Option</span>&lt;T&gt;&#123;</span><br><span class="line">	<span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">unwrap</span></span>(<span class="keyword">self</span>) -&gt; T&#123;</span><br><span class="line">		<span class="comment">// `Option::unwrap`定义</span></span><br><span class="line">		<span class="keyword">match</span> <span class="keyword">self</span>&#123;</span><br><span class="line">			<span class="literal">Some</span>(val) =&gt; val, </span><br><span class="line">			<span class="literal">None</span> =&gt; <span class="built_in">panic!</span>(<span class="string">&quot;called `Option::unwrap()` on a `None` value&quot;</span>),</span><br><span class="line">				<span class="comment">// `panic!`是`!`类型，不返回值而是终止程序</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;forever&quot;</span>);</span><br><span class="line"><span class="keyword">loop</span>&#123;</span><br><span class="line">	<span class="comment">// 循环永不结束，表达式值是`!`</span></span><br><span class="line">	<span class="comment">// 如果加上`break`就不再如此</span></span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;for ever&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Dynamically-Sized-Types"><a href="#Dynamically-Sized-Types" class="headerlink" title="Dynamically Sized Types"></a>Dynamically Sized Types</h3><p>动态大小类型：“DST”或者“uniszed type”，这些类型允许处理
在运行时才知道大小的类型。Rust需要知道特定类型值需要分配的
内存空间，同类型的值<strong>必须</strong>使用相同数量的内存，因此必须
<strong>将动态大小类型的值至于某种指针之后</strong>（此即动态大小类型的
黄金规则），并且使用某些额外的元信息存储动态信息的大小。</p>
<p><code>str</code>就是动态大小类型，<code>&amp;str</code>则是两个值：<code>str</code>的地址和长度，
这样<code>&amp;str</code>就有了一个在编译时可以知道的大小，并且<code>str</code>可以和
所有类型的指针结合<code>Box&lt;str&gt;</code>或<code>Rc&lt;str&gt;</code>。同样的，trait也是
动态大小类型，为了使用trait对象，必须将将其放入指针之后。</p>
<h4 id="Sized-trait"><a href="#Sized-trait" class="headerlink" title="Sized trait"></a><code>Sized</code> trait</h4><p>Rust自动为编译器在编译时就知道大小的类型实现<code>Sized</code> trait，
且Rust隐式的为每个泛型增加了<code>Sized</code> bound</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">generic</span></span>&lt;T&gt;(t: T)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">generic</span></span>&lt;T: <span class="built_in">Sized</span>&gt;(t: T)&#123;</span><br><span class="line">	<span class="comment">//实际上按照此函数头处理</span></span><br><span class="line">	<span class="comment">//即默认情况下，泛型参数不能是DST</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">generic</span></span>&lt;T: ?<span class="built_in">Sized</span>&gt;(t: &amp;T)&#123;</span><br><span class="line">	<span class="comment">//`?Sized`是特殊的语法，只能用于`Sized` trait不能用于</span></span><br><span class="line">	<span class="comment">//其他trait，表示泛型`T`可能不是`Sized`的，此时参数类型</span></span><br><span class="line">	<span class="comment">//不能是`T`，必须是指针类型的</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="泛型（generic）"><a href="#泛型（generic）" class="headerlink" title="泛型（generic）"></a>泛型（generic）</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">largest</span></span>&lt;T&gt;(list: &amp;[T]) -&gt; T &#123;&#125;</span><br><span class="line"><span class="comment">//函数签名中泛型</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T&gt;&#123;</span><br><span class="line">	x: T,</span><br><span class="line">	y: T,</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&lt;T, U&gt;&#123;</span><br><span class="line">	x: T,</span><br><span class="line">	y: U,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//结构体定义中泛型</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option</span></span>&lt;T&gt;&#123;</span><br><span class="line">	<span class="literal">Some</span>(T),</span><br><span class="line">	<span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Result</span></span>&lt;T, E&gt;&#123;</span><br><span class="line">	<span class="literal">Ok</span>(T),</span><br><span class="line">	<span class="literal">Err</span>(E),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//枚举定义中泛型</span></span><br></pre></td></tr></table></figure>
<h3 id="方法实现中泛型"><a href="#方法实现中泛型" class="headerlink" title="方法实现中泛型"></a>方法实现中泛型</h3><ul>
<li><p><code>impl</code>后声明泛型<code>impl&lt;T&gt;</code>表示<code>Point&lt;T&gt;</code>中的<code>T</code>是泛型而
不是具体类型，是对所有的泛型结构体实现</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;T&gt; Point&lt;T&gt;&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">x</span></span>(&amp;<span class="keyword">self</span>) -&gt; &amp;T&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>impl</code>后不声明泛型，则表示<code>Point&lt;T&gt;</code>中<code>T</code>为具体类型，
此时仅对<code>Point&lt;T&gt;</code><strong>类型</strong>实现方法</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Point&lt;<span class="built_in">f32</span>&gt;&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">x</span></span>(&amp;<span class="keyword">self</span>) -&gt; <span class="built_in">f32</span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//仅`Point&lt;f32&gt;`实现此方法，其他`T`类型没有</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>结构体定义中的泛型和方法签名中泛型不一定一致</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;T, U&gt; Point&lt;T, U&gt;&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">mixup</span></span>&lt;V,W&gt;(<span class="keyword">self</span>, other:Point&lt;V,W&gt;) -&gt; Point&lt;T,W&gt;&#123;</span><br><span class="line">		Point&#123;</span><br><span class="line">			x: <span class="keyword">self</span>.x,</span><br><span class="line">			y: other.y,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="trait实现中的泛型"><a href="#trait实现中的泛型" class="headerlink" title="trait实现中的泛型"></a>trait实现中的泛型</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;T:Display&gt; <span class="built_in">ToString</span> <span class="keyword">for</span> T&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这个时标准库中的一个例子，使用了trait bounds</span></span><br><span class="line"><span class="comment">// 不使用trait bounds，那感觉有些恐怖。。。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>   trait定义中的没有泛型，但是其中可以包含泛型方法，同普通
    函数</p>
</blockquote>
<h3 id="泛型代码的性能"><a href="#泛型代码的性能" class="headerlink" title="泛型代码的性能"></a>泛型代码的性能</h3><p>rust在编译时将代码单态化（monomorphization）保证效率，所以
rust使用泛型代码相比具体类型没有任何性能损失</p>
<blockquote>
<p>   单态化：将泛型代码转变为实际放入的具体类型</p>
</blockquote>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> integer = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> float = <span class="literal">Some</span>(<span class="number">5.0</span>);</span><br><span class="line"><span class="comment">//单态化</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option_i32</span></span>&#123;</span><br><span class="line">	<span class="literal">Some</span>(<span class="built_in">i32</span>),</span><br><span class="line">	<span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Option_f64</span></span>&#123;</span><br><span class="line">	<span class="literal">Some</span>(<span class="built_in">f64</span>),</span><br><span class="line">	<span class="literal">None</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> integer = Option_i32::<span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> float = Option_f64::<span class="literal">Some</span>(<span class="number">5.0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Trait-Bounds"><a href="#Trait-Bounds" class="headerlink" title="Trait Bounds"></a>Trait Bounds</h3><p>指定泛型的trait bounds：限制泛型不再适合任何类型，编译器
确保其被限制为实现特定trait的类型</p>
<ul>
<li><p>指定函数泛型trait bounds限制参数类型</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">notify</span></span>&lt;T: Summarizable&gt;(item:T)&#123;&#125;</span><br><span class="line"><span class="comment">// 一个trait bound</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">some_fn</span></span>&lt;T: Display+<span class="built_in">Clone</span>, U: <span class="built_in">Debug</span>+<span class="built_in">Clone</span>&gt;(t:T, u:U) -&gt; <span class="number">32</span>&#123;&#125;</span><br><span class="line"><span class="comment">// 多个trait bounds</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="function"><span class="keyword">fn</span> <span class="title">some_fn</span></span>&lt;T, U&gt;(t:T, u:U) -&gt; <span class="number">32</span></span><br><span class="line">	<span class="keyword">where</span> T:Display + <span class="built_in">Clone</span>,</span><br><span class="line">			U: <span class="built_in">Debug</span> + <span class="built_in">Clone</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// where从句写法</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>指定方法泛型trait bounds有条件的为某些类型实现</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span>&lt;T: Display+<span class="built_in">PartialOrd</span>&gt; Point&lt;T&gt;&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">cmp_display</span></span>(&amp;<span class="keyword">self</span>)&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="trait和泛型的比较"><a href="#trait和泛型的比较" class="headerlink" title="trait和泛型的比较"></a>trait和泛型的比较</h3><p>trait和泛型都是<strong>抽象</strong>方法</p>
<ul>
<li><p>trait从方法角度抽象</p>
<ul>
<li>定义一组公共“行为”</li>
<li>“标记（trait bounds）”特定<strong>类型（泛型）</strong></li>
</ul>
</li>
<li><p>泛型从类型的角度抽象</p>
<ul>
<li>为<strong>一组（trait bounds）</strong>类型定义“项”<code>struct</code>、<code>enum</code></li>
<li>为<strong>一组（trait bounds）</strong>类型实现函数、trait</li>
</ul>
</li>
<li><p>trait的定义中不应该出现泛型</p>
<ul>
<li>trait本意应该是定义一组“行为”，需要特定类型实现其方法
（当然有的方法有默认实现），其对应的“对象”不是类型而
是方法，与泛型用途无关</li>
<li>trait中定义泛型无意义，trait只是一个“包裹”，真正实现
的是其中的方法，如有必要，定义含有泛型参数的方法即可</li>
<li>若trait中可以使用泛型，则<strong>有可能</strong>对不同的泛型具体
类型实现“相同”（函数签名没有泛型参数）函数
（在trait中有关联类型提供略弱与泛型的功能）</li>
</ul>
</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Rust 自定义数据类型</p><p><a href="https://xyy15926.github.io/Rust/struct_enum.html">https://xyy15926.github.io/Rust/struct_enum.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>UBeaRLy</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-03-21</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2019-02-17</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Rust/">Rust</a><a class="link-muted mr-2" rel="tag" href="/tags/Typedef/">Typedef</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=610bd3d2f4ee8700126a0c93&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://z3.ax1x.com/2021/08/05/fetBuT.jpg" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://z3.ax1x.com/2021/08/05/fetDDU.jpg" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Rust/std_var_types.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Rust 标准库数据类型</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Database/Hadoop/hadoop_inset.html"><span class="level-item">Hadoop安装配置</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "48fcbd0271d6d476386879e35248067a",
            repo: "xyy15926.github.io",
            owner: "xyy15926",
            clientID: "af2bd51bbe151a8f6261",
            clientSecret: "f38f610edfe7bc367d5a20d22d43b10d887199eb",
            admin: ["xyy15926"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">36</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Heuristic/"><span class="level-start"><span class="level-item">Heuristic</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Issue/"><span class="level-start"><span class="level-item">Issue</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Problem/"><span class="level-start"><span class="level-item">Problem</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Specification/"><span class="level-start"><span class="level-item">Specification</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">34</span></span></a><ul><li><a class="level is-mobile" href="/categories/C-C/Cppref/"><span class="level-start"><span class="level-item">Cppref</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/Cstd/"><span class="level-start"><span class="level-item">Cstd</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/MPI/"><span class="level-start"><span class="level-item">MPI</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/STL/"><span class="level-start"><span class="level-item">STL</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/CS/"><span class="level-start"><span class="level-item">CS</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/CS/Character/"><span class="level-start"><span class="level-item">Character</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Parallel/"><span class="level-start"><span class="level-item">Parallel</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Program-Design/"><span class="level-start"><span class="level-item">Program Design</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Storage/"><span class="level-start"><span class="level-item">Storage</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Daily-Life/"><span class="level-start"><span class="level-item">Daily Life</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Daily-Life/Maxism/"><span class="level-start"><span class="level-item">Maxism</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">27</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/Hadoop/"><span class="level-start"><span class="level-item">Hadoop</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/SQL-DB/"><span class="level-start"><span class="level-item">SQL DB</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/Spark/"><span class="level-start"><span class="level-item">Spark</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Scala/"><span class="level-start"><span class="level-item">Scala</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">42</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Bash-Programming/"><span class="level-start"><span class="level-item">Bash Programming</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Configuration/"><span class="level-start"><span class="level-item">Configuration</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/File-System/"><span class="level-start"><span class="level-item">File System</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/IPC/"><span class="level-start"><span class="level-item">IPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Process-Schedual/"><span class="level-start"><span class="level-item">Process Schedual</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Shell/"><span class="level-start"><span class="level-item">Shell</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Tool/Vi/"><span class="level-start"><span class="level-item">Vi</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Model/"><span class="level-start"><span class="level-item">ML Model</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Model/Linear-Model/"><span class="level-start"><span class="level-item">Linear Model</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Model-Component/"><span class="level-start"><span class="level-item">Model Component</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Nolinear-Model/"><span class="level-start"><span class="level-item">Nolinear Model</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Unsupervised-Model/"><span class="level-start"><span class="level-item">Unsupervised Model</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/"><span class="level-start"><span class="level-item">ML Specification</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/"><span class="level-start"><span class="level-item">Click Through Rate</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/Recommandation-System/"><span class="level-start"><span class="level-item">Recommandation System</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Computer-Vision/"><span class="level-start"><span class="level-item">Computer Vision</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/"><span class="level-start"><span class="level-item">FinTech</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/Risk-Control/"><span class="level-start"><span class="level-item">Risk Control</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Graph-Analysis/"><span class="level-start"><span class="level-item">Graph Analysis</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Technique/"><span class="level-start"><span class="level-item">ML Technique</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Technique/Feature-Engineering/"><span class="level-start"><span class="level-item">Feature Engineering</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Technique/Neural-Network/"><span class="level-start"><span class="level-item">Neural Network</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Theory/"><span class="level-start"><span class="level-item">ML Theory</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Theory/Loss/"><span class="level-start"><span class="level-item">Loss</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Model-Enhencement/"><span class="level-start"><span class="level-item">Model Enhencement</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Algebra/"><span class="level-start"><span class="level-item">Math Algebra</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Algebra/Linear-Algebra/"><span class="level-start"><span class="level-item">Linear Algebra</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Algebra/Universal-Algebra/"><span class="level-start"><span class="level-item">Universal Algebra</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Analysis/"><span class="level-start"><span class="level-item">Math Analysis</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Analysis/Fourier-Analysis/"><span class="level-start"><span class="level-item">Fourier Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Functional-Analysis/"><span class="level-start"><span class="level-item">Functional Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Real-Analysis/"><span class="level-start"><span class="level-item">Real Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Mixin/"><span class="level-start"><span class="level-item">Math Mixin</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Mixin/Statistics/"><span class="level-start"><span class="level-item">Statistics</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Mixin/Time-Series/"><span class="level-start"><span class="level-item">Time Series</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Probability/"><span class="level-start"><span class="level-item">Probability</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">89</span></span></a><ul><li><a class="level is-mobile" href="/categories/Python/Cookbook/"><span class="level-start"><span class="level-item">Cookbook</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Jupyter/"><span class="level-start"><span class="level-item">Jupyter</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Keras/"><span class="level-start"><span class="level-item">Keras</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Matplotlib/"><span class="level-start"><span class="level-item">Matplotlib</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Numpy/"><span class="level-start"><span class="level-item">Numpy</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pandas/"><span class="level-start"><span class="level-item">Pandas</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3Ref/"><span class="level-start"><span class="level-item">Py3Ref</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3std/"><span class="level-start"><span class="level-item">Py3std</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pywin32/"><span class="level-start"><span class="level-item">Pywin32</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Readme/"><span class="level-start"><span class="level-item">Readme</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/TensorFlow/"><span class="level-start"><span class="level-item">TensorFlow</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Twists/"><span class="level-start"><span class="level-item">Twists</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/RLang/"><span class="level-start"><span class="level-item">RLang</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Rust/"><span class="level-start"><span class="level-item">Rust</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Set/"><span class="level-start"><span class="level-item">Set</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tool/Editor/"><span class="level-start"><span class="level-item">Editor</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Markup-Language/"><span class="level-start"><span class="level-item">Markup Language</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Web-Browser/"><span class="level-start"><span class="level-item">Web Browser</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/Web/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/NPM/"><span class="level-start"><span class="level-item">NPM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Proxy/"><span class="level-start"><span class="level-item">Proxy</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Thrift/"><span class="level-start"><span class="level-item">Thrift</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#结构体struct"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">结构体struct</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#普通结构体"><span class="level-left"><span class="level-item">1.1.1</span><span class="level-item">普通结构体</span></span></a></li><li><a class="level is-mobile" href="#元组结构体"><span class="level-left"><span class="level-item">1.1.2</span><span class="level-item">元组结构体</span></span></a></li><li><a class="level is-mobile" href="#类单元结构体unit-like-struct"><span class="level-left"><span class="level-item">1.1.3</span><span class="level-item">类单元结构体unit-like struct</span></span></a></li></ul></li><li><a class="level is-mobile" href="#枚举enum"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">枚举enum</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#枚举类型"><span class="level-left"><span class="level-item">1.2.1</span><span class="level-item">枚举类型</span></span></a></li><li><a class="level is-mobile" href="#标准库中的枚举"><span class="level-left"><span class="level-item">1.2.2</span><span class="level-item">标准库中的枚举</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#处理null值"><span class="level-left"><span class="level-item">1.2.2.1</span><span class="level-item">处理null值</span></span></a></li><li><a class="level is-mobile" href="#处理潜在panic"><span class="level-left"><span class="level-item">1.2.2.2</span><span class="level-item">处理潜在panic</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#方法、关联函数"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">方法、关联函数</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#方法-Methods"><span class="level-left"><span class="level-item">1.3.1</span><span class="level-item">方法 Methods</span></span></a></li><li><a class="level is-mobile" href="#关联函数-Associated-Functions"><span class="level-left"><span class="level-item">1.3.2</span><span class="level-item">关联函数 Associated Functions</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Trait"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">Trait</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#默认实现"><span class="level-left"><span class="level-item">1.4.1</span><span class="level-item">默认实现</span></span></a></li><li><a class="level is-mobile" href="#孤儿规则-Orphan-Rule"><span class="level-left"><span class="level-item">1.4.2</span><span class="level-item">孤儿规则 Orphan Rule</span></span></a></li><li><a class="level is-mobile" href="#Box-lt-trait-gt-Trait对像"><span class="level-left"><span class="level-item">1.4.3</span><span class="level-item">Box&lt;trait&gt; Trait对像</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Trait对象、泛型Trait-Bound对比"><span class="level-left"><span class="level-item">1.4.3.1</span><span class="level-item">Trait对象、泛型Trait Bound对比</span></span></a></li><li><a class="level is-mobile" href="#对象安全"><span class="level-left"><span class="level-item">1.4.3.2</span><span class="level-item">对象安全</span></span></a></li></ul></li><li><a class="level is-mobile" href="#状态模式（面向对象设计）"><span class="level-left"><span class="level-item">1.4.4</span><span class="level-item">状态模式（面向对象设计）</span></span></a></li></ul></li><li><a class="level is-mobile" href="#高级trait"><span class="level-left"><span class="level-item">1.5</span><span class="level-item">高级trait</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Associated-Type"><span class="level-left"><span class="level-item">1.5.1</span><span class="level-item">Associated Type</span></span></a></li><li><a class="level is-mobile" href="#默认泛型类型参数"><span class="level-left"><span class="level-item">1.5.2</span><span class="level-item">默认泛型类型参数</span></span></a></li><li><a class="level is-mobile" href="#运算符重载"><span class="level-left"><span class="level-item">1.5.3</span><span class="level-item">运算符重载</span></span></a></li><li><a class="level is-mobile" href="#消歧义"><span class="level-left"><span class="level-item">1.5.4</span><span class="level-item">消歧义</span></span></a></li><li><a class="level is-mobile" href="#Fully-Qualified-Syntax"><span class="level-left"><span class="level-item">1.5.5</span><span class="level-item">Fully Qualified Syntax</span></span></a></li><li><a class="level is-mobile" href="#Super-Trait"><span class="level-left"><span class="level-item">1.5.6</span><span class="level-item">Super Trait</span></span></a></li></ul></li><li><a class="level is-mobile" href="#高级类型"><span class="level-left"><span class="level-item">1.6</span><span class="level-item">高级类型</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Newtype-Pattern"><span class="level-left"><span class="level-item">1.6.1</span><span class="level-item">Newtype Pattern</span></span></a></li><li><a class="level is-mobile" href="#Type创建类型别名"><span class="level-left"><span class="level-item">1.6.2</span><span class="level-item">Type创建类型别名</span></span></a></li><li><a class="level is-mobile" href="#Never-Type"><span class="level-left"><span class="level-item">1.6.3</span><span class="level-item">Never Type</span></span></a></li></ul></li></ul><li><a class="level is-mobile" href="#todo-这个和无返回值函数有何区别"><span class="level-left"><span class="level-item">2</span><span class="level-item">todo 这个和无返回值函数有何区别</span></span></a><ul class="menu-list"><ul class="menu-list"><li><a class="level is-mobile" href="#Dynamically-Sized-Types"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">Dynamically Sized Types</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Sized-trait"><span class="level-left"><span class="level-item">2.1.1.1</span><span class="level-item">Sized trait</span></span></a></li></ul></li></ul><li><a class="level is-mobile" href="#泛型（generic）"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">泛型（generic）</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#方法实现中泛型"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">方法实现中泛型</span></span></a></li><li><a class="level is-mobile" href="#trait实现中的泛型"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">trait实现中的泛型</span></span></a></li><li><a class="level is-mobile" href="#泛型代码的性能"><span class="level-left"><span class="level-item">2.2.3</span><span class="level-item">泛型代码的性能</span></span></a></li><li><a class="level is-mobile" href="#Trait-Bounds"><span class="level-left"><span class="level-item">2.2.4</span><span class="level-item">Trait Bounds</span></span></a></li><li><a class="level is-mobile" href="#trait和泛型的比较"><span class="level-left"><span class="level-item">2.2.5</span><span class="level-item">trait和泛型的比较</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="UBeaRLy"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">UBeaRLy</p><p class="is-size-6 is-block">Protector of Proxy</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">392</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">93</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">522</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xyy15926" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/xyy15926"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-04T15:07:54.896Z">2021-08-04</time></p><p class="title"><a href="/uncategorized/README.html"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T07:46:51.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/hexo_config.html">Hexo 建站</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T02:32:45.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/config.html">NPM 总述</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-02T08:11:11.000Z">2021-08-02</time></p><p class="title"><a href="/Python/Py3std/internet_data.html">互联网数据</a></p><p class="categories"><a href="/categories/Python/">Python</a> / <a href="/categories/Python/Py3std/">Py3std</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-29T13:55:00.000Z">2021-07-29</time></p><p class="title"><a href="/Linux/Shell/sh_apps.html">Shell 应用程序</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Shell/">Shell</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5385776267343559" data-ad-slot="6371777973" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2021 UBeaRLy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>