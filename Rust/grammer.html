<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Rust 语法 - UBeaRLy</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="UBeaRLy&#039;s Proxy"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="UBeaRLy&#039;s Proxy"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Rust语法"><meta property="og:type" content="blog"><meta property="og:title" content="Rust 语法"><meta property="og:url" content="https://xyy15926.github.io/Rust/grammer.html"><meta property="og:site_name" content="UBeaRLy"><meta property="og:description" content="Rust语法"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://xyy15926.github.io/img/og_image.png"><meta property="article:published_time" content="2019-03-21T09:27:37.000Z"><meta property="article:modified_time" content="2019-02-17T03:57:08.000Z"><meta property="article:author" content="UBeaRLy"><meta property="article:tag" content="Rust"><meta property="article:tag" content="Grammer"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://xyy15926.github.io/Rust/grammer.html"},"headline":"Rust 语法","image":["https://xyy15926.github.io/img/og_image.png"],"datePublished":"2019-03-21T09:27:37.000Z","dateModified":"2019-02-17T03:57:08.000Z","author":{"@type":"Person","name":"UBeaRLy"},"publisher":{"@type":"Organization","name":"UBeaRLy","logo":{"@type":"ImageObject","url":"https://xyy15926.github.io/img/logo.svg"}},"description":"Rust语法"}</script><link rel="canonical" href="https://xyy15926.github.io/Rust/grammer.html"><link rel="alternate" href="/atom.xml" title="UBeaRLy" type="application/atom+xml"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/darcula.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-5385776267343559" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="follow_it-verification-code" content="SVBypAPPHxjjr7Y4hHfn"><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="UBeaRLy" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Visit on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2019-03-21T09:27:37.000Z" title="3/21/2019, 5:27:37 PM">2019-03-21</time></span><span class="level-item">Updated&nbsp;<time dateTime="2019-02-17T03:57:08.000Z" title="2/17/2019, 11:57:08 AM">2019-02-17</time></span><span class="level-item"><a class="link-muted" href="/categories/Rust/">Rust</a></span><span class="level-item">37 minutes read (About 5483 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">Rust 语法</h1><div class="content"><h2 id="Rust是基于表达式的语言"><a href="#Rust是基于表达式的语言" class="headerlink" title="Rust是基于表达式的语言"></a>Rust是基于表达式的语言</h2><p>表达式返回一个值，而语句不返回，rust中除两种语句外，全是
表达式</p>
<ul>
<li><code>let</code>引入绑定<ul>
<li>可变绑定赋值是表达式，返回空tuple</li>
<li>声明后初始化绑定？#todo</li>
</ul>
</li>
<li>表达式语句：表达式后跟分号转换为语句</li>
</ul>
<p>代码中rust希望语句后跟语句，使用分号分隔表达式，所以rust
看起来和其他大部分分号结尾语言相似</p>
<p><code>&#123;&#125;</code>包裹的代码块内最后一“句”没有以”;”结尾，那么是表达式，且
返回该表达式的值，整个代码块可以看作是表达式，否则为语句，
没有返回值，函数同</p>
<h2 id="模式匹配"><a href="#模式匹配" class="headerlink" title="模式匹配"></a>模式匹配</h2><h3 id="Refutability（可反驳性）"><a href="#Refutability（可反驳性）" class="headerlink" title="Refutability（可反驳性）"></a>Refutability（可反驳性）</h3><ul>
<li>refutable（可反驳的）：对某些可能值匹配失败的模式，
<code>if let</code>、<code>while let</code>只能接受可反驳的模式，因为这就用于
处理可能的失败</li>
<li>irrefutable（不可反驳的）：能匹配任何传递的可能值，<code>let</code>
语句、函数参数、<code>for</code>循环只能接受不可反驳的模式，因为
通过不匹配值的程序无意义</li>
</ul>
<blockquote>
<p>   可能值是指“类型”相同，可用于匹配的值</p>
</blockquote>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="literal">Some</span>(x) = some_optiona_value;</span><br><span class="line">	<span class="comment">//`Some(x)`是refutable模式，若`some_optional_value`为</span></span><br><span class="line">	<span class="comment">//None，则此时无法成功匹配，此语句可能无法正常工作</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> x = <span class="number">5</span> &#123;</span><br><span class="line">	<span class="comment">//`x`是inrefutable模式，对所有可能值都可以匹配，此语句</span></span><br><span class="line">	<span class="comment">//无意义</span></span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Refutable"><a href="#Refutable" class="headerlink" title="Refutable"></a>Refutable</h3><h4 id="match控制流"><a href="#match控制流" class="headerlink" title="match控制流"></a><code>match</code>控制流</h4><ul>
<li>各分支模式同值“类型”必须完全一致才能匹配</li>
<li>返回类型必须一致，如果有返回值</li>
<li>匹配必须是穷尽的，可以使用通配符<code>_</code>（匹配所有的值）代替<ul>
<li>match是匹配到就退出，不像switch一样会继续下沉</li>
<li>通配符不总是需要的，对于枚举类型只要含有所有枚举
成员的分支即可</li>
</ul>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">let</span> y = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> x&#123;</span><br><span class="line">	<span class="literal">Some</span>(<span class="number">50</span>) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;got 50&quot;</span>),</span><br><span class="line">		<span class="comment">//`Some(50)`这个模式规定了“值”</span></span><br><span class="line">	<span class="literal">Some</span>(y) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;matched, y = &#123;:?&#125;&quot;</span>, y),</span><br><span class="line">		<span class="comment">//match表达式作用域中的`y`会覆盖周围环境的`y`</span></span><br><span class="line">	_ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;default case, x = &#123;:?&#125;&quot;</span>, x),</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;at the end: x = &#123;:?&#125;, y = &#123;:?&#125;&quot;</span>, x, y);</span><br></pre></td></tr></table></figure>
<h4 id="if-let-else-简洁控制流"><a href="#if-let-else-简洁控制流" class="headerlink" title="if let[else]简洁控制流"></a><code>if let[else]</code>简洁控制流</h4><ul>
<li>只匹配关心的一个模式</li>
<li>可以添加<code>else</code>语句，类似<code>match</code>通配符匹配</li>
<li><code>if let</code>、<code>else if</code>、<code>else if let</code>等相互组合可以提供更多
的灵活性<ul>
<li><code>else if</code>可以不是模式匹配</li>
<li>各<code>if</code>后的比较的值可以没有关联</li>
</ul>
</li>
<li>没有穷尽性检查，可能会遗漏一些情况</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> favorite_color: <span class="built_in">Option</span>&lt;&amp;<span class="built_in">str</span>&gt; = <span class="literal">None</span>;</span><br><span class="line">	<span class="keyword">let</span> is_tuesday = <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">let</span> age: <span class="built_in">Result</span>&lt;<span class="built_in">u8</span>, _&gt; = <span class="string">&quot;34&quot;</span>.parse();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(color) = favorite_color&#123;</span><br><span class="line">		<span class="comment">//模式匹配</span></span><br><span class="line">		<span class="comment">//注意这里是`=`而不是一般值比较`==`</span></span><br><span class="line">		<span class="comment">//`while`同</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;favorite color is &#123;&#125;&quot;</span>, color&#125;;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> is_tuesday&#123;</span><br><span class="line">		<span class="comment">//普通`if`条件语句</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;Tuesday is green day!&quot;</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Ok</span>(age) = age&#123;</span><br><span class="line">		<span class="comment">//`age`变量覆盖原变量</span></span><br><span class="line">		<span class="comment">//此时`age`是`u8`类型</span></span><br><span class="line">		<span class="keyword">if</span> age &gt; <span class="number">30</span> &#123;</span><br><span class="line">			<span class="comment">//因此此条件不能提出，因为两个`age`变量不同，</span></span><br><span class="line">			<span class="comment">//不能共存在同一条语句中</span></span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;Using purple as the background color&quot;</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;Using orange as the background color&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;Using blue as the background color&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Irrefutable"><a href="#Irrefutable" class="headerlink" title="Irrefutable"></a>Irrefutable</h3><h4 id="while-let条件循环"><a href="#while-let条件循环" class="headerlink" title="while let条件循环"></a><code>while let</code>条件循环</h4><p>和<code>if let</code>条件表达式类似，循环直到模式不匹配</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> <span class="keyword">mut</span> stack = <span class="built_in">Vec</span>::new();</span><br><span class="line">	stack.push(<span class="number">1</span>);</span><br><span class="line">	stack.push(<span class="number">2</span>);</span><br><span class="line">	stack.push(<span class="number">3</span>);</span><br><span class="line">	<span class="keyword">while</span> <span class="keyword">let</span> <span class="literal">Some</span>(top) = stack.pop()&#123;</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, top);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="for解构"><a href="#for解构" class="headerlink" title="for解构"></a><code>for</code>解构</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">	<span class="keyword">for</span> (index, value) <span class="keyword">in</span> v.iter().enumerate()&#123;</span><br><span class="line">		<span class="comment">//解构tuple</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is at index &#123;&#125;&quot;</span>, value, index);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="let解构"><a href="#let解构" class="headerlink" title="let解构"></a><code>let</code>解构</h4><p><code>let</code>语句本“应该“看作是模式匹配</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> PARTTERN = EXPRESSION;</span><br><span class="line">	<span class="comment">//这样就和`if let`模式匹配中`=`一致</span></span><br><span class="line">	<span class="comment">//应该可以把`=`看作是模式匹配的符号</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line">	<span class="comment">//这里`x`是一个模式“变量”</span></span><br><span class="line"><span class="keyword">let</span> (x, y, z) = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">	<span class="comment">//`(x, y, z)`是模式“3元元组“</span></span><br><span class="line">	<span class="comment">//解构元组</span></span><br></pre></td></tr></table></figure>
<h4 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h4><p>类似于<code>let</code>语句，函数参数也“应该”看作是模式匹配</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">foo</span></span>(x: <span class="built_in">i32</span>)&#123;</span><br><span class="line">	<span class="comment">//`x`表示模式“变量”</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">print_coordinates</span></span>(&amp;(x, y): &amp;(<span class="built_in">i32</span>, <span class="built_in">i32</span>))&#123;</span><br><span class="line">	<span class="comment">//这里`(x, y)`是模式“元组”</span></span><br><span class="line">	<span class="comment">//但是这里处于函数变量类型的要求，有点像元组结构体</span></span><br><span class="line">	<span class="comment">//调用时使用元组即可</span></span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;Current location: (&#123;&#125;, &#123;&#125;)&quot;</span>, x, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="模式匹配用法"><a href="#模式匹配用法" class="headerlink" title="模式匹配用法"></a>模式匹配用法</h3><h4 id="、-“或“"><a href="#、-“或“" class="headerlink" title="|、...“或“"></a><code>|</code>、<code>...</code>“或“</h4><ul>
<li><code>|</code>“或”匹配多个模式</li>
<li><code>...</code>闭区间范围模式，仅适用于数值、<code>char</code>值</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">	<span class="number">1</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;one&quot;</span>),</span><br><span class="line">		<span class="comment">//`1`是模式“字面值”</span></span><br><span class="line">	<span class="number">2</span> | <span class="number">3</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;two or three&quot;</span>),</span><br><span class="line">		<span class="comment">//`|`分隔，匹配多个模式</span></span><br><span class="line">	<span class="number">5</span>...<span class="number">10</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;through 5 to 10&quot;</span>),</span><br><span class="line">		<span class="comment">//`...`表示匹配一个**闭区间**范围的值</span></span><br><span class="line">		<span class="comment">//这个语法只能用于数字或者是`char`值，因为编译器会</span></span><br><span class="line">		<span class="comment">//检查范围不为空，而只有数字、`char`值rust可以判断</span></span><br><span class="line">	_ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;anything&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">	<span class="string">&#x27;a&#x27;</span>...<span class="string">&#x27;j&#x27;</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;early ASCII letter&quot;</span>),</span><br><span class="line">	<span class="string">&#x27;k&#x27;</span>...<span class="string">&#x27;z&#x27;</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;late ASCII letter&quot;</span>),</span><br><span class="line">	_ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;something else&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="、-”忽略“"><a href="#、-”忽略“" class="headerlink" title="_、..”忽略“"></a><code>_</code>、<code>..</code>”忽略“</h4><ul>
<li><p><code>_</code>忽略整个值</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">foo</span></span>(_: <span class="built_in">i32</span>, y: <span class="built_in">i32</span>)&#123;</span><br><span class="line">	<span class="comment">//函数签名中忽略整个值</span></span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;this code only use the y parameter: &#123;&#125;&quot;</span>, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	foo(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> <span class="keyword">mut</span> setting_value = <span class="literal">Some</span>(<span class="number">5</span>); <span class="keyword">let</span> new_setting_value = <span class="literal">Some</span>(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">match</span> (setting_value, new_setting_value)&#123;</span><br><span class="line">		(<span class="literal">Some</span>(_), <span class="literal">Some</span>()) =&gt; &#123;</span><br><span class="line">			<span class="comment">//嵌套`_`忽略部分值</span></span><br><span class="line">			<span class="comment">//此时没有任何值所有权</span></span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;can&#x27;t overwrite an exsiting customized value&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		_ =&gt; &#123;</span><br><span class="line">			setting_value = new_setting_value;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;setting is &#123;:?&#125;&quot;</span>, setting_value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>_var</code>变量名前添加下划线忽略未使用变量，此时值所有权
仍然会转移，只是相当于告诉编译器忽略该未使用变量</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> _x = <span class="number">5</span>;</span><br><span class="line">		<span class="comment">//两个变量未使用，但是编译时只有一个warning</span></span><br><span class="line">	<span class="keyword">let</span> y = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> s = <span class="literal">Some</span>(<span class="number">5</span>);</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">let</span> <span class="literal">Some</span>(_s) = s &#123;</span><br><span class="line">		<span class="comment">//值所有权已转移，`s`不能继续使用</span></span><br><span class="line">		<span class="comment">//编译器忽略未使用`_s`，不给出warning</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;get a integer&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>..</code>忽略剩余值</p>
<ul>
<li><code>..</code>的使用必须无歧义</li>
<li>对于结构体即使只有一个field，需使用<code>..</code>忽略剩余值，
不能使用<code>_</code><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> numbers = (<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>);</span><br><span class="line">	<span class="keyword">match</span> numbers&#123;</span><br><span class="line">		(first, .., last) =&gt; &#123;</span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;Some numbers: &#123;&#125;, &#123;&#125;&quot;</span>, first, last);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> (x, _, z) = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">	<span class="comment">//`_`忽略模式中各一个值</span></span><br><span class="line"><span class="keyword">let</span> (x, .., z) = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">	<span class="comment">//`..`忽略模式中多个值</span></span><br></pre></td></tr></table></figure>
<h4 id="解构结构体"><a href="#解构结构体" class="headerlink" title="解构结构体"></a>解构结构体</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span>&#123;</span><br><span class="line">	x: <span class="built_in">i32</span>,</span><br><span class="line">	y: <span class="built_in">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> p = Point&#123;x: <span class="number">0</span>, y: <span class="number">7</span>&#125;;</span><br><span class="line">	<span class="keyword">let</span> Point&#123;x: a, y: b&#125; = p;</span><br><span class="line">		<span class="comment">//`Point&#123;x: a, y: b&#125;`是模式”Point结构体“</span></span><br><span class="line">		<span class="comment">//解构结构体</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> p = Point&#123;x: <span class="number">0</span>, y: <span class="number">7</span>&#125;;</span><br><span class="line">	<span class="keyword">let</span> Point&#123;x, y&#125; = p;</span><br><span class="line">		<span class="comment">//模式匹配解构结构体简写</span></span><br><span class="line">		<span class="comment">//只要列出结构体字段，模式创建相同名称的变量</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> p = Point&#123;x: <span class="number">0</span>, y: <span class="number">7</span>&#125;;</span><br><span class="line">	<span class="keyword">match</span> p &#123;</span><br><span class="line">		Point &#123;x, y: <span class="number">0</span>&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;on the x axis at &#123;&#125;&quot;</span>, x),</span><br><span class="line">		Point &#123;x: <span class="number">0</span>, y&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;on the y axis at &#123;&#125;&quot;</span>, y),</span><br><span class="line">		Point &#123;x, y&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;on neither axis: (&#123;&#125;, &#123;&#125;)&quot;</span>, x, y),</span><br><span class="line">			<span class="comment">//这里没有`_`通配符，因为`Point &#123;x, y&#125;`模式已经</span></span><br><span class="line">			<span class="comment">//是irrefutable，不需要</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="解构枚举"><a href="#解构枚举" class="headerlink" title="解构枚举"></a>解构枚举</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span>&#123;</span><br><span class="line">	Quit,</span><br><span class="line">	Move&#123;x: <span class="built_in">i32</span>, y:<span class="built_in">i32</span>&#125;,</span><br><span class="line">	Write(<span class="built_in">String</span>),</span><br><span class="line">	ChangeColor(<span class="built_in">i32</span>, <span class="built_in">i32</span>, <span class="built_in">i32</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> msg = Message::ChangeColor(<span class="number">0</span>, <span class="number">160</span>, <span class="number">255</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> p = <span class="keyword">match</span> msg&#123;</span><br><span class="line">		<span class="comment">//这里`match`返回值必须类型完全相同</span></span><br><span class="line">		Message::Move&#123;x, y&#125; <span class="keyword">if</span> x == <span class="number">0</span> =&gt; (x, y),</span><br><span class="line">			<span class="comment">//对于`Message`中的匿名结构体类型的成员，匿名</span></span><br><span class="line">			<span class="comment">//结构体没有枚举类型外的定义、名称，无法、也</span></span><br><span class="line">			<span class="comment">//不应该直接获取结构体</span></span><br><span class="line">		Message::Write(<span class="keyword">ref</span> <span class="built_in">str</span>) =&gt; &#123;</span><br><span class="line">			<span class="comment">//`Message::Write`不是`Message`的一个枚举成员</span></span><br><span class="line">			<span class="comment">//必须`Message::Write(str)`才是（能够匹配）</span></span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;write &#123;&#125;&quot;</span>, <span class="built_in">str</span>);</span><br><span class="line">			(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">		&#125;,</span><br><span class="line">		Message::ChangeColor(..) =&gt; (<span class="number">1</span>,<span class="number">0</span>),</span><br><span class="line">			<span class="comment">//类似的，需要使用`..`忽略值，仅`ChangeColor`</span></span><br><span class="line">			<span class="comment">//不是`Message`成员</span></span><br><span class="line">		_ =&gt; &#123;</span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;quit&quot;</span>);</span><br><span class="line">			(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="amp-、ref、ref-mut”引用“"><a href="#amp-、ref、ref-mut”引用“" class="headerlink" title="&amp;、ref、ref mut”引用“"></a><code>&amp;</code>、<code>ref</code>、<code>ref mut</code>”引用“</h4><ul>
<li><p><code>&amp;</code>匹配引用，“获得”值</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> points = <span class="built_in">vec!</span>[</span><br><span class="line">	Point &#123;x: <span class="number">0</span>, y: <span class="number">0</span>&#125;,</span><br><span class="line">	Point &#123;x: <span class="number">1</span>, y: <span class="number">5</span>&#125;,</span><br><span class="line">	Point &#123;x: <span class="number">10</span>, y: -<span class="number">3</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> sum_of_squares: <span class="built_in">i32</span> = points</span><br><span class="line">	.iter()</span><br><span class="line">	.map(|&amp;Point &#123;x, y&#125;| x * x + y * y)</span><br><span class="line">		<span class="comment">//`&amp;`匹配一个引用</span></span><br><span class="line">	.sum();</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>ref</code>匹配值，“获得”不可变引用</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> robot_name = <span class="literal">Some</span>(<span class="built_in">String</span>::from(<span class="string">&quot;Bors&quot;</span>));</span><br><span class="line"><span class="keyword">match</span> robot_name&#123;</span><br><span class="line">	<span class="literal">Some</span>(<span class="keyword">ref</span> name) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;found a name: &#123;&#125;&quot;</span>, name),</span><br><span class="line">		<span class="comment">//使用`ref`获取不可变引用才能编译成功</span></span><br><span class="line">		<span class="comment">//否则所有权转移，之后报错</span></span><br><span class="line">	<span class="literal">None</span> =&gt; (),</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;robot_name is: &#123;:?&#125;&quot;</span>, robot_name);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>ref mut</code>匹配值，“获得”可变引用</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> robot_name = <span class="literal">Some</span>(<span class="built_in">String</span>::from(<span class="string">&quot;Bors&quot;</span>));</span><br><span class="line"><span class="keyword">match</span> robot_name&#123;</span><br><span class="line">	<span class="literal">Some</span>(<span class="keyword">ref</span> <span class="keyword">mut</span> name) =&gt; *name = <span class="built_in">String</span>::from(<span class="string">&quot;NewName&quot;</span>),</span><br><span class="line">	<span class="literal">None</span> =&gt; (),</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;robot_name is: &#123;:?&#125;&quot;</span>, robot_name);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="ifmatch-guard"><a href="#ifmatch-guard" class="headerlink" title="ifmatch guard"></a><code>if</code>match guard</h4><p>匹配守卫<em>match guard</em>：放在<code>=&gt;</code>之前的<code>if</code>语句，<code>match</code>
分支的额外条件，条件为真才会继续执行分支代码</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="literal">Some</span>(<span class="number">4</span>);</span><br><span class="line"><span class="keyword">let</span> y = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">match</span> num&#123;</span><br><span class="line">	<span class="literal">Some</span>(x) <span class="keyword">if</span> x &lt; y =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#x27;less than y: &#123;&#125;&quot;</span>, x),</span><br><span class="line">	<span class="literal">Some</span>(x) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, x),</span><br><span class="line">	<span class="literal">None</span> =&gt; (),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> x = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">let</span> y = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">	<span class="number">4</span> | <span class="number">5</span> | <span class="number">6</span> <span class="keyword">if</span> y =&gt; <span class="built_in">println!</span>(<span class="string">&quot;yes&quot;</span>),</span><br><span class="line">		<span class="comment">//`4 | 5 | 6`整体作为一个模式，match guard作用于</span></span><br><span class="line">		<span class="comment">//模式整体，而不是单独的`6`</span></span><br><span class="line">	_ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;no&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="绑定"><a href="#绑定" class="headerlink" title="@绑定"></a><code>@</code>绑定</h4><p><code>@</code>允许在创建存放值的变量时，同时测试值是否匹配模式</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Message</span></span>&#123;</span><br><span class="line">	Hello &#123; id: <span class="built_in">i32</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> msg = Message::Hello &#123; id: <span class="number">5</span> &#125;;</span><br><span class="line"><span class="keyword">match</span> msg&#123;</span><br><span class="line">	Message::Hello&#123; id: id_variable @ <span class="number">3</span>...<span class="number">7</span> &#125; =&gt; &#123;</span><br><span class="line">		<span class="comment">//匹配结构体模式（值绑定`id_variable`）&amp;&amp;值在`3...7`范围</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;Found an id in range: &#123;&#125;&quot;</span>, id_variable)</span><br><span class="line">	&#125;,</span><br><span class="line">	Message::Hello&#123; id: <span class="number">10</span>...<span class="number">12</span> &#125; =&gt; &#123;</span><br><span class="line">		<span class="comment">//此分支模式指定了值的范围，但是没有绑定值给变量`id`</span></span><br><span class="line">		<span class="comment">//结构体匹配简略写法不能应用与此</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;Found an id in another range&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	Message::Hello&#123; id &#125; =&gt; &#123;</span><br><span class="line">		<span class="comment">//此分支结构体匹配简略写法，值绑定于`id`</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;Found some other id: &#123;&#125;&quot;</span>, id)</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="闭包closures和函数指针"><a href="#闭包closures和函数指针" class="headerlink" title="闭包closures和函数指针"></a>闭包closures和函数指针</h2><p>闭包是可以保存进变量或作为参数传递给其他函数的匿名函数，
可以在一个地方创建闭包，而在不同的上下文执行闭包。和函数
的区别在于，其可以捕获调用者作用域中的值，当然这会有性能
损失，如果不需要捕获调用者作用域中的值可以考虑使用函数</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> closures = |param1, param2|&#123;</span><br><span class="line">	...</span><br><span class="line">	expression</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>闭包参数：<strong>调用者</strong>使用，<ul>
<li>创建闭包赋值给变量，再通过变量调用闭包</li>
<li>创建闭包作为参数传递，其他函数调用</li>
</ul>
</li>
<li>捕获环境变量：创建闭包作为参数传递，直接使用周围环境变量</li>
</ul>
<h3 id="闭包类型推断和注解"><a href="#闭包类型推断和注解" class="headerlink" title="闭包类型推断和注解"></a>闭包类型推断和注解</h3><p>闭包不要求像函数一样需要在参数和返回值上注明类型，函数需要
类型注解因为其是需要暴露给的显示接口的一部分，而闭包不用于
作为对外暴露的接口</p>
<ul>
<li>作为匿名函数直接使用，或者存储在变量中</li>
<li>通常很短，使用场景上下文比较简单，编译器能够推断参数和
返回值类型</li>
</ul>
<p>当然，闭包也可以添加注解增加明确性</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span>  <span class="title">add_one_v1</span>   &#123;<span class="title">x</span>: <span class="title">u32</span>&#125; -&gt; <span class="title">u32</span> &#123; <span class="title">x</span> + 1 &#125;;</span></span><br><span class="line"><span class="function"><span class="title">let</span> <span class="title">add_one_v2</span> = |<span class="title">x</span>: <span class="title">u32</span>| -&gt; <span class="title">u32</span> &#123; <span class="title">x</span> + 1 &#125;;</span></span><br><span class="line"><span class="function"><span class="title">let</span> <span class="title">add_one_v3</span> = |<span class="title">x</span>|             &#123; <span class="title">x</span> + 1 &#125;;</span></span><br><span class="line"><span class="function"><span class="title">let</span> <span class="title">add_one_v4</span> = |<span class="title">x</span>|               <span class="title">x</span> + 1;</span></span><br><span class="line"><span class="function">	//闭包体只有一行可以省略`&#123;&#125;`</span></span><br></pre></td></tr></table></figure>
<p>Rust会根据闭包出调用为每个参数和返回值推断类型，并将其锁定，
如果尝试对同一闭包使用不同类型的参数调用会报错</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> example_closure = |x| x;</span><br><span class="line"><span class="keyword">let</span> s = example_closure(<span class="built_in">String</span>::from(<span class="string">&quot;hello&quot;</span>));</span><br><span class="line">	<span class="comment">//此时已经锁定闭包参数、返回值类型</span></span><br><span class="line"><span class="keyword">let</span> n = example_closure(<span class="number">5</span>);</span><br><span class="line">	<span class="comment">//尝试使用`i32`类型调用闭包会报错</span></span><br></pre></td></tr></table></figure>
<h3 id="Fntrait-bound"><a href="#Fntrait-bound" class="headerlink" title="Fntrait bound"></a><code>Fn</code>trait bound</h3><p>每个闭包实例有自己独有的匿名类型，即使两个闭包有相同的签名，
其类型依然不同。为了定义使用闭包的结构体、枚举、函数参数，
（这些定义中都需要指定元素类型），需要使用泛型和trait 
bound</p>
<ul>
<li><code>FnOnce</code>：获取从周围环境捕获的变量的所有权，因此只能调用
一次，即<code>Once</code>的含义</li>
<li><code>Fn</code>：获取从周围环境捕获的变量的不可变引用</li>
<li><code>FnMut</code>：获取从周围环境捕获的变量的可变引用</li>
</ul>
<p>所有的闭包都实现了以上3个trait中的一个，Rust根据闭包如何
使用环境中的变量推断其如何捕获环境，及实现对应的trait</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Cacher</span></span>&lt;T&gt;</span><br><span class="line">	<span class="keyword">where</span> T: <span class="built_in">Fn</span>(<span class="built_in">u32</span>) -&gt; <span class="built_in">u32</span>&#123;</span><br><span class="line">		<span class="comment">//`T`的类型中包括`Fn`、参数、返回值三个限定</span></span><br><span class="line">	calculation: T,</span><br><span class="line">	value: <span class="built_in">Option</span>&lt;<span class="built_in">u32</span>&gt;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Function-Pointer-fn"><a href="#Function-Pointer-fn" class="headerlink" title="Function Pointer fn"></a>Function Pointer <code>fn</code></h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">add_one</span></span>(x: <span class="built_in">i32</span>) -&gt; <span class="built_in">i32</span>&#123;</span><br><span class="line">	x + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">do_twice</span></span>(f: <span class="function"><span class="keyword">fn</span></span>(<span class="built_in">i32</span>) -&gt; <span class="built_in">i32</span>, arg: <span class="built_in">i32</span>) -&gt; <span class="built_in">i32</span>&#123;</span><br><span class="line">	<span class="comment">//`f`是`fn`函数指针类型</span></span><br><span class="line">	f(arg) + f(arg)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> answer = do_twice(add_one, <span class="number">5</span>);</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;the anwser is: &#123;&#125;&quot;</span>, anwser);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数指针类型实现了以上<strong>全部</strong><code>Fn</code>、<code>FnMut</code>、<code>FnOnce</code>三个
trait，所以总是可以在调用期望闭包作为参数的函数时传递函数
指针，因此倾向于使用泛型和闭包trait bound的函数，这样可以
同时使用闭包、函数指针作为参数。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> list_of_numbers = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> list_of_Strings: <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt; = list_of_numbers</span><br><span class="line">	.iter()</span><br><span class="line">	.map(|i| i.to_string())</span><br><span class="line">		<span class="comment">//闭包作为参数传递</span></span><br><span class="line">	.collect();</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> list_of_strings: <span class="built_in">Vec</span>&lt;<span class="built_in">String</span>&gt; = list_of_numbers</span><br><span class="line">	.iter()</span><br><span class="line">	.map(<span class="built_in">ToString</span>::to_string)</span><br><span class="line">		<span class="comment">//函数作为参数传递</span></span><br><span class="line">		<span class="comment">//使用了完全限定语法，因为存在多个`to_string`函数</span></span><br><span class="line">		<span class="comment">//标准库为所有实现了`Display`的类型实现了此trait</span></span><br><span class="line">	.collect();</span><br></pre></td></tr></table></figure>
<p>与不存在闭包的外部代码（如C语言，只有函数没有闭包）交互时，
只能使用函数作为参数，不能使用闭包。</p>
<h3 id="move关键字"><a href="#move关键字" class="headerlink" title="move关键字"></a><code>move</code>关键字</h3><p><code>move</code>关键字强制闭包获其捕获的环境变量的所有权，在将闭包
传递给新线程以便将数据移动到新线程时非常实用</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> x = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">	<span class="keyword">let</span> equal_to_x = <span class="keyword">move</span> |z| z == x;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;can&#x27;t use x here: &#123;:?&#125;&quot;</span>, x);</span><br><span class="line">		<span class="comment">//此时`x`的所有权已经转移进闭包，不能在闭包外使用</span></span><br><span class="line">	<span class="keyword">let</span> y = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">	<span class="built_in">assert!</span>(equal_to_x(y));</span><br></pre></td></tr></table></figure>
<h3 id="返回闭包"><a href="#返回闭包" class="headerlink" title="返回闭包"></a>返回闭包</h3><p>闭包表现为trait，没有确定的类型、大小，无法直接返回，也不
允许使用函数指针<code>fn</code>作为返回值类型，需要使用trait对象返回
闭包</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">return_closure</span></span>() -&gt; <span class="built_in">Box</span>&lt;<span class="built_in">Fn</span>(<span class="built_in">i32</span>) -&gt; <span class="built_in">i32</span>&gt;&#123;</span><br><span class="line">	<span class="comment">//trait对象作为返回值</span></span><br><span class="line">	<span class="built_in">Box</span>::new(|x| x + <span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="迭代器Iterator"><a href="#迭代器Iterator" class="headerlink" title="迭代器Iterator"></a>迭代器Iterator</h2><p>迭代器负责遍历序列中的每一项和决定序列何时结束的逻辑。Rust
中迭代器时惰性的，直到调用方法”消费“迭代器之前都不会有效果</p>
<h3 id="Iteratortrait"><a href="#Iteratortrait" class="headerlink" title="Iteratortrait"></a><code>Iterator</code>trait</h3><p>迭代器都实现了标准库中<code>Iterator</code>trait</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Iterator</span></span>&#123;</span><br><span class="line">	<span class="class"><span class="keyword">type</span> <span class="title">Item</span></span>;</span><br><span class="line">		<span class="comment">//定义`Iterator`的关联类型</span></span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">next</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) -&gt; <span class="built_in">Option</span>&lt;Self::Item);</span><br><span class="line">		<span class="comment">//参数是`&amp;mut self`，要求迭代器是`mut`类型</span></span><br><span class="line">		<span class="comment">//`next`方法改变了迭代器中用来记录序列位置的状态</span></span><br><span class="line">	<span class="comment">//methods with default implementation elided</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="next方法"><a href="#next方法" class="headerlink" title="next方法"></a><code>next</code>方法</h3><p><code>next</code>是<code>Iterator</code>唯一要求被实现的方法，其返回迭代器中封装
在<code>Some</code>中的一项（<strong>消费</strong>迭代器中的一项），迭代器结束时，
返回<code>None</code>。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[test]</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">iterator_demostration</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> v1 = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">	<span class="keyword">let</span> <span class="keyword">mut</span> v_iter = v1.iter();</span><br><span class="line">		<span class="comment">//注意`v_iter`声明为`mut`</span></span><br><span class="line">		<span class="comment">//使用`for`循环时无需使`v1_iter`可变，`for`会获取其</span></span><br><span class="line">		<span class="comment">//所有权并在后台使其可变</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert_eq!</span>(v1_iter.next(), <span class="literal">Some</span>(&amp;<span class="number">1</span>));</span><br><span class="line">	<span class="built_in">assert_eq!</span>(v1_iter.next(), <span class="literal">Some</span>(&amp;<span class="number">2</span>));</span><br><span class="line">	<span class="built_in">assert_eq!</span>(v1_iter.next(), <span class="literal">Some</span>(&amp;<span class="number">3</span>));</span><br><span class="line">		<span class="comment">//真的很难理解，rust中&amp;integer是怎么比较的</span></span><br><span class="line">	<span class="built_in">assert_eq!</span>(v1_iter.nett(), <span class="literal">None</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="消费适配器Comsuming-Adaptors"><a href="#消费适配器Comsuming-Adaptors" class="headerlink" title="消费适配器Comsuming Adaptors"></a>消费适配器Comsuming Adaptors</h3><p><code>Iterator</code>trait中定义，调用<code>next</code>方法，消耗迭代器</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[test]</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">iterator_sum</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> v1 = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">	<span class="keyword">let</span> v1_iter = v1.iter();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> total:<span class="built_in">i32</span> = v1_iter.sum();</span><br><span class="line">		<span class="comment">//`sum`获取迭代器所有权，`v1_iter`不能继续使用</span></span><br><span class="line">	<span class="built_in">assert_eq!</span>(total, <span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<h3 id="迭代器适配器Iterator-Adaptors"><a href="#迭代器适配器Iterator-Adaptors" class="headerlink" title="迭代器适配器Iterator Adaptors"></a>迭代器适配器Iterator Adaptors</h3><p><code>Iterator</code>trait中定义，将当前迭代器变为其他迭代器，同样是
惰性的，必须调用消费适配器以便获取迭代适配器的结果</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> v1:<span class="built_in">Vec</span>&lt;<span class="built_in">i32</span>&gt; = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">v1.iter().map(|x| x + <span class="number">1</span>);</span><br><span class="line">	<span class="comment">//这里因为没有调用消费适配器，其实没有做事</span></span><br><span class="line"><span class="keyword">let</span> v2:<span class="built_in">Vec</span>&lt;_&gt; =  v1.iter().map(|x| x + <span class="number">1</span>).collect();</span><br><span class="line"><span class="built_in">assert_eq!</span>(v2, <span class="built_in">vec!</span>[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(PartialEq, Debug)]</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Shoe</span></span>&#123;</span><br><span class="line">	size: <span class="built_in">u32</span>,</span><br><span class="line">	style: <span class="built_in">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">shoes_in_my_size</span></span>(shoes: <span class="built_in">Vec</span>&lt;Shoe&gt;, show_size: <span class="built_in">u32</span>) -&gt; <span class="built_in">Vec</span>&lt;Shoe&gt;&#123;</span><br><span class="line">	shoes.into_iter()</span><br><span class="line">			<span class="comment">//获取vector所有权的迭代器</span></span><br><span class="line">		.filter(|s| s.size == show_size)</span><br><span class="line">			<span class="comment">//这里使用闭包获取外部环境变量</span></span><br><span class="line">		.collect()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[test]</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">filter_by_size</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> shoes = <span class="built_in">vec!</span>[</span><br><span class="line">		Shoe&#123;size: <span class="number">10</span>, style: <span class="built_in">String</span>::from(<span class="string">&quot;sneaker&quot;</span>)&#125;,</span><br><span class="line">		Shoe&#123;size: <span class="number">13</span>, style: <span class="built_in">String</span>::from(<span class="string">&quot;sandal&quot;</span>)&#125;,</span><br><span class="line">		Shoe&#123;size: <span class="number">10</span>, style: <span class="built_in">String</span>::from(<span class="string">&quot;boot&quot;</span>)&#125;,</span><br><span class="line">	];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> in_my_size = shoes_in_my_size(shoes, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">assert_eq!</span>(</span><br><span class="line">		in_my_size,</span><br><span class="line">		<span class="built_in">vec!</span>[</span><br><span class="line">			Shoe&#123;size: <span class="number">10</span>, style: <span class="built_in">String</span>::from(<span class="string">&quot;sneaker&quot;</span>)&#125;,</span><br><span class="line">			Shoe&#123;size: <span class="number">10</span>, style: <span class="built_in">String</span>::from(<span class="string">&quot;boot&quot;</span>)&#125;,</span><br><span class="line">		]</span><br><span class="line">	);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="实现Iterator"><a href="#实现Iterator" class="headerlink" title="实现Iterator"></a>实现<code>Iterator</code></h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Counter</span></span>&#123;</span><br><span class="line">	count: <span class="built_in">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> Counter&#123;</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">new</span></span>() -&gt; Counter&#123;</span><br><span class="line">		Counter&#123;count: <span class="number">0</span>&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="built_in">Iterator</span> <span class="keyword">for</span> Counter&#123;</span><br><span class="line">	<span class="class"><span class="keyword">type</span> <span class="title">Item</span></span> = <span class="built_in">u32</span>;</span><br><span class="line">		<span class="comment">//迭代器将返回`u32`值集合</span></span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">fn</span> <span class="title">next</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) -&gt; <span class="built_in">Option</span>&lt;Self::Item&gt;&#123;</span><br><span class="line">		<span class="keyword">self</span>.count += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">self</span>.count &lt; <span class="number">6</span>&#123;</span><br><span class="line">			<span class="literal">Some</span>(<span class="keyword">self</span>.count)</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="literal">None</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[test]</span></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">using_other_iterator_trait_methods</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> sum: <span class="built_in">u32</span> = Counter::new().zip(Counter::new().skip(<span class="number">1</span>))</span><br><span class="line">								.map(|(a, b)| a * b)</span><br><span class="line">								.filter(|x| x % <span class="number">3</span> == <span class="number">0</span>)</span><br><span class="line">								.sum();</span><br><span class="line">	<span class="built_in">assert_eq!</span>(<span class="number">18</span>, sum);</span><br></pre></td></tr></table></figure>
<h2 id="并发（并行）"><a href="#并发（并行）" class="headerlink" title="并发（并行）"></a>并发（并行）</h2><p>多线程可以改善性能，但是也会增加复杂性</p>
<ul>
<li>竞争状态Race Conditions：多个线程以不一致的顺序访问资源</li>
<li>死锁Dead Lock：线程互相等待资源释放，阻止继续运行</li>
<li>只会在特定情况出现、无法稳定重现的bug</li>
</ul>
<p>线程模型</p>
<ul>
<li><code>1:1</code>模型：一个OS线程对应一个语言线程，语言调用操作系统
API创建线程，性能较好</li>
<li><code>M:N</code>模型：语言有自己的线程实现，其提供的线程称为
<strong>绿色</strong>(green)线程，M个绿色线程对应N个OS线程，更好的
运行控制、更底的上下文切换成本</li>
</ul>
<p>Rust为了更小的运行时（这里表示二进制文件中语言自身提供的
代码）考虑，标准库中只提供了<code>1:1</code>线程模式实现。可以通过一些
crate扩展<code>M:N</code>线程模式。</p>
<h3 id="spawn创建新线程"><a href="#spawn创建新线程" class="headerlink" title="spawn创建新线程"></a><code>spawn</code>创建新线程</h3><p><code>std::thread::spawn</code>接受一个闭包作为参数，返回<code>JoinHandle</code>
类型的句柄。作为<code>spawn</code>参数的闭包和一般的闭包有些不同，
线程直接独立执行，所以此时闭包捕获外部环境变量不能按照默认
的获取不可变引用，因为此时捕获的变量值可能已经被丢弃，必须
使用<code>move</code>关键字获取所有权，而一般的闭包是顺序执行的，没有
特殊需要可以直接获取不可变引用，而能够保证值不被丢弃。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::thread;</span><br><span class="line"><span class="keyword">use</span> std::time:Duration;</span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> handle = thread::spawn(|| &#123;</span><br><span class="line">		<span class="comment">//`thread::spawn`接受一个闭包作为参数，返回</span></span><br><span class="line">		<span class="comment">//`JoinHandle`类型的值（不是引用）</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..<span class="number">10</span>&#123;</span><br><span class="line">			<span class="built_in">println!</span>(<span class="string">&quot;number &#123;&#125; from spwaned thread!&quot;</span>, i);</span><br><span class="line">			thread::sleep(Duration::from_millis(<span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>..<span class="number">5</span>&#123;</span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;number&#123;&#125; from main thread!&quot;</span>, i);</span><br><span class="line">		thread::sleep(Duration::from_millis(<span class="number">1</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	handle.join().wrap();</span><br><span class="line">		<span class="comment">//`JoinHandle.join()`将阻塞直到其对应的线程结束</span></span><br><span class="line">		<span class="comment">//如果调用`join`，spawn线程可能无法执行完毕</span></span><br><span class="line">		<span class="comment">//因为主线程执行完，整个进行结束</span></span><br><span class="line">		<span class="comment">//注意`join`调用的位置决定阻塞的位置</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> v = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span> , <span class="number">3</span>];</span><br><span class="line">	<span class="keyword">let</span> handle = thread::spawn(<span class="keyword">move</span> || &#123;</span><br><span class="line">		<span class="comment">//这里`move`关键字将捕获的外部环境中变量`v`所有权</span></span><br><span class="line">		<span class="comment">//移入spawn线程，否则无法正常编译</span></span><br><span class="line">		prinln!(<span class="string">&quot;here&#x27;s a vector: &#123;:?&#125;&quot;</span>, v);</span><br><span class="line">	&#125;);</span><br><span class="line">	handle.join().unwrap();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="消息传递"><a href="#消息传递" class="headerlink" title="消息传递"></a>消息传递</h3><p>Rust中实现消息传递并发的主要工具是通道（channel）</p>
<h4 id="mpsc-channel"><a href="#mpsc-channel" class="headerlink" title="mpsc::channel"></a><code>mpsc::channel</code></h4><p>mpsc：multiple producer single consumer，多个生产者，单个
消费者，即Rust标准库实现通道的方式允许多个产生值的发送端，但
只能有一个消费这些值的接收端。发送端或接收端任一被丢弃时，
意味着通道被关闭</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::thread;</span><br><span class="line"><span class="keyword">use</span> std::sync:mpsc;</span><br><span class="line"><span class="keyword">use</span> std::time:Duration;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> (tx, rx) = mpsc::channel();</span><br><span class="line">		<span class="comment">//`tx`表示发送端，`rx`表示接收端</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> tx1 = mpsc::Sender::clone(&amp;tx);</span><br><span class="line">		<span class="comment">//clone发送端创建多个生产者</span></span><br><span class="line"></span><br><span class="line">	thread::spawn(<span class="keyword">move</span> || &#123;</span><br><span class="line">		<span class="keyword">let</span> vals = <span class="built_in">vec!</span>[</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;hi&quot;</span>),</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;from&quot;</span>),</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;the&quot;</span>),</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;thread&quot;</span>),</span><br><span class="line">		];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> val <span class="keyword">in</span> vals &#123;</span><br><span class="line">			tx1.send(val).unwrap();</span><br><span class="line">				<span class="comment">//`send`会获取参数所有权归接收者所有，避免</span></span><br><span class="line">				<span class="comment">//值被其他线程丢弃、修改导致意外结果</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">//`send`返回`Result&lt;T, E&gt;`，如果接收端被丢弃</span></span><br><span class="line">				<span class="comment">//将没有发送值的目标，将返回`Err&lt;E&gt;`</span></span><br><span class="line">			thread::sleep(Duration::from_secs(<span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	thread::spawn(<span class="keyword">move</span> || &#123;d</span><br><span class="line">		<span class="keyword">let</span> vals = <span class="built_in">vec!</span>[</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;move&quot;</span>),</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;messages&quot;</span>),</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;for&quot;</span>),</span><br><span class="line">			<span class="built_in">String</span>::from(<span class="string">&quot;you&quot;</span>),</span><br><span class="line">		];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> val <span class="keyword">in</span> vals&#123;</span><br><span class="line">			tx.send(val).unwrap();</span><br><span class="line">			thread::sleep(Duration::from_secs(<span class="number">1</span>));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> received = rx.recv().unwrap();</span><br><span class="line">		<span class="comment">//`recv`将阻塞直到接收到一个值，返回`Result&lt;T, E&gt;`</span></span><br><span class="line">		<span class="comment">//通道发送端关闭时`recv`将返回`Err&lt;E&gt;`表明不会有新值</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> received = rx.try_recv().unwrap();</span><br><span class="line">		<span class="comment">//`try_recv`不阻塞，立刻返回`Result&lt;T, E&gt;`，`Err&lt;E&gt;`</span></span><br><span class="line">		<span class="comment">//表示当前没有消息</span></span><br><span class="line">		<span class="comment">//可以再循环中多次调用`try_recv`，有消息进行处理，</span></span><br><span class="line">		<span class="comment">//否则进行其他工作直到下次调用`try_recv`</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> received <span class="keyword">in</span> rx&#123;</span><br><span class="line">		<span class="comment">//将接收端`rx`当作迭代器使用，返回接收到值</span></span><br><span class="line">		<span class="built_in">println!</span>(<span class="string">&quot;Got: &#123;&#125;&quot;</span>, received);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="共享状态"><a href="#共享状态" class="headerlink" title="共享状态"></a>共享状态</h3><p>（任何语言）通道都类似于单所有权，一旦值通过通道传送，将无法
再次使用，而共享内存类似于多所有权</p>
<h4 id="Mutex-lt-T-gt"><a href="#Mutex-lt-T-gt" class="headerlink" title="Mutex&lt;T&gt;"></a><code>Mutex&lt;T&gt;</code></h4><p>互斥器mutex：mutual exclusion，任意时刻只允许一个线程访问
数据</p>
<ul>
<li>线程在访问数据之前需要获取互斥器的锁lock，lock是作为
互斥器一部分的数据结构，记录数据所有者的排他访问权</li>
<li>处理完互斥器保护的数据之后，需要解锁，这样才能允许其他
线程获取数据</li>
</ul>
<p><code>Mutex&lt;T&gt;</code>类似于线程安全版本的<code>RefCell&lt;T&gt;</code>（<code>cell</code>族），
提供了内部可变性，<code>Mutex&lt;T&gt;</code>有可能造成死锁，如一个操作需要
两个锁，两个线程各持一个互相等待。</p>
<p><code>Arc&lt;T&gt;</code>原子引用计数atomically reference counted，则是
线程安全版本的<code>Rc&lt;T&gt;</code>，而线程安全带有性能惩罚，如非必要，
使用单线程版本<code>Rc&lt;T&gt;</code>性能更好。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::sync::&#123;Mutex, Arc&#125;;</span><br><span class="line"><span class="keyword">use</span> std::thread;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>()&#123;</span><br><span class="line">	<span class="keyword">let</span> counter = Arc::new(Mutex::new(<span class="number">0</span>));</span><br><span class="line">		<span class="comment">//因为需要在多个线程内引用，所以需要使用多所有权</span></span><br><span class="line">		<span class="comment">//数据结构，而`Rc`不是线程安全的，需要使用线程安全</span></span><br><span class="line">		<span class="comment">//`Arc`</span></span><br><span class="line">	<span class="keyword">let</span> <span class="keyword">mut</span> handles = <span class="built_in">vec!</span>[];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="number">0</span>..<span class="number">10</span>&#123;</span><br><span class="line">		<span class="keyword">let</span> counter = Arc::clone(&amp;counter);</span><br><span class="line">		<span class="keyword">let</span> handle = thread::spawn(<span class="keyword">move</span> || &#123;</span><br><span class="line">			<span class="keyword">let</span> <span class="keyword">mut</span> num = counter.lock().unwrap();</span><br><span class="line">			<span class="comment">//`lock`返回一个`MutexGuard`类型的智能指针，</span></span><br><span class="line">			<span class="comment">//实现了`Deref`指向其内部数据，`Drop`当</span></span><br><span class="line">			<span class="comment">//`MutexGuard`离开作用域时自动释放锁</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//只有`lock`才能获取值，类型系统保证访问数据之前</span></span><br><span class="line">			<span class="comment">//获取锁；而锁的释放自动发生，保证锁一定会释放</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//这里发生了一次强制解引用多态，将`counter`</span></span><br><span class="line">			<span class="comment">//解引用为`Mutex&lt;T&gt;`类型</span></span><br><span class="line">			*num += <span class="number">1</span>;</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		handles.push(handle);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> handle <span class="keyword">in</span> handles&#123;</span><br><span class="line">		handle.join().unwrap();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">println!</span>(<span class="string">&quot;Result: &#123;&#125;&quot;</span>, counter.lock.unwrap());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Synctrait、Sendtrait"><a href="#Synctrait、Sendtrait" class="headerlink" title="Synctrait、Sendtrait"></a><code>Sync</code>trait、<code>Send</code>trait</h4><p>Rust的并发模型大部分属于标准库的实现，但是
<code>std::marker::Send</code>和<code>std::marker::Sync</code>时内嵌于语言的</p>
<ul>
<li><code>Send</code>：表明类型所有权可以在线程间传递，几乎所有类型都是
<code>Send</code>的，<code>Rc&lt;T&gt;</code>是其中的一个例外，因为<code>Rc&lt;T&gt;</code>clone之后
在两个线程间可能同时更新引用计数，trait bound保证无法将
不安全的<code>Rc&lt;T&gt;</code>在线程间传递。任何全部由<code>Send</code>组成的类型
会自动标记为<code>Send</code></li>
<li><code>Sync</code>：表明类型可以安全的在多线程中拥有其值的引用，对于
任何类型，如果<code>&amp;T</code>是<code>Send</code>的，那么<code>T</code>就是<code>Sync</code>的。
<code>Cell&lt;T&gt;</code>系列不是<code>Sync</code>的，<code>Mutex&lt;T&gt;</code>是。基本类型是<code>Sync</code>
的，全部由<code>Sync</code>组成的类型也是<code>Sync</code>的</li>
</ul>
<p><code>Send</code>和<code>Sync</code>是标记trait，不需要实现任何方法，全部是<code>Send</code>
或<code>Sync</code>组成的类型就是<code>Send</code>或<code>Sync</code>，一般不需要手动实现
它们，而且手动实现这些标记trait涉及编写不安全代码</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Rust 语法</p><p><a href="https://xyy15926.github.io/Rust/grammer.html">https://xyy15926.github.io/Rust/grammer.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>UBeaRLy</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-03-21</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2019-02-17</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Rust/">Rust</a><a class="link-muted mr-2" rel="tag" href="/tags/Grammer/">Grammer</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=610bd552640e160012f51469&amp;product=sop" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="https://z3.ax1x.com/2021/08/06/fmAPK0.jpg" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="https://z3.ax1x.com/2021/08/06/fmA9vq.jpg" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Python/Pandas/df_funcs.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Pandas函数目录</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Rust/std_var_types.html"><span class="level-item">Rust 标准库数据类型</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "c977beeb75a5e7630e4627e6c2bbfd5d",
            repo: "xyy15926.github.io",
            owner: "xyy15926",
            clientID: "af2bd51bbe151a8f6261",
            clientSecret: "f38f610edfe7bc367d5a20d22d43b10d887199eb",
            admin: ["xyy15926"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">36</span></span></a><ul><li><a class="level is-mobile" href="/categories/Algorithm/Data-Structure/"><span class="level-start"><span class="level-item">Data Structure</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Heuristic/"><span class="level-start"><span class="level-item">Heuristic</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Issue/"><span class="level-start"><span class="level-item">Issue</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Problem/"><span class="level-start"><span class="level-item">Problem</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Algorithm/Specification/"><span class="level-start"><span class="level-item">Specification</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/C-C/"><span class="level-start"><span class="level-item">C/C++</span></span><span class="level-end"><span class="level-item tag">34</span></span></a><ul><li><a class="level is-mobile" href="/categories/C-C/Cppref/"><span class="level-start"><span class="level-item">Cppref</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/Cstd/"><span class="level-start"><span class="level-item">Cstd</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/MPI/"><span class="level-start"><span class="level-item">MPI</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/C-C/STL/"><span class="level-start"><span class="level-item">STL</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/CS/"><span class="level-start"><span class="level-item">CS</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/CS/Character/"><span class="level-start"><span class="level-item">Character</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Parallel/"><span class="level-start"><span class="level-item">Parallel</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Program-Design/"><span class="level-start"><span class="level-item">Program Design</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/CS/Storage/"><span class="level-start"><span class="level-item">Storage</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Daily-Life/"><span class="level-start"><span class="level-item">Daily Life</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Daily-Life/Maxism/"><span class="level-start"><span class="level-item">Maxism</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Database/"><span class="level-start"><span class="level-item">Database</span></span><span class="level-end"><span class="level-item tag">27</span></span></a><ul><li><a class="level is-mobile" href="/categories/Database/Hadoop/"><span class="level-start"><span class="level-item">Hadoop</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/SQL-DB/"><span class="level-start"><span class="level-item">SQL DB</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Database/Spark/"><span class="level-start"><span class="level-item">Spark</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Scala/"><span class="level-start"><span class="level-item">Scala</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">42</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Bash-Programming/"><span class="level-start"><span class="level-item">Bash Programming</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Configuration/"><span class="level-start"><span class="level-item">Configuration</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/File-System/"><span class="level-start"><span class="level-item">File System</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/IPC/"><span class="level-start"><span class="level-item">IPC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Network/"><span class="level-start"><span class="level-item">Network</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Process-Schedual/"><span class="level-start"><span class="level-item">Process Schedual</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Shell/"><span class="level-start"><span class="level-item">Shell</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Tool/Vi/"><span class="level-start"><span class="level-item">Vi</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Model/"><span class="level-start"><span class="level-item">ML Model</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Model/Linear-Model/"><span class="level-start"><span class="level-item">Linear Model</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Model-Component/"><span class="level-start"><span class="level-item">Model Component</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Nolinear-Model/"><span class="level-start"><span class="level-item">Nolinear Model</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Model/Unsupervised-Model/"><span class="level-start"><span class="level-item">Unsupervised Model</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/"><span class="level-start"><span class="level-item">ML Specification</span></span><span class="level-end"><span class="level-item tag">17</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/"><span class="level-start"><span class="level-item">Click Through Rate</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/Click-Through-Rate/Recommandation-System/"><span class="level-start"><span class="level-item">Recommandation System</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Computer-Vision/"><span class="level-start"><span class="level-item">Computer Vision</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/"><span class="level-start"><span class="level-item">FinTech</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Specification/FinTech/Risk-Control/"><span class="level-start"><span class="level-item">Risk Control</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Specification/Graph-Analysis/"><span class="level-start"><span class="level-item">Graph Analysis</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Specification/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Technique/"><span class="level-start"><span class="level-item">ML Technique</span></span><span class="level-end"><span class="level-item tag">10</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Technique/Feature-Engineering/"><span class="level-start"><span class="level-item">Feature Engineering</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Technique/Neural-Network/"><span class="level-start"><span class="level-item">Neural Network</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/ML-Theory/"><span class="level-start"><span class="level-item">ML Theory</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul><li><a class="level is-mobile" href="/categories/ML-Theory/Loss/"><span class="level-start"><span class="level-item">Loss</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Model-Enhencement/"><span class="level-start"><span class="level-item">Model Enhencement</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/ML-Theory/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Algebra/"><span class="level-start"><span class="level-item">Math Algebra</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Algebra/Linear-Algebra/"><span class="level-start"><span class="level-item">Linear Algebra</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Algebra/Universal-Algebra/"><span class="level-start"><span class="level-item">Universal Algebra</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Analysis/"><span class="level-start"><span class="level-item">Math Analysis</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Analysis/Fourier-Analysis/"><span class="level-start"><span class="level-item">Fourier Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Functional-Analysis/"><span class="level-start"><span class="level-item">Functional Analysis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Optimization/"><span class="level-start"><span class="level-item">Optimization</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Analysis/Real-Analysis/"><span class="level-start"><span class="level-item">Real Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Math-Mixin/"><span class="level-start"><span class="level-item">Math Mixin</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/Math-Mixin/Statistics/"><span class="level-start"><span class="level-item">Statistics</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Math-Mixin/Time-Series/"><span class="level-start"><span class="level-item">Time Series</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Probability/"><span class="level-start"><span class="level-item">Probability</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">89</span></span></a><ul><li><a class="level is-mobile" href="/categories/Python/Cookbook/"><span class="level-start"><span class="level-item">Cookbook</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Jupyter/"><span class="level-start"><span class="level-item">Jupyter</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Keras/"><span class="level-start"><span class="level-item">Keras</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Matplotlib/"><span class="level-start"><span class="level-item">Matplotlib</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Numpy/"><span class="level-start"><span class="level-item">Numpy</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pandas/"><span class="level-start"><span class="level-item">Pandas</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3Ref/"><span class="level-start"><span class="level-item">Py3Ref</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Py3std/"><span class="level-start"><span class="level-item">Py3std</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Pywin32/"><span class="level-start"><span class="level-item">Pywin32</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Readme/"><span class="level-start"><span class="level-item">Readme</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/TensorFlow/"><span class="level-start"><span class="level-item">TensorFlow</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Python/Twists/"><span class="level-start"><span class="level-item">Twists</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/RLang/"><span class="level-start"><span class="level-item">RLang</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Rust/"><span class="level-start"><span class="level-item">Rust</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/Set/"><span class="level-start"><span class="level-item">Set</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/"><span class="level-start"><span class="level-item">Tool</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/Tool/Editor/"><span class="level-start"><span class="level-item">Editor</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Markup-Language/"><span class="level-start"><span class="level-item">Markup Language</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Web-Browser/"><span class="level-start"><span class="level-item">Web Browser</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Tool/Windows/"><span class="level-start"><span class="level-item">Windows</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/Web/CSS/"><span class="level-start"><span class="level-item">CSS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/NPM/"><span class="level-start"><span class="level-item">NPM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Proxy/"><span class="level-start"><span class="level-item">Proxy</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/Thrift/"><span class="level-start"><span class="level-item">Thrift</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Rust是基于表达式的语言"><span class="level-left"><span class="level-item">1</span><span class="level-item">Rust是基于表达式的语言</span></span></a></li><li><a class="level is-mobile" href="#模式匹配"><span class="level-left"><span class="level-item">2</span><span class="level-item">模式匹配</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Refutability（可反驳性）"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Refutability（可反驳性）</span></span></a></li><li><a class="level is-mobile" href="#Refutable"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Refutable</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#match控制流"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">match控制流</span></span></a></li><li><a class="level is-mobile" href="#if-let-else-简洁控制流"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">if let[else]简洁控制流</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Irrefutable"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">Irrefutable</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#while-let条件循环"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">while let条件循环</span></span></a></li><li><a class="level is-mobile" href="#for解构"><span class="level-left"><span class="level-item">2.3.2</span><span class="level-item">for解构</span></span></a></li><li><a class="level is-mobile" href="#let解构"><span class="level-left"><span class="level-item">2.3.3</span><span class="level-item">let解构</span></span></a></li><li><a class="level is-mobile" href="#函数参数"><span class="level-left"><span class="level-item">2.3.4</span><span class="level-item">函数参数</span></span></a></li></ul></li><li><a class="level is-mobile" href="#模式匹配用法"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">模式匹配用法</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#、-“或“"><span class="level-left"><span class="level-item">2.4.1</span><span class="level-item">|、...“或“</span></span></a></li><li><a class="level is-mobile" href="#、-”忽略“"><span class="level-left"><span class="level-item">2.4.2</span><span class="level-item">_、..”忽略“</span></span></a></li><li><a class="level is-mobile" href="#解构结构体"><span class="level-left"><span class="level-item">2.4.3</span><span class="level-item">解构结构体</span></span></a></li><li><a class="level is-mobile" href="#解构枚举"><span class="level-left"><span class="level-item">2.4.4</span><span class="level-item">解构枚举</span></span></a></li><li><a class="level is-mobile" href="#amp-、ref、ref-mut”引用“"><span class="level-left"><span class="level-item">2.4.5</span><span class="level-item">&amp;、ref、ref mut”引用“</span></span></a></li><li><a class="level is-mobile" href="#ifmatch-guard"><span class="level-left"><span class="level-item">2.4.6</span><span class="level-item">ifmatch guard</span></span></a></li><li><a class="level is-mobile" href="#绑定"><span class="level-left"><span class="level-item">2.4.7</span><span class="level-item">@绑定</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#闭包closures和函数指针"><span class="level-left"><span class="level-item">3</span><span class="level-item">闭包closures和函数指针</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#闭包类型推断和注解"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">闭包类型推断和注解</span></span></a></li><li><a class="level is-mobile" href="#Fntrait-bound"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Fntrait bound</span></span></a></li><li><a class="level is-mobile" href="#Function-Pointer-fn"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Function Pointer fn</span></span></a></li><li><a class="level is-mobile" href="#move关键字"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">move关键字</span></span></a></li><li><a class="level is-mobile" href="#返回闭包"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">返回闭包</span></span></a></li></ul></li><li><a class="level is-mobile" href="#迭代器Iterator"><span class="level-left"><span class="level-item">4</span><span class="level-item">迭代器Iterator</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Iteratortrait"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">Iteratortrait</span></span></a></li><li><a class="level is-mobile" href="#next方法"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">next方法</span></span></a></li><li><a class="level is-mobile" href="#消费适配器Comsuming-Adaptors"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">消费适配器Comsuming Adaptors</span></span></a></li><li><a class="level is-mobile" href="#迭代器适配器Iterator-Adaptors"><span class="level-left"><span class="level-item">4.4</span><span class="level-item">迭代器适配器Iterator Adaptors</span></span></a></li><li><a class="level is-mobile" href="#实现Iterator"><span class="level-left"><span class="level-item">4.5</span><span class="level-item">实现Iterator</span></span></a></li></ul></li><li><a class="level is-mobile" href="#并发（并行）"><span class="level-left"><span class="level-item">5</span><span class="level-item">并发（并行）</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#spawn创建新线程"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">spawn创建新线程</span></span></a></li><li><a class="level is-mobile" href="#消息传递"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">消息传递</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#mpsc-channel"><span class="level-left"><span class="level-item">5.2.1</span><span class="level-item">mpsc::channel</span></span></a></li></ul></li><li><a class="level is-mobile" href="#共享状态"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">共享状态</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Mutex-lt-T-gt"><span class="level-left"><span class="level-item">5.3.1</span><span class="level-item">Mutex&lt;T&gt;</span></span></a></li><li><a class="level is-mobile" href="#Synctrait、Sendtrait"><span class="level-left"><span class="level-item">5.3.2</span><span class="level-item">Synctrait、Sendtrait</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://octodex.github.com/images/hula_loop_octodex03.gif" alt="UBeaRLy"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">UBeaRLy</p><p class="is-size-6 is-block">Protector of Proxy</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">392</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">93</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">522</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xyy15926" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/xyy15926"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-04T15:07:54.896Z">2021-08-04</time></p><p class="title"><a href="/uncategorized/README.html"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T07:46:51.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/hexo_config.html">Hexo 建站</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-03T02:32:45.000Z">2021-08-03</time></p><p class="title"><a href="/Web/NPM/config.html">NPM 总述</a></p><p class="categories"><a href="/categories/Web/">Web</a> / <a href="/categories/Web/NPM/">NPM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-02T08:11:11.000Z">2021-08-02</time></p><p class="title"><a href="/Python/Py3std/internet_data.html">互联网数据</a></p><p class="categories"><a href="/categories/Python/">Python</a> / <a href="/categories/Python/Py3std/">Py3std</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-29T13:55:00.000Z">2021-07-29</time></p><p class="title"><a href="/Linux/Shell/sh_apps.html">Shell 应用程序</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Shell/">Shell</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">Advertisement</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5385776267343559" data-ad-slot="6995841235" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="https://api.follow.it/subscription-form/WWxwMVBsOUtoNTdMSlJ4Z1lWVnRISERsd2t6ek9MeVpEUWs0YldlZGxUdXlKdDNmMEZVV1hWaFZFYWFSNmFKL25penZodWx3UzRiaVkxcnREWCtOYUJhZWhNbWpzaUdyc1hPangycUh5RTVjRXFnZnFGdVdSTzZvVzJBcTJHKzl8aXpDK1ROWWl4N080YkFEK3QvbEVWNEJuQjFqdWdxODZQcGNoM1NqbERXST0=/8" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="UBeaRLy" height="28"></a><p class="is-size-7"><span>&copy; 2021 UBeaRLy</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/xyy15926/proxy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>